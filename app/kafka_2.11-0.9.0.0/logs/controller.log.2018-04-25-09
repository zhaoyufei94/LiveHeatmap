[2018-04-25 09:01:11,845] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:01:11,851] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:01:11,851] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:01:11,852] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,852] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:01:11,856] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:01:11,857] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:01:11,857] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:01:11,858] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:01:11,881] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:01:11,881] INFO [Controller 0]: Initialized controller epoch to 239 and zk version 238 (kafka.controller.KafkaController)
[2018-04-25 09:01:11,882] INFO [Controller 0]: Controller 0 incremented epoch to 240 (kafka.controller.KafkaController)
[2018-04-25 09:01:11,882] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:01:11,903] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:01:11,903] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:01:11,903] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:01:11,904] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:01:11,904] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:01:11,904] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:01:11,904] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:01:11,904] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:01:11,905] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:01:11,905] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:01:11,905] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:01:11,905] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:01:11,912] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,918] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,923] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,924] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,925] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 240 (kafka.controller.KafkaController)
[2018-04-25 09:01:11,925] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:01:11,925] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,926] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:01:11,932] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:01:11,932] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:01:11,941] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:01:11,941] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:01:11,942] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:01:11,943] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:01:11,944] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:01:11,944] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:01:11,947] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,947] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":218,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,948] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:238,ControllerEpoch:239), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:239)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,950] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,950] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":239,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,952] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:239,ControllerEpoch:240), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:239)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,954] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,955] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":218,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:01:11,956] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:239,ControllerEpoch:240), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:01:11,959] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:01:11,959] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:01:11,965] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:01:11,967] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:01:11,970] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:01:11,973] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:01:11,976] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:01:16,927] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:01:16,927] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:01:16,927] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:01:16,927] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,381] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:05:29,382] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,382] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:05:29,383] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,383] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:05:29,385] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:05:29,385] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:05:29,385] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:05:29,385] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:05:29,389] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:05:29,389] INFO [Controller 0]: Initialized controller epoch to 240 and zk version 239 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,389] INFO [Controller 0]: Controller 0 incremented epoch to 241 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,391] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:05:29,399] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:05:29,400] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:05:29,401] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,402] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,409] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,410] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,410] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 241 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,410] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:05:29,410] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,412] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:05:29,419] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:05:29,420] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:05:29,423] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:05:29,423] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:05:29,423] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:05:29,424] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:05:29,424] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:05:29,425] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,425] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":219,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,426] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:05:29,427] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:239,ControllerEpoch:240), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,429] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,429] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":240,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,430] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:240,ControllerEpoch:241), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:240)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,432] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,432] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":219,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:05:29,436] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:240,ControllerEpoch:241), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:05:29,440] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:05:29,440] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:05:29,443] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:05:29,446] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:05:29,448] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:05:29,449] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:05:29,451] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:05:34,414] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:05:34,414] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:05:34,414] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:05:34,414] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:10:38,674] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:10:38,674] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:10:38,674] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:10:38,674] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:15:44,452] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:15:44,452] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:15:44,452] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:15:44,452] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:20:34,962] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:20:34,963] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:20:34,963] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:20:34,968] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:34,968] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:20:34,969] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:20:34,969] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:20:34,969] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:20:34,970] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:20:34,974] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:20:34,975] INFO [Controller 0]: Initialized controller epoch to 241 and zk version 240 (kafka.controller.KafkaController)
[2018-04-25 09:20:34,976] INFO [Controller 0]: Controller 0 incremented epoch to 242 (kafka.controller.KafkaController)
[2018-04-25 09:20:34,976] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:20:34,998] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:20:34,998] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:20:34,998] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:20:34,999] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:20:35,001] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,003] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,005] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,005] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:35,006] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 242 (kafka.controller.KafkaController)
[2018-04-25 09:20:35,006] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:20:35,006] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:35,007] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:20:35,011] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:20:35,011] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:20:35,014] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:20:35,014] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:20:35,014] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:20:35,015] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:20:35,015] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:20:35,016] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:20:35,018] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,019] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":220,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,020] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:240,ControllerEpoch:241), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:35,021] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,021] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":241,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,022] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:241,ControllerEpoch:242), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:241)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:35,023] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,023] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":220,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:20:35,024] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:241,ControllerEpoch:242), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:20:35,028] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:20:35,028] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:20:35,031] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:20:35,033] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:20:35,034] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:20:35,036] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:20:35,037] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:20:40,008] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:20:40,008] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:20:40,009] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:20:40,009] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:25:43,706] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:25:43,707] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:25:43,707] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:25:43,707] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:30:48,405] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:30:48,406] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:30:48,406] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:30:48,406] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,407] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:34:22,407] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,407] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:34:22,411] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,411] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:34:22,414] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:34:22,414] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:34:22,415] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:34:22,415] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:34:22,440] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:34:22,441] INFO [Controller 0]: Initialized controller epoch to 242 and zk version 241 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,442] INFO [Controller 0]: Controller 0 incremented epoch to 243 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,443] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:34:22,452] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:34:22,454] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,457] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,459] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,459] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,460] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 243 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,460] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:34:22,460] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,463] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:34:22,471] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:34:22,472] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:34:22,476] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:34:22,476] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:34:22,477] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:34:22,477] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:34:22,478] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:34:22,478] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:34:22,481] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,481] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":221,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,482] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:241,ControllerEpoch:242), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,484] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,484] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":242,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,486] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:242,ControllerEpoch:243), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:242)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,487] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,487] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":221,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:34:22,488] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:242,ControllerEpoch:243), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:34:22,490] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:34:22,490] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:34:22,493] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:34:22,494] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:34:22,495] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:34:22,497] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:34:22,498] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:34:27,465] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:34:27,465] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:34:27,465] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:34:27,465] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,087] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:38:37,088] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,088] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:38:37,094] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,094] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:38:37,100] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:38:37,100] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:38:37,100] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:38:37,101] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:38:37,111] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:38:37,112] INFO [Controller 0]: Initialized controller epoch to 243 and zk version 242 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,112] INFO [Controller 0]: Controller 0 incremented epoch to 244 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,113] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:38:37,123] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:38:37,123] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:38:37,123] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:38:37,124] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:38:37,126] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,128] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,130] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,130] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,131] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 244 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,131] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:38:37,131] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,132] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:38:37,139] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:38:37,140] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:38:37,143] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:38:37,143] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:38:37,143] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:38:37,148] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:38:37,148] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:38:37,148] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:38:37,149] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,149] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":222,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,151] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:242,ControllerEpoch:243), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,152] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,152] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":243,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,153] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:243,ControllerEpoch:244), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:243)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,154] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,154] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":222,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:38:37,156] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:243,ControllerEpoch:244), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:38:37,158] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:38:37,158] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:38:37,169] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:38:37,170] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:38:37,171] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:38:37,173] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:38:37,174] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:38:42,133] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:38:42,134] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:38:42,134] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:38:42,134] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,575] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:41:01,575] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,575] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:41:01,576] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,576] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:41:01,584] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:41:01,584] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:41:01,584] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:41:01,584] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:41:01,593] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:41:01,594] INFO [Controller 0]: Initialized controller epoch to 244 and zk version 243 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,595] INFO [Controller 0]: Controller 0 incremented epoch to 245 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,595] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:41:01,604] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:41:01,604] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:41:01,604] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:41:01,605] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:41:01,607] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,609] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,610] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,611] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,612] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 245 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,612] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:41:01,612] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,614] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:41:01,619] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:41:01,621] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:41:01,624] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:41:01,624] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:41:01,625] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:41:01,625] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:41:01,625] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:41:01,626] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:41:01,627] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,627] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":223,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,629] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:243,ControllerEpoch:244), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,630] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,630] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":244,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,630] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:245), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:244)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,631] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,632] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":223,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:41:01,632] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:245), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:41:01,635] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:41:01,635] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:41:01,639] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:41:01,640] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:41:01,642] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:41:01,643] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:41:01,644] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:41:06,616] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:41:06,616] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:41:06,617] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:41:06,617] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,569] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-25 09:52:36,569] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,569] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:52:36,575] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,582] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:52:36,585] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-25 09:52:36,589] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-25 09:52:36,591] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-25 09:52:36,591] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-25 09:52:36,600] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-25 09:52:36,602] INFO [Controller 0]: Initialized controller epoch to 245 and zk version 244 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,604] INFO [Controller 0]: Controller 0 incremented epoch to 246 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,606] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-25 09:52:36,631] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:52:36,631] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-25 09:52:36,631] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-25 09:52:36,633] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-25 09:52:36,633] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-25 09:52:36,633] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-25 09:52:36,635] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-25 09:52:36,635] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-25 09:52:36,635] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:52:36,635] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-25 09:52:36,636] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-25 09:52:36,636] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:52:36,642] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,647] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,655] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,656] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,660] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 246 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,660] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-25 09:52:36,660] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,667] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-25 09:52:36,676] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-25 09:52:36,678] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:52:36,685] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:52:36,685] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-25 09:52:36,686] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-25 09:52:36,693] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-25 09:52:36,693] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-25 09:52:36,694] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-25 09:52:36,700] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,700] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":224,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,706] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:246), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:244,ControllerEpoch:245), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,709] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,709] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":245,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,712] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:246), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:246), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:245)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,715] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,715] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":224,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-25 09:52:36,718] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:246), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:245,ControllerEpoch:246), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:246)) (kafka.controller.PartitionStateMachine)
[2018-04-25 09:52:36,727] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:52:36,727] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-25 09:52:36,739] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:52:36,750] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:52:36,753] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-25 09:52:36,757] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:52:36,764] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-25 09:52:41,669] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-25 09:52:41,669] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-25 09:52:41,669] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-25 09:52:41,669] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
