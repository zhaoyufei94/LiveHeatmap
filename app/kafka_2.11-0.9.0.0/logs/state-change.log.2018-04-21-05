[2018-04-21 05:54:41,258] TRACE Controller 0 epoch 50 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:41,393] ERROR Controller 0 epoch 50 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:54:41,402] TRACE Controller 0 epoch 50 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:41,521] ERROR Controller 0 epoch 50 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:54:41,531] TRACE Controller 0 epoch 50 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:41,644] ERROR Controller 0 epoch 50 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:54:42,604] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:54:42,607] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:54:42,610] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:54:42,618] TRACE Controller 0 epoch 50 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:54:42,619] TRACE Controller 0 epoch 50 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:54:42,623] TRACE Controller 0 epoch 50 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:54:42,623] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:42,623] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:42,626] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:42,626] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:54:42,627] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:54:42,630] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:54:42,635] TRACE Controller 0 epoch 50 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:42,654] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 0 (state.change.logger)
[2018-04-21 05:54:42,657] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 0 (state.change.logger)
[2018-04-21 05:54:42,660] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 0 (state.change.logger)
[2018-04-21 05:54:42,664] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:54:42,669] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 50 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:42,673] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 50 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:42,681] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 50 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:42,682] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 50 for partition [kafka_topic,0] since its associated leader epoch 27 is old. Current leader epoch is 27 (state.change.logger)
[2018-04-21 05:54:42,686] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 50 for partition [kafka_test,0] since its associated leader epoch 48 is old. Current leader epoch is 48 (state.change.logger)
[2018-04-21 05:54:42,692] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 50 for partition [project_topic,0] since its associated leader epoch 27 is old. Current leader epoch is 27 (state.change.logger)
[2018-04-21 05:54:42,695] TRACE Controller 0 epoch 50 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:54:42,705] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 2 (state.change.logger)
[2018-04-21 05:54:42,709] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:48,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 2 (state.change.logger)
[2018-04-21 05:54:42,709] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:49),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 2 (state.change.logger)
[2018-04-21 05:54:42,710] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:54:42,775] TRACE Controller 0 epoch 50 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:42,778] TRACE Controller 0 epoch 50 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:54:42,780] TRACE Controller 0 epoch 50 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:42,894] TRACE Controller 0 epoch 50 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:42,897] TRACE Controller 0 epoch 50 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:54:42,898] TRACE Controller 0 epoch 50 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,009] TRACE Controller 0 epoch 50 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,012] TRACE Controller 0 epoch 50 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:54:43,013] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:43,013] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,017] TRACE Controller 0 epoch 50 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:43,023] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:54:43,025] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 50 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:43,029] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:54:43,030] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 50 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:43,032] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 50 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,032] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 50 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:43,035] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 50 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,036] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 50 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:43,042] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 50 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:54:43,043] TRACE Controller 0 epoch 50 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:54:43,045] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 50 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:54:43,049] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 50 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:54:43,050] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 50 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:54:43,054] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 50 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:54:43,054] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 50 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:54:43,057] TRACE Controller 0 epoch 50 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:54:43,065] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 4 (state.change.logger)
[2018-04-21 05:54:43,069] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 4 (state.change.logger)
[2018-04-21 05:54:43,081] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 50 with correlation id 4 (state.change.logger)
[2018-04-21 05:54:43,081] TRACE Controller 0 epoch 50 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:57:32,714] TRACE Controller 0 epoch 51 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:32,876] ERROR Controller 0 epoch 51 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:57:32,882] TRACE Controller 0 epoch 51 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:33,040] ERROR Controller 0 epoch 51 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:57:33,061] TRACE Controller 0 epoch 51 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:33,278] ERROR Controller 0 epoch 51 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:57:33,817] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:57:33,818] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:57:33,818] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:57:33,825] TRACE Controller 0 epoch 51 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:57:33,825] TRACE Controller 0 epoch 51 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:57:33,826] TRACE Controller 0 epoch 51 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:57:33,832] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:33,835] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:33,835] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:33,854] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:57:33,854] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:57:33,855] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:57:33,860] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 0 (state.change.logger)
[2018-04-21 05:57:33,866] TRACE Controller 0 epoch 51 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:33,876] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 0 (state.change.logger)
[2018-04-21 05:57:33,876] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 0 (state.change.logger)
[2018-04-21 05:57:33,882] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:57:33,884] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 51 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:33,884] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 51 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:33,891] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 51 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:33,891] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 51 for partition [kafka_topic,0] since its associated leader epoch 28 is old. Current leader epoch is 28 (state.change.logger)
[2018-04-21 05:57:33,892] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 51 for partition [kafka_test,0] since its associated leader epoch 49 is old. Current leader epoch is 49 (state.change.logger)
[2018-04-21 05:57:33,894] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 51 for partition [project_topic,0] since its associated leader epoch 28 is old. Current leader epoch is 28 (state.change.logger)
[2018-04-21 05:57:33,900] TRACE Controller 0 epoch 51 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:57:33,911] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 2 (state.change.logger)
[2018-04-21 05:57:33,912] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:49,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 2 (state.change.logger)
[2018-04-21 05:57:33,917] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:50),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 2 (state.change.logger)
[2018-04-21 05:57:33,919] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:57:34,017] TRACE Controller 0 epoch 51 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:34,018] TRACE Controller 0 epoch 51 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:57:34,018] TRACE Controller 0 epoch 51 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,142] TRACE Controller 0 epoch 51 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,152] TRACE Controller 0 epoch 51 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:57:34,153] TRACE Controller 0 epoch 51 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,259] TRACE Controller 0 epoch 51 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,266] TRACE Controller 0 epoch 51 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:57:34,270] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:34,274] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,274] TRACE Controller 0 epoch 51 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,278] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:57:34,278] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:57:34,279] TRACE Controller 0 epoch 51 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:57:34,286] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 51 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:34,288] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 51 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,291] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 51 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,291] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 51 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:34,291] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 51 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,292] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 51 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,296] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 51 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:57:34,299] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 51 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:57:34,299] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 51 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:57:34,301] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 51 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:57:34,301] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 51 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:57:34,301] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 51 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:57:34,304] TRACE Controller 0 epoch 51 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:57:34,312] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 4 (state.change.logger)
[2018-04-21 05:57:34,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 4 (state.change.logger)
[2018-04-21 05:57:34,317] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 51 with correlation id 4 (state.change.logger)
[2018-04-21 05:57:34,318] TRACE Controller 0 epoch 51 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:59:14,258] TRACE Controller 0 epoch 52 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,306] ERROR Controller 0 epoch 52 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:59:14,311] TRACE Controller 0 epoch 52 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,377] ERROR Controller 0 epoch 52 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:59:14,385] TRACE Controller 0 epoch 52 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,473] ERROR Controller 0 epoch 52 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 05:59:14,654] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:59:14,654] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:59:14,654] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:59:14,657] TRACE Controller 0 epoch 52 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:59:14,657] TRACE Controller 0 epoch 52 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:59:14,661] TRACE Controller 0 epoch 52 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 05:59:14,662] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,663] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,664] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,667] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:59:14,671] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:59:14,682] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:59:14,682] TRACE Controller 0 epoch 52 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,687] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 0 (state.change.logger)
[2018-04-21 05:59:14,689] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 0 (state.change.logger)
[2018-04-21 05:59:14,690] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 0 (state.change.logger)
[2018-04-21 05:59:14,690] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:59:14,691] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 52 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,692] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 52 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,697] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 52 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,700] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 52 for partition [kafka_topic,0] since its associated leader epoch 29 is old. Current leader epoch is 29 (state.change.logger)
[2018-04-21 05:59:14,700] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 52 for partition [kafka_test,0] since its associated leader epoch 50 is old. Current leader epoch is 50 (state.change.logger)
[2018-04-21 05:59:14,702] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 52 for partition [project_topic,0] since its associated leader epoch 29 is old. Current leader epoch is 29 (state.change.logger)
[2018-04-21 05:59:14,716] TRACE Controller 0 epoch 52 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:59:14,719] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 2 (state.change.logger)
[2018-04-21 05:59:14,720] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:50,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 2 (state.change.logger)
[2018-04-21 05:59:14,722] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:51),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 2 (state.change.logger)
[2018-04-21 05:59:14,727] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:59:14,758] TRACE Controller 0 epoch 52 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,759] TRACE Controller 0 epoch 52 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:59:14,760] TRACE Controller 0 epoch 52 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,802] TRACE Controller 0 epoch 52 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,802] TRACE Controller 0 epoch 52 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:59:14,804] TRACE Controller 0 epoch 52 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,841] TRACE Controller 0 epoch 52 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,843] TRACE Controller 0 epoch 52 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 05:59:14,845] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,846] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,846] TRACE Controller 0 epoch 52 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,846] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 05:59:14,846] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 05:59:14,848] TRACE Controller 0 epoch 52 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 05:59:14,848] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 52 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,850] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 52 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,850] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 52 for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,851] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 52 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,853] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 52 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,854] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 52 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,855] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 52 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:59:14,857] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 52 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:59:14,859] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 52 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 05:59:14,859] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 52 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 05:59:14,865] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 52 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 05:59:14,865] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 52 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 05:59:14,865] TRACE Controller 0 epoch 52 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 05:59:14,867] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 4 (state.change.logger)
[2018-04-21 05:59:14,867] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 4 (state.change.logger)
[2018-04-21 05:59:14,867] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 52 with correlation id 4 (state.change.logger)
[2018-04-21 05:59:14,868] TRACE Controller 0 epoch 52 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
