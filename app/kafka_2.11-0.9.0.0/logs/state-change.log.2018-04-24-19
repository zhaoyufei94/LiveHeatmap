[2018-04-24 19:02:00,863] TRACE Controller 0 epoch 216 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,868] ERROR Controller 0 epoch 216 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:02:00,868] TRACE Controller 0 epoch 216 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,870] ERROR Controller 0 epoch 216 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:02:00,872] TRACE Controller 0 epoch 216 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,874] ERROR Controller 0 epoch 216 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:02:00,887] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:02:00,887] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:02:00,887] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:02:00,888] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 0 (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 0 (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 0 (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Controller 0 epoch 216 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Controller 0 epoch 216 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 216 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 216 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,889] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 216 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,889] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 216 for partition [kafka_topic,0] since its associated leader epoch 193 is old. Current leader epoch is 193 (state.change.logger)
[2018-04-24 19:02:00,889] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 216 for partition [kafka_test,0] since its associated leader epoch 214 is old. Current leader epoch is 214 (state.change.logger)
[2018-04-24 19:02:00,889] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 216 for partition [project_topic,0] since its associated leader epoch 193 is old. Current leader epoch is 193 (state.change.logger)
[2018-04-24 19:02:00,890] TRACE Controller 0 epoch 216 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:02:00,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 2 (state.change.logger)
[2018-04-24 19:02:00,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:214,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 2 (state.change.logger)
[2018-04-24 19:02:00,890] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:193,ControllerEpoch:215),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 2 (state.change.logger)
[2018-04-24 19:02:00,891] TRACE Controller 0 epoch 216 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,892] TRACE Controller 0 epoch 216 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:02:00,892] TRACE Controller 0 epoch 216 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,892] TRACE Controller 0 epoch 216 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:02:00,893] TRACE Controller 0 epoch 216 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,893] TRACE Controller 0 epoch 216 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:02:00,893] TRACE Controller 0 epoch 216 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,895] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Controller 0 epoch 216 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 216 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 216 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 216 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 216 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 216 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,896] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 216 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,901] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 216 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:02:00,901] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 216 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:02:00,901] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 216 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:02:00,901] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 216 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:02:00,901] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 216 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:02:00,901] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 216 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:02:00,901] TRACE Controller 0 epoch 216 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:02:00,902] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 4 (state.change.logger)
[2018-04-24 19:02:00,902] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 4 (state.change.logger)
[2018-04-24 19:02:00,902] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 216 with correlation id 4 (state.change.logger)
[2018-04-24 19:02:00,902] TRACE Controller 0 epoch 216 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:06:23,683] TRACE Controller 0 epoch 217 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,687] ERROR Controller 0 epoch 217 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:06:23,687] TRACE Controller 0 epoch 217 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,691] ERROR Controller 0 epoch 217 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:06:23,691] TRACE Controller 0 epoch 217 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,697] ERROR Controller 0 epoch 217 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,723] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,724] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:06:23,724] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:06:23,724] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:06:23,724] TRACE Controller 0 epoch 217 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,730] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 0 (state.change.logger)
[2018-04-24 19:06:23,730] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 0 (state.change.logger)
[2018-04-24 19:06:23,730] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 0 (state.change.logger)
[2018-04-24 19:06:23,733] TRACE Controller 0 epoch 217 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:06:23,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 217 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 217 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 217 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 217 for partition [kafka_topic,0] since its associated leader epoch 194 is old. Current leader epoch is 194 (state.change.logger)
[2018-04-24 19:06:23,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 217 for partition [kafka_test,0] since its associated leader epoch 215 is old. Current leader epoch is 215 (state.change.logger)
[2018-04-24 19:06:23,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 217 for partition [project_topic,0] since its associated leader epoch 194 is old. Current leader epoch is 194 (state.change.logger)
[2018-04-24 19:06:23,734] TRACE Controller 0 epoch 217 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,734] TRACE Controller 0 epoch 217 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:06:23,734] TRACE Controller 0 epoch 217 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,734] TRACE Controller 0 epoch 217 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:06:23,738] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 2 (state.change.logger)
[2018-04-24 19:06:23,738] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:215,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 2 (state.change.logger)
[2018-04-24 19:06:23,738] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:194,ControllerEpoch:216),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 2 (state.change.logger)
[2018-04-24 19:06:23,739] TRACE Controller 0 epoch 217 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:06:23,740] TRACE Controller 0 epoch 217 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,741] TRACE Controller 0 epoch 217 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:06:23,741] TRACE Controller 0 epoch 217 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Controller 0 epoch 217 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 217 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 217 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 217 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 217 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 217 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 217 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,745] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 217 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:06:23,745] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 217 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:06:23,745] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 217 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 217 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 217 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:06:23,745] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 217 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:06:23,746] TRACE Controller 0 epoch 217 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:06:23,746] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 4 (state.change.logger)
[2018-04-24 19:06:23,746] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 4 (state.change.logger)
[2018-04-24 19:06:23,746] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 217 with correlation id 4 (state.change.logger)
[2018-04-24 19:06:23,746] TRACE Controller 0 epoch 217 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:07:57,271] TRACE Controller 0 epoch 218 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,273] ERROR Controller 0 epoch 218 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:07:57,273] TRACE Controller 0 epoch 218 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,275] ERROR Controller 0 epoch 218 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:07:57,275] TRACE Controller 0 epoch 218 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,277] ERROR Controller 0 epoch 218 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:07:57,287] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:07:57,287] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:07:57,287] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:07:57,288] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:07:57,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 0 (state.change.logger)
[2018-04-24 19:07:57,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 0 (state.change.logger)
[2018-04-24 19:07:57,294] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 0 (state.change.logger)
[2018-04-24 19:07:57,294] TRACE Controller 0 epoch 218 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,294] TRACE Controller 0 epoch 218 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 218 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 218 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 218 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,295] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 218 for partition [kafka_topic,0] since its associated leader epoch 195 is old. Current leader epoch is 195 (state.change.logger)
[2018-04-24 19:07:57,295] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 218 for partition [kafka_test,0] since its associated leader epoch 216 is old. Current leader epoch is 216 (state.change.logger)
[2018-04-24 19:07:57,295] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 218 for partition [project_topic,0] since its associated leader epoch 195 is old. Current leader epoch is 195 (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Controller 0 epoch 218 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 2 (state.change.logger)
[2018-04-24 19:07:57,295] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:216,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 2 (state.change.logger)
[2018-04-24 19:07:57,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:195,ControllerEpoch:217),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 2 (state.change.logger)
[2018-04-24 19:07:57,296] TRACE Controller 0 epoch 218 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:07:57,297] TRACE Controller 0 epoch 218 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,297] TRACE Controller 0 epoch 218 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:07:57,297] TRACE Controller 0 epoch 218 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,300] TRACE Controller 0 epoch 218 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,300] TRACE Controller 0 epoch 218 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:07:57,300] TRACE Controller 0 epoch 218 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Controller 0 epoch 218 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 218 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 218 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 218 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 218 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 218 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,302] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 218 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,303] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 218 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:07:57,303] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 218 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:07:57,303] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 218 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:07:57,303] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 218 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:07:57,304] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 218 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:07:57,304] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 218 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:07:57,304] TRACE Controller 0 epoch 218 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:07:57,304] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 4 (state.change.logger)
[2018-04-24 19:07:57,305] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 4 (state.change.logger)
[2018-04-24 19:07:57,305] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 218 with correlation id 4 (state.change.logger)
[2018-04-24 19:07:57,305] TRACE Controller 0 epoch 218 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:09:19,470] TRACE Controller 0 epoch 219 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,482] ERROR Controller 0 epoch 219 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:09:19,483] TRACE Controller 0 epoch 219 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,493] ERROR Controller 0 epoch 219 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:09:19,496] TRACE Controller 0 epoch 219 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,504] ERROR Controller 0 epoch 219 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:09:19,554] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:09:19,556] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:09:19,556] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:09:19,556] TRACE Controller 0 epoch 219 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,557] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:09:19,558] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 0 (state.change.logger)
[2018-04-24 19:09:19,559] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 0 (state.change.logger)
[2018-04-24 19:09:19,559] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 0 (state.change.logger)
[2018-04-24 19:09:19,559] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:09:19,559] TRACE Controller 0 epoch 219 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:09:19,559] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:09:19,560] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 219 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,560] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 219 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,560] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 219 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,560] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 219 for partition [kafka_topic,0] since its associated leader epoch 196 is old. Current leader epoch is 196 (state.change.logger)
[2018-04-24 19:09:19,560] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 219 for partition [kafka_test,0] since its associated leader epoch 217 is old. Current leader epoch is 217 (state.change.logger)
[2018-04-24 19:09:19,561] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 219 for partition [project_topic,0] since its associated leader epoch 196 is old. Current leader epoch is 196 (state.change.logger)
[2018-04-24 19:09:19,561] TRACE Controller 0 epoch 219 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,561] TRACE Controller 0 epoch 219 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:09:19,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 2 (state.change.logger)
[2018-04-24 19:09:19,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:217,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 2 (state.change.logger)
[2018-04-24 19:09:19,565] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:196,ControllerEpoch:218),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 2 (state.change.logger)
[2018-04-24 19:09:19,565] TRACE Controller 0 epoch 219 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:09:19,570] TRACE Controller 0 epoch 219 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,571] TRACE Controller 0 epoch 219 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:09:19,571] TRACE Controller 0 epoch 219 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,585] TRACE Controller 0 epoch 219 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,585] TRACE Controller 0 epoch 219 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:09:19,585] TRACE Controller 0 epoch 219 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,596] TRACE Controller 0 epoch 219 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,597] TRACE Controller 0 epoch 219 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:09:19,597] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,597] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,598] TRACE Controller 0 epoch 219 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,598] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:09:19,598] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:09:19,598] TRACE Controller 0 epoch 219 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:09:19,602] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 219 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,602] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 219 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,602] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 219 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,605] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 219 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 219 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 219 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,607] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 219 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:09:19,608] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 219 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:09:19,608] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 219 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:09:19,608] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 219 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:09:19,609] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 219 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:09:19,610] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 219 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:09:19,611] TRACE Controller 0 epoch 219 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:09:19,612] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 4 (state.change.logger)
[2018-04-24 19:09:19,613] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 4 (state.change.logger)
[2018-04-24 19:09:19,613] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 219 with correlation id 4 (state.change.logger)
[2018-04-24 19:09:19,616] TRACE Controller 0 epoch 219 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:12:16,901] TRACE Controller 0 epoch 220 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,903] ERROR Controller 0 epoch 220 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:12:16,903] TRACE Controller 0 epoch 220 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,904] ERROR Controller 0 epoch 220 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:12:16,906] TRACE Controller 0 epoch 220 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,907] ERROR Controller 0 epoch 220 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:12:16,914] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:12:16,914] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:12:16,914] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 0 (state.change.logger)
[2018-04-24 19:12:16,919] TRACE Controller 0 epoch 220 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 220 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 220 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 220 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 220 for partition [kafka_topic,0] since its associated leader epoch 197 is old. Current leader epoch is 197 (state.change.logger)
[2018-04-24 19:12:16,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 220 for partition [kafka_test,0] since its associated leader epoch 218 is old. Current leader epoch is 218 (state.change.logger)
[2018-04-24 19:12:16,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 220 for partition [project_topic,0] since its associated leader epoch 197 is old. Current leader epoch is 197 (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Controller 0 epoch 220 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 2 (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:218,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 2 (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:197,ControllerEpoch:219),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 2 (state.change.logger)
[2018-04-24 19:12:16,920] TRACE Controller 0 epoch 220 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:12:16,921] TRACE Controller 0 epoch 220 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,922] TRACE Controller 0 epoch 220 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:12:16,922] TRACE Controller 0 epoch 220 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,923] TRACE Controller 0 epoch 220 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,923] TRACE Controller 0 epoch 220 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:12:16,923] TRACE Controller 0 epoch 220 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,924] TRACE Controller 0 epoch 220 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 220 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 220 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 220 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 220 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 220 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 220 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,925] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 220 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:12:16,925] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 220 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:12:16,925] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 220 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 220 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 220 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 220 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Controller 0 epoch 220 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:12:16,925] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 4 (state.change.logger)
[2018-04-24 19:12:16,926] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 4 (state.change.logger)
[2018-04-24 19:12:16,926] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 220 with correlation id 4 (state.change.logger)
[2018-04-24 19:12:16,926] TRACE Controller 0 epoch 220 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:14:45,055] TRACE Controller 0 epoch 221 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,057] ERROR Controller 0 epoch 221 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:14:45,057] TRACE Controller 0 epoch 221 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,059] ERROR Controller 0 epoch 221 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:14:45,059] TRACE Controller 0 epoch 221 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,061] ERROR Controller 0 epoch 221 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:14:45,071] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:14:45,071] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:14:45,071] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,076] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Controller 0 epoch 221 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 0 (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 0 (state.change.logger)
[2018-04-24 19:14:45,077] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 0 (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Controller 0 epoch 221 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 221 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 221 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 221 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,078] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 221 for partition [kafka_topic,0] since its associated leader epoch 198 is old. Current leader epoch is 198 (state.change.logger)
[2018-04-24 19:14:45,078] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 221 for partition [kafka_test,0] since its associated leader epoch 219 is old. Current leader epoch is 219 (state.change.logger)
[2018-04-24 19:14:45,078] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 221 for partition [project_topic,0] since its associated leader epoch 198 is old. Current leader epoch is 198 (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Controller 0 epoch 221 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:14:45,078] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 2 (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:219,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 2 (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:198,ControllerEpoch:220),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 2 (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Controller 0 epoch 221 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Controller 0 epoch 221 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Controller 0 epoch 221 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:14:45,079] TRACE Controller 0 epoch 221 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,085] TRACE Controller 0 epoch 221 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,086] TRACE Controller 0 epoch 221 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:14:45,086] TRACE Controller 0 epoch 221 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Controller 0 epoch 221 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 221 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 221 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 221 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 221 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 221 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,091] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 221 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,092] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 221 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:14:45,092] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 221 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:14:45,092] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 221 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 221 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 221 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 221 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Controller 0 epoch 221 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 4 (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 4 (state.change.logger)
[2018-04-24 19:14:45,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 221 with correlation id 4 (state.change.logger)
[2018-04-24 19:14:45,093] TRACE Controller 0 epoch 221 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:17:18,662] TRACE Controller 0 epoch 222 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,664] ERROR Controller 0 epoch 222 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:17:18,664] TRACE Controller 0 epoch 222 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,666] ERROR Controller 0 epoch 222 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:17:18,666] TRACE Controller 0 epoch 222 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,668] ERROR Controller 0 epoch 222 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:17:18,686] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:17:18,687] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:17:18,688] TRACE Controller 0 epoch 222 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 0 (state.change.logger)
[2018-04-24 19:17:18,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 0 (state.change.logger)
[2018-04-24 19:17:18,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 0 (state.change.logger)
[2018-04-24 19:17:18,688] TRACE Controller 0 epoch 222 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:17:18,689] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 222 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,689] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 222 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,689] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 222 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,689] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 222 for partition [kafka_topic,0] since its associated leader epoch 199 is old. Current leader epoch is 199 (state.change.logger)
[2018-04-24 19:17:18,689] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 222 for partition [kafka_test,0] since its associated leader epoch 220 is old. Current leader epoch is 220 (state.change.logger)
[2018-04-24 19:17:18,689] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 222 for partition [project_topic,0] since its associated leader epoch 199 is old. Current leader epoch is 199 (state.change.logger)
[2018-04-24 19:17:18,690] TRACE Controller 0 epoch 222 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Controller 0 epoch 222 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 2 (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Controller 0 epoch 222 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:220,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 2 (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Controller 0 epoch 222 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:199,ControllerEpoch:221),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 2 (state.change.logger)
[2018-04-24 19:17:18,691] TRACE Controller 0 epoch 222 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:17:18,694] TRACE Controller 0 epoch 222 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,694] TRACE Controller 0 epoch 222 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:17:18,694] TRACE Controller 0 epoch 222 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:17:18,696] TRACE Controller 0 epoch 222 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 222 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 222 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 222 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 222 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 222 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 222 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,697] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 222 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:17:18,697] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 222 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:17:18,697] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 222 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 222 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 222 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:17:18,697] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 222 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:17:18,698] TRACE Controller 0 epoch 222 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:17:18,698] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 4 (state.change.logger)
[2018-04-24 19:17:18,698] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 4 (state.change.logger)
[2018-04-24 19:17:18,698] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 222 with correlation id 4 (state.change.logger)
[2018-04-24 19:17:18,698] TRACE Controller 0 epoch 222 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:24:24,759] TRACE Controller 0 epoch 223 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,760] ERROR Controller 0 epoch 223 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:24:24,760] TRACE Controller 0 epoch 223 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,761] ERROR Controller 0 epoch 223 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:24:24,761] TRACE Controller 0 epoch 223 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,764] ERROR Controller 0 epoch 223 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:24:24,771] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:24:24,771] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:24:24,772] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:24:24,772] TRACE Controller 0 epoch 223 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 0 (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Controller 0 epoch 223 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 223 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 223 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,773] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 223 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,773] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 223 for partition [kafka_topic,0] since its associated leader epoch 200 is old. Current leader epoch is 200 (state.change.logger)
[2018-04-24 19:24:24,773] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 223 for partition [kafka_test,0] since its associated leader epoch 221 is old. Current leader epoch is 221 (state.change.logger)
[2018-04-24 19:24:24,773] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 223 for partition [project_topic,0] since its associated leader epoch 200 is old. Current leader epoch is 200 (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Controller 0 epoch 223 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 2 (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:221,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 2 (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:200,ControllerEpoch:222),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 2 (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Controller 0 epoch 223 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Controller 0 epoch 223 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Controller 0 epoch 223 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:24:24,774] TRACE Controller 0 epoch 223 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,776] TRACE Controller 0 epoch 223 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,776] TRACE Controller 0 epoch 223 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:24:24,776] TRACE Controller 0 epoch 223 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:24:24,777] TRACE Controller 0 epoch 223 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 223 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 223 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 223 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 223 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 223 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 223 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,778] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 223 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:24:24,778] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 223 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:24:24,778] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 223 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 223 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 223 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 223 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Controller 0 epoch 223 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:24:24,778] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 4 (state.change.logger)
[2018-04-24 19:24:24,779] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 4 (state.change.logger)
[2018-04-24 19:24:24,779] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 223 with correlation id 4 (state.change.logger)
[2018-04-24 19:24:24,779] TRACE Controller 0 epoch 223 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:29:49,542] TRACE Controller 0 epoch 224 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,544] ERROR Controller 0 epoch 224 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:29:49,545] TRACE Controller 0 epoch 224 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,547] ERROR Controller 0 epoch 224 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:29:49,547] TRACE Controller 0 epoch 224 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,549] ERROR Controller 0 epoch 224 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:29:49,575] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:29:49,576] TRACE Controller 0 epoch 224 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 0 (state.change.logger)
[2018-04-24 19:29:49,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 0 (state.change.logger)
[2018-04-24 19:29:49,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 0 (state.change.logger)
[2018-04-24 19:29:49,578] TRACE Controller 0 epoch 224 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 224 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Controller 0 epoch 224 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 224 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 224 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,579] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 224 for partition [kafka_topic,0] since its associated leader epoch 201 is old. Current leader epoch is 201 (state.change.logger)
[2018-04-24 19:29:49,579] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 224 for partition [kafka_test,0] since its associated leader epoch 222 is old. Current leader epoch is 222 (state.change.logger)
[2018-04-24 19:29:49,579] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 224 for partition [project_topic,0] since its associated leader epoch 201 is old. Current leader epoch is 201 (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Controller 0 epoch 224 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:29:49,579] TRACE Controller 0 epoch 224 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,581] TRACE Controller 0 epoch 224 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:29:49,581] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 2 (state.change.logger)
[2018-04-24 19:29:49,582] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:222,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 2 (state.change.logger)
[2018-04-24 19:29:49,582] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:201,ControllerEpoch:223),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 2 (state.change.logger)
[2018-04-24 19:29:49,582] TRACE Controller 0 epoch 224 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,582] TRACE Controller 0 epoch 224 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:29:49,582] TRACE Controller 0 epoch 224 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,583] TRACE Controller 0 epoch 224 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:29:49,586] TRACE Controller 0 epoch 224 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 224 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 224 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 224 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 224 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 224 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 224 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,587] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 224 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:29:49,587] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 224 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:29:49,587] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 224 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 224 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 224 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 224 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:29:49,587] TRACE Controller 0 epoch 224 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:29:49,588] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 4 (state.change.logger)
[2018-04-24 19:29:49,588] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 4 (state.change.logger)
[2018-04-24 19:29:49,588] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 224 with correlation id 4 (state.change.logger)
[2018-04-24 19:29:49,588] TRACE Controller 0 epoch 224 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:55:29,014] TRACE Controller 0 epoch 225 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,017] ERROR Controller 0 epoch 225 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:55:29,017] TRACE Controller 0 epoch 225 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,023] ERROR Controller 0 epoch 225 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:55:29,023] TRACE Controller 0 epoch 225 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,026] ERROR Controller 0 epoch 225 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,037] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 0 (state.change.logger)
[2018-04-24 19:55:29,038] TRACE Controller 0 epoch 225 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,039] TRACE Controller 0 epoch 225 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:55:29,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 225 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 225 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 225 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 225 for partition [kafka_topic,0] since its associated leader epoch 202 is old. Current leader epoch is 202 (state.change.logger)
[2018-04-24 19:55:29,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 225 for partition [kafka_test,0] since its associated leader epoch 223 is old. Current leader epoch is 223 (state.change.logger)
[2018-04-24 19:55:29,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 225 for partition [project_topic,0] since its associated leader epoch 202 is old. Current leader epoch is 202 (state.change.logger)
[2018-04-24 19:55:29,041] TRACE Controller 0 epoch 225 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:55:29,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 2 (state.change.logger)
[2018-04-24 19:55:29,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:223,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 2 (state.change.logger)
[2018-04-24 19:55:29,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:202,ControllerEpoch:224),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 2 (state.change.logger)
[2018-04-24 19:55:29,042] TRACE Controller 0 epoch 225 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:55:29,043] TRACE Controller 0 epoch 225 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,043] TRACE Controller 0 epoch 225 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:55:29,043] TRACE Controller 0 epoch 225 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,046] TRACE Controller 0 epoch 225 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,046] TRACE Controller 0 epoch 225 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:55:29,047] TRACE Controller 0 epoch 225 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,048] TRACE Controller 0 epoch 225 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Controller 0 epoch 225 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 225 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 225 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 225 for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 225 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 225 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,049] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 225 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,049] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 225 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:55:29,049] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 225 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:55:29,050] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 225 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 19:55:29,050] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 225 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 19:55:29,050] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 225 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 19:55:29,050] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 225 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 19:55:29,050] TRACE Controller 0 epoch 225 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 19:55:29,052] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 4 (state.change.logger)
[2018-04-24 19:55:29,052] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 4 (state.change.logger)
[2018-04-24 19:55:29,052] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 225 with correlation id 4 (state.change.logger)
[2018-04-24 19:55:29,052] TRACE Controller 0 epoch 225 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
