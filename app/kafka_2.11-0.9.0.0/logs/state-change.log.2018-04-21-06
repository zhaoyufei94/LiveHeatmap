[2018-04-21 06:07:42,458] TRACE Controller 0 epoch 53 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:42,572] ERROR Controller 0 epoch 53 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:07:42,580] TRACE Controller 0 epoch 53 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:42,663] ERROR Controller 0 epoch 53 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:07:42,677] TRACE Controller 0 epoch 53 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:42,764] ERROR Controller 0 epoch 53 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:07:43,018] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:07:43,020] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:07:43,022] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:07:43,029] TRACE Controller 0 epoch 53 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:07:43,031] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 0 (state.change.logger)
[2018-04-21 06:07:43,033] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 0 (state.change.logger)
[2018-04-21 06:07:43,035] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 0 (state.change.logger)
[2018-04-21 06:07:43,036] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:07:43,037] TRACE Controller 0 epoch 53 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:07:43,037] TRACE Controller 0 epoch 53 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:07:43,037] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,038] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,038] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,038] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:07:43,038] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:07:43,038] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:07:43,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 53 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,042] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 53 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,042] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 53 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,042] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 53 for partition [kafka_topic,0] since its associated leader epoch 30 is old. Current leader epoch is 30 (state.change.logger)
[2018-04-21 06:07:43,043] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 53 for partition [kafka_test,0] since its associated leader epoch 51 is old. Current leader epoch is 51 (state.change.logger)
[2018-04-21 06:07:43,043] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 53 for partition [project_topic,0] since its associated leader epoch 30 is old. Current leader epoch is 30 (state.change.logger)
[2018-04-21 06:07:43,044] TRACE Controller 0 epoch 53 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,049] TRACE Controller 0 epoch 53 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:07:43,051] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 2 (state.change.logger)
[2018-04-21 06:07:43,054] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:51,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 2 (state.change.logger)
[2018-04-21 06:07:43,054] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:30,ControllerEpoch:52),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 2 (state.change.logger)
[2018-04-21 06:07:43,060] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:07:43,104] TRACE Controller 0 epoch 53 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,107] TRACE Controller 0 epoch 53 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:07:43,108] TRACE Controller 0 epoch 53 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,180] TRACE Controller 0 epoch 53 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,183] TRACE Controller 0 epoch 53 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:07:43,184] TRACE Controller 0 epoch 53 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,235] TRACE Controller 0 epoch 53 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,236] TRACE Controller 0 epoch 53 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:07:43,238] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,239] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,240] TRACE Controller 0 epoch 53 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 53 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 53 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 53 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:07:43,243] TRACE Controller 0 epoch 53 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:07:43,242] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 53 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,245] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 53 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,245] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 53 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,248] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 53 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:07:43,249] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 53 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:07:43,251] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 53 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:07:43,252] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 53 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:07:43,252] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 53 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:07:43,252] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 53 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:07:43,260] TRACE Controller 0 epoch 53 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:07:43,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 4 (state.change.logger)
[2018-04-21 06:07:43,280] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 4 (state.change.logger)
[2018-04-21 06:07:43,281] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 53 with correlation id 4 (state.change.logger)
[2018-04-21 06:07:43,282] TRACE Controller 0 epoch 53 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:11:23,374] TRACE Controller 0 epoch 54 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:23,565] ERROR Controller 0 epoch 54 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:11:23,587] TRACE Controller 0 epoch 54 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:23,784] ERROR Controller 0 epoch 54 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:11:23,827] TRACE Controller 0 epoch 54 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:24,463] ERROR Controller 0 epoch 54 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:11:26,278] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:11:26,281] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:11:26,281] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:11:26,351] TRACE Controller 0 epoch 54 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:11:26,351] TRACE Controller 0 epoch 54 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:11:26,351] TRACE Controller 0 epoch 54 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:11:26,351] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:26,352] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:26,373] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:26,415] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 0 (state.change.logger)
[2018-04-21 06:11:26,415] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 0 (state.change.logger)
[2018-04-21 06:11:26,434] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:11:26,435] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:11:26,438] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 0 (state.change.logger)
[2018-04-21 06:11:26,453] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:11:26,453] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:11:26,455] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 54 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:26,456] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 54 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:26,456] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 54 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:26,456] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 54 for partition [kafka_topic,0] since its associated leader epoch 31 is old. Current leader epoch is 31 (state.change.logger)
[2018-04-21 06:11:26,457] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 54 for partition [kafka_test,0] since its associated leader epoch 52 is old. Current leader epoch is 52 (state.change.logger)
[2018-04-21 06:11:26,463] TRACE Controller 0 epoch 54 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:26,467] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 54 for partition [project_topic,0] since its associated leader epoch 31 is old. Current leader epoch is 31 (state.change.logger)
[2018-04-21 06:11:26,496] TRACE Controller 0 epoch 54 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:11:26,504] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 2 (state.change.logger)
[2018-04-21 06:11:26,505] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 2 (state.change.logger)
[2018-04-21 06:11:26,511] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:31,ControllerEpoch:53),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 2 (state.change.logger)
[2018-04-21 06:11:26,512] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:11:26,723] TRACE Controller 0 epoch 54 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:26,726] TRACE Controller 0 epoch 54 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:11:26,726] TRACE Controller 0 epoch 54 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:26,860] TRACE Controller 0 epoch 54 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:26,867] TRACE Controller 0 epoch 54 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:11:26,867] TRACE Controller 0 epoch 54 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,031] TRACE Controller 0 epoch 54 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,038] TRACE Controller 0 epoch 54 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:11:27,038] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:27,038] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,039] TRACE Controller 0 epoch 54 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:27,061] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 54 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:27,062] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:11:27,065] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:11:27,072] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 54 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:27,072] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 54 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,073] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 54 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:27,079] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 54 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,083] TRACE Controller 0 epoch 54 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:11:27,090] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 54 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:27,105] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 54 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:11:27,106] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 54 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:11:27,131] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 54 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:11:27,135] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 54 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:11:27,135] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 54 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:11:27,135] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 54 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:11:27,153] TRACE Controller 0 epoch 54 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:11:27,165] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 4 (state.change.logger)
[2018-04-21 06:11:27,165] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 4 (state.change.logger)
[2018-04-21 06:11:27,182] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 54 with correlation id 4 (state.change.logger)
[2018-04-21 06:11:27,183] TRACE Controller 0 epoch 54 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:19:28,412] TRACE Controller 0 epoch 55 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:28,517] ERROR Controller 0 epoch 55 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:19:28,534] TRACE Controller 0 epoch 55 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:28,684] ERROR Controller 0 epoch 55 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:19:28,710] TRACE Controller 0 epoch 55 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:28,866] ERROR Controller 0 epoch 55 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:19:29,224] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:19:29,224] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:19:29,224] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,234] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,235] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:19:29,235] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:19:29,235] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:19:29,259] TRACE Controller 0 epoch 55 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,306] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 0 (state.change.logger)
[2018-04-21 06:19:29,306] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 0 (state.change.logger)
[2018-04-21 06:19:29,309] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 0 (state.change.logger)
[2018-04-21 06:19:29,316] TRACE Controller 0 epoch 55 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:19:29,347] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 55 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,347] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 55 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,357] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 55 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,358] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 55 for partition [kafka_topic,0] since its associated leader epoch 32 is old. Current leader epoch is 32 (state.change.logger)
[2018-04-21 06:19:29,358] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 55 for partition [kafka_test,0] since its associated leader epoch 53 is old. Current leader epoch is 53 (state.change.logger)
[2018-04-21 06:19:29,358] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 55 for partition [project_topic,0] since its associated leader epoch 32 is old. Current leader epoch is 32 (state.change.logger)
[2018-04-21 06:19:29,371] TRACE Controller 0 epoch 55 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:19:29,436] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 2 (state.change.logger)
[2018-04-21 06:19:29,450] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 2 (state.change.logger)
[2018-04-21 06:19:29,450] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:32,ControllerEpoch:54),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 2 (state.change.logger)
[2018-04-21 06:19:29,457] TRACE Controller 0 epoch 55 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:19:29,486] TRACE Controller 0 epoch 55 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,495] TRACE Controller 0 epoch 55 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:19:29,495] TRACE Controller 0 epoch 55 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,567] TRACE Controller 0 epoch 55 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,571] TRACE Controller 0 epoch 55 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:19:29,573] TRACE Controller 0 epoch 55 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,639] TRACE Controller 0 epoch 55 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,640] TRACE Controller 0 epoch 55 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:19:29,641] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,644] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,646] TRACE Controller 0 epoch 55 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,646] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:19:29,647] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 55 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,648] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 55 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,648] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 55 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,649] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 55 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,650] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 55 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,650] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 55 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,651] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 55 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:19:29,652] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 55 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:19:29,653] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 55 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:19:29,653] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 55 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:19:29,653] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 55 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:19:29,653] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 55 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:19:29,654] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:19:29,654] TRACE Controller 0 epoch 55 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:19:29,665] TRACE Controller 0 epoch 55 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:19:29,677] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 4 (state.change.logger)
[2018-04-21 06:19:29,678] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 4 (state.change.logger)
[2018-04-21 06:19:29,692] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 55 with correlation id 4 (state.change.logger)
[2018-04-21 06:19:29,702] TRACE Controller 0 epoch 55 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:39:35,270] TRACE Controller 0 epoch 56 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,312] ERROR Controller 0 epoch 56 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:39:35,317] TRACE Controller 0 epoch 56 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,356] ERROR Controller 0 epoch 56 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:39:35,362] TRACE Controller 0 epoch 56 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,424] ERROR Controller 0 epoch 56 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:39:35,579] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:39:35,580] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:39:35,580] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:39:35,585] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 0 (state.change.logger)
[2018-04-21 06:39:35,585] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 0 (state.change.logger)
[2018-04-21 06:39:35,585] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 0 (state.change.logger)
[2018-04-21 06:39:35,585] TRACE Controller 0 epoch 56 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:39:35,585] TRACE Controller 0 epoch 56 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:39:35,586] TRACE Controller 0 epoch 56 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:39:35,586] TRACE Controller 0 epoch 56 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 56 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 56 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,588] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 56 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,588] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 56 for partition [kafka_topic,0] since its associated leader epoch 33 is old. Current leader epoch is 33 (state.change.logger)
[2018-04-21 06:39:35,588] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 56 for partition [kafka_test,0] since its associated leader epoch 54 is old. Current leader epoch is 54 (state.change.logger)
[2018-04-21 06:39:35,589] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 56 for partition [project_topic,0] since its associated leader epoch 33 is old. Current leader epoch is 33 (state.change.logger)
[2018-04-21 06:39:35,590] TRACE Controller 0 epoch 56 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:39:35,590] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:39:35,590] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:39:35,591] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:39:35,594] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 2 (state.change.logger)
[2018-04-21 06:39:35,597] TRACE Controller 0 epoch 56 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,608] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 2 (state.change.logger)
[2018-04-21 06:39:35,609] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:33,ControllerEpoch:55),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 2 (state.change.logger)
[2018-04-21 06:39:35,612] TRACE Controller 0 epoch 56 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:39:35,659] TRACE Controller 0 epoch 56 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,664] TRACE Controller 0 epoch 56 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:39:35,664] TRACE Controller 0 epoch 56 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,752] TRACE Controller 0 epoch 56 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,755] TRACE Controller 0 epoch 56 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:39:35,755] TRACE Controller 0 epoch 56 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,825] TRACE Controller 0 epoch 56 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,832] TRACE Controller 0 epoch 56 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:39:35,834] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,836] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,837] TRACE Controller 0 epoch 56 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,838] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:39:35,839] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 56 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,839] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 56 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,840] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:39:35,840] TRACE Controller 0 epoch 56 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:39:35,841] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 56 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,844] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 56 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,848] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 56 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,848] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 56 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,867] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 56 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:39:35,869] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 56 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:39:35,872] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 56 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:39:35,885] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 56 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:39:35,885] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 56 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:39:35,886] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 56 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:39:35,888] TRACE Controller 0 epoch 56 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:39:35,891] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 4 (state.change.logger)
[2018-04-21 06:39:35,891] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 4 (state.change.logger)
[2018-04-21 06:39:35,891] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 56 with correlation id 4 (state.change.logger)
[2018-04-21 06:39:35,891] TRACE Controller 0 epoch 56 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:44:50,061] TRACE Controller 0 epoch 57 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:50,112] ERROR Controller 0 epoch 57 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:44:50,119] TRACE Controller 0 epoch 57 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:50,228] ERROR Controller 0 epoch 57 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:44:50,249] TRACE Controller 0 epoch 57 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:50,634] ERROR Controller 0 epoch 57 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:44:55,571] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:44:55,572] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:44:55,572] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:44:55,575] TRACE Controller 0 epoch 57 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:44:55,575] TRACE Controller 0 epoch 57 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:44:55,575] TRACE Controller 0 epoch 57 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:44:55,575] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:55,575] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:55,576] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:55,579] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:44:55,583] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:44:55,585] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:44:55,585] TRACE Controller 0 epoch 57 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:55,586] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 0 (state.change.logger)
[2018-04-21 06:44:55,588] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 0 (state.change.logger)
[2018-04-21 06:44:55,597] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 0 (state.change.logger)
[2018-04-21 06:44:55,597] TRACE Controller 0 epoch 57 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:44:55,598] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 57 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:55,598] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 57 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:55,598] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 57 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:55,600] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 57 for partition [kafka_topic,0] since its associated leader epoch 34 is old. Current leader epoch is 34 (state.change.logger)
[2018-04-21 06:44:55,600] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 57 for partition [kafka_test,0] since its associated leader epoch 55 is old. Current leader epoch is 55 (state.change.logger)
[2018-04-21 06:44:55,601] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 57 for partition [project_topic,0] since its associated leader epoch 34 is old. Current leader epoch is 34 (state.change.logger)
[2018-04-21 06:44:55,604] TRACE Controller 0 epoch 57 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:44:55,608] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 2 (state.change.logger)
[2018-04-21 06:44:55,609] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 2 (state.change.logger)
[2018-04-21 06:44:55,609] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:34,ControllerEpoch:56),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 2 (state.change.logger)
[2018-04-21 06:44:55,611] TRACE Controller 0 epoch 57 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:44:56,782] TRACE Controller 0 epoch 57 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:56,785] TRACE Controller 0 epoch 57 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:44:56,785] TRACE Controller 0 epoch 57 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,844] TRACE Controller 0 epoch 57 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,846] TRACE Controller 0 epoch 57 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:44:56,846] TRACE Controller 0 epoch 57 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,940] TRACE Controller 0 epoch 57 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,942] TRACE Controller 0 epoch 57 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:44:56,942] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:56,942] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,942] TRACE Controller 0 epoch 57 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,947] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 57 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:56,949] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 57 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,949] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 57 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,950] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 57 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:56,952] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 57 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,952] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 57 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,952] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:44:56,952] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:44:56,954] TRACE Controller 0 epoch 57 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:44:56,963] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 57 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:44:56,963] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 57 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:44:56,963] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 57 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:44:56,963] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 57 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:44:56,965] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 57 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:44:56,966] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 57 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:44:56,970] TRACE Controller 0 epoch 57 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:44:56,971] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 4 (state.change.logger)
[2018-04-21 06:44:56,973] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 4 (state.change.logger)
[2018-04-21 06:44:56,973] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 57 with correlation id 4 (state.change.logger)
[2018-04-21 06:44:56,973] TRACE Controller 0 epoch 57 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:47:36,044] TRACE Controller 0 epoch 58 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,111] ERROR Controller 0 epoch 58 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:47:36,115] TRACE Controller 0 epoch 58 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,161] ERROR Controller 0 epoch 58 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:47:36,164] TRACE Controller 0 epoch 58 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,208] ERROR Controller 0 epoch 58 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 06:47:36,361] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:47:36,361] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:47:36,363] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:47:36,368] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 0 (state.change.logger)
[2018-04-21 06:47:36,368] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 0 (state.change.logger)
[2018-04-21 06:47:36,370] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 0 (state.change.logger)
[2018-04-21 06:47:36,372] TRACE Controller 0 epoch 58 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:47:36,373] TRACE Controller 0 epoch 58 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:47:36,377] TRACE Controller 0 epoch 58 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:47:36,379] TRACE Controller 0 epoch 58 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 06:47:36,379] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,379] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,380] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,383] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 58 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,383] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:47:36,383] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:47:36,383] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:47:36,385] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 58 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,385] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 58 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,385] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 58 for partition [kafka_topic,0] since its associated leader epoch 35 is old. Current leader epoch is 35 (state.change.logger)
[2018-04-21 06:47:36,388] TRACE Controller 0 epoch 58 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,388] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 58 for partition [kafka_test,0] since its associated leader epoch 56 is old. Current leader epoch is 56 (state.change.logger)
[2018-04-21 06:47:36,388] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 58 for partition [project_topic,0] since its associated leader epoch 35 is old. Current leader epoch is 35 (state.change.logger)
[2018-04-21 06:47:36,391] TRACE Controller 0 epoch 58 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:47:36,391] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 2 (state.change.logger)
[2018-04-21 06:47:36,391] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 2 (state.change.logger)
[2018-04-21 06:47:36,391] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:35,ControllerEpoch:57),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 2 (state.change.logger)
[2018-04-21 06:47:36,393] TRACE Controller 0 epoch 58 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:47:36,438] TRACE Controller 0 epoch 58 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,440] TRACE Controller 0 epoch 58 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:47:36,442] TRACE Controller 0 epoch 58 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,504] TRACE Controller 0 epoch 58 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,509] TRACE Controller 0 epoch 58 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:47:36,511] TRACE Controller 0 epoch 58 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,561] TRACE Controller 0 epoch 58 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,562] TRACE Controller 0 epoch 58 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 06:47:36,562] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,562] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,562] TRACE Controller 0 epoch 58 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:58) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,562] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 58 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,564] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 58 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,565] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 58 for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,565] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 06:47:36,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 58 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,566] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 58 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,569] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 58 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,568] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 06:47:36,569] TRACE Controller 0 epoch 58 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:58) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 06:47:36,572] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 58 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:47:36,572] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 58 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:47:36,572] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 58 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 06:47:36,572] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 58 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 06:47:36,576] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 58 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 06:47:36,576] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 58 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 06:47:36,582] TRACE Controller 0 epoch 58 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 06:47:36,584] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 4 (state.change.logger)
[2018-04-21 06:47:36,584] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 4 (state.change.logger)
[2018-04-21 06:47:36,584] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:36,ControllerEpoch:58),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 58 with correlation id 4 (state.change.logger)
[2018-04-21 06:47:36,584] TRACE Controller 0 epoch 58 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
