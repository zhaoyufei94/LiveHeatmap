[2018-04-23 22:08:22,758] TRACE Controller 0 epoch 180 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:22,822] ERROR Controller 0 epoch 180 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:08:22,827] TRACE Controller 0 epoch 180 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:22,934] ERROR Controller 0 epoch 180 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:08:22,942] TRACE Controller 0 epoch 180 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,022] ERROR Controller 0 epoch 180 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:08:23,249] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:08:23,250] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:08:23,250] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:08:23,254] TRACE Controller 0 epoch 180 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:08:23,255] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 0 (state.change.logger)
[2018-04-23 22:08:23,256] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 0 (state.change.logger)
[2018-04-23 22:08:23,257] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 0 (state.change.logger)
[2018-04-23 22:08:23,255] TRACE Controller 0 epoch 180 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:08:23,258] TRACE Controller 0 epoch 180 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:08:23,259] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,259] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,259] TRACE Controller 0 epoch 180 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:08:23,259] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,260] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:08:23,261] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 180 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,261] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 180 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,262] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 180 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,262] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 180 for partition [kafka_topic,0] since its associated leader epoch 157 is old. Current leader epoch is 157 (state.change.logger)
[2018-04-23 22:08:23,262] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 180 for partition [kafka_test,0] since its associated leader epoch 178 is old. Current leader epoch is 178 (state.change.logger)
[2018-04-23 22:08:23,262] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 180 for partition [project_topic,0] since its associated leader epoch 157 is old. Current leader epoch is 157 (state.change.logger)
[2018-04-23 22:08:23,263] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:08:23,263] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:08:23,265] TRACE Controller 0 epoch 180 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,266] TRACE Controller 0 epoch 180 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:08:23,268] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 2 (state.change.logger)
[2018-04-23 22:08:23,268] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 2 (state.change.logger)
[2018-04-23 22:08:23,270] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 2 (state.change.logger)
[2018-04-23 22:08:23,273] TRACE Controller 0 epoch 180 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:08:23,333] TRACE Controller 0 epoch 180 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,338] TRACE Controller 0 epoch 180 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:08:23,338] TRACE Controller 0 epoch 180 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,406] TRACE Controller 0 epoch 180 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,408] TRACE Controller 0 epoch 180 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:08:23,408] TRACE Controller 0 epoch 180 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,453] TRACE Controller 0 epoch 180 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,455] TRACE Controller 0 epoch 180 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:08:23,455] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,455] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,455] TRACE Controller 0 epoch 180 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,456] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:08:23,456] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:08:23,457] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 180 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,457] TRACE Controller 0 epoch 180 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:08:23,457] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 180 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,457] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 180 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,458] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 180 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,459] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 180 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,459] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 180 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,464] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 180 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:08:23,465] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 180 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:08:23,465] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 180 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:08:23,465] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 180 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:08:23,465] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 180 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:08:23,465] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 180 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:08:23,468] TRACE Controller 0 epoch 180 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:08:23,469] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 4 (state.change.logger)
[2018-04-23 22:08:23,471] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 4 (state.change.logger)
[2018-04-23 22:08:23,472] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 180 with correlation id 4 (state.change.logger)
[2018-04-23 22:08:23,472] TRACE Controller 0 epoch 180 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:09:25,369] TRACE Controller 0 epoch 181 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,473] ERROR Controller 0 epoch 181 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:09:25,481] TRACE Controller 0 epoch 181 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,531] ERROR Controller 0 epoch 181 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:09:25,535] TRACE Controller 0 epoch 181 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,578] ERROR Controller 0 epoch 181 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:09:25,757] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:09:25,758] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:09:25,759] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:09:25,761] TRACE Controller 0 epoch 181 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:09:25,762] TRACE Controller 0 epoch 181 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:09:25,763] TRACE Controller 0 epoch 181 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:09:25,764] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,765] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,765] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,766] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 0 (state.change.logger)
[2018-04-23 22:09:25,766] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:09:25,766] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:09:25,766] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 0 (state.change.logger)
[2018-04-23 22:09:25,766] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:09:25,767] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 0 (state.change.logger)
[2018-04-23 22:09:25,767] TRACE Controller 0 epoch 181 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,768] TRACE Controller 0 epoch 181 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:09:25,770] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 181 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,770] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 181 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,772] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 181 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,773] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 181 for partition [kafka_topic,0] since its associated leader epoch 158 is old. Current leader epoch is 158 (state.change.logger)
[2018-04-23 22:09:25,773] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 181 for partition [kafka_test,0] since its associated leader epoch 179 is old. Current leader epoch is 179 (state.change.logger)
[2018-04-23 22:09:25,774] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 181 for partition [project_topic,0] since its associated leader epoch 158 is old. Current leader epoch is 158 (state.change.logger)
[2018-04-23 22:09:25,777] TRACE Controller 0 epoch 181 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:09:25,781] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 2 (state.change.logger)
[2018-04-23 22:09:25,782] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 2 (state.change.logger)
[2018-04-23 22:09:25,784] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 2 (state.change.logger)
[2018-04-23 22:09:25,786] TRACE Controller 0 epoch 181 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:09:25,823] TRACE Controller 0 epoch 181 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,826] TRACE Controller 0 epoch 181 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:09:25,826] TRACE Controller 0 epoch 181 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,865] TRACE Controller 0 epoch 181 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,866] TRACE Controller 0 epoch 181 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:09:25,866] TRACE Controller 0 epoch 181 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,928] TRACE Controller 0 epoch 181 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,928] TRACE Controller 0 epoch 181 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:09:25,928] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,929] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,929] TRACE Controller 0 epoch 181 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,930] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:09:25,930] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:09:25,930] TRACE Controller 0 epoch 181 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:09:25,930] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 181 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,930] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 181 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,931] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 181 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,931] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 181 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,931] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 181 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,931] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 181 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,932] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 181 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:09:25,933] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 181 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:09:25,933] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 181 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:09:25,933] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 181 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:09:25,934] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 181 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:09:25,934] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 181 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:09:25,934] TRACE Controller 0 epoch 181 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:09:25,935] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 4 (state.change.logger)
[2018-04-23 22:09:25,936] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 4 (state.change.logger)
[2018-04-23 22:09:25,943] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 181 with correlation id 4 (state.change.logger)
[2018-04-23 22:09:25,943] TRACE Controller 0 epoch 181 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:12:09,068] TRACE Controller 0 epoch 182 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,119] ERROR Controller 0 epoch 182 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:12:09,127] TRACE Controller 0 epoch 182 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,219] ERROR Controller 0 epoch 182 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:12:09,226] TRACE Controller 0 epoch 182 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,261] ERROR Controller 0 epoch 182 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:12:09,411] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:12:09,417] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:12:09,417] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:12:09,418] TRACE Controller 0 epoch 182 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:12:09,418] TRACE Controller 0 epoch 182 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:12:09,419] TRACE Controller 0 epoch 182 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:12:09,419] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,419] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,421] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,423] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:12:09,423] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:12:09,424] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:12:09,424] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 0 (state.change.logger)
[2018-04-23 22:12:09,425] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 0 (state.change.logger)
[2018-04-23 22:12:09,426] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 0 (state.change.logger)
[2018-04-23 22:12:09,427] TRACE Controller 0 epoch 182 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,427] TRACE Controller 0 epoch 182 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:12:09,430] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 182 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,431] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 182 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,431] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 182 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,432] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 182 for partition [kafka_topic,0] since its associated leader epoch 159 is old. Current leader epoch is 159 (state.change.logger)
[2018-04-23 22:12:09,432] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 182 for partition [kafka_test,0] since its associated leader epoch 180 is old. Current leader epoch is 180 (state.change.logger)
[2018-04-23 22:12:09,432] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 182 for partition [project_topic,0] since its associated leader epoch 159 is old. Current leader epoch is 159 (state.change.logger)
[2018-04-23 22:12:09,434] TRACE Controller 0 epoch 182 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:12:09,438] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 2 (state.change.logger)
[2018-04-23 22:12:09,440] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 2 (state.change.logger)
[2018-04-23 22:12:09,442] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 2 (state.change.logger)
[2018-04-23 22:12:09,443] TRACE Controller 0 epoch 182 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:12:09,480] TRACE Controller 0 epoch 182 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,481] TRACE Controller 0 epoch 182 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:12:09,482] TRACE Controller 0 epoch 182 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,520] TRACE Controller 0 epoch 182 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,523] TRACE Controller 0 epoch 182 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:12:09,524] TRACE Controller 0 epoch 182 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,557] TRACE Controller 0 epoch 182 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:12:09,560] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:12:09,561] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 182 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,562] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 182 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,563] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 182 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,563] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 182 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,563] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 182 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,563] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 182 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,565] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 182 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:12:09,567] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 182 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:12:09,568] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 182 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:12:09,569] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 182 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:12:09,569] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 182 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:12:09,571] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 182 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:12:09,571] TRACE Controller 0 epoch 182 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:12:09,572] TRACE Controller 0 epoch 182 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:12:09,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 4 (state.change.logger)
[2018-04-23 22:12:09,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 4 (state.change.logger)
[2018-04-23 22:12:09,574] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 182 with correlation id 4 (state.change.logger)
[2018-04-23 22:12:09,575] TRACE Controller 0 epoch 182 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:17,816] TRACE Controller 0 epoch 183 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:17,877] ERROR Controller 0 epoch 183 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:17,880] TRACE Controller 0 epoch 183 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:17,932] ERROR Controller 0 epoch 183 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:17,936] TRACE Controller 0 epoch 183 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,010] ERROR Controller 0 epoch 183 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:18,140] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:18,144] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:18,146] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:18,146] TRACE Controller 0 epoch 183 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:18,146] TRACE Controller 0 epoch 183 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:18,148] TRACE Controller 0 epoch 183 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:18,149] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,150] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,150] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,155] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:18,157] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:18,157] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:18,157] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:18,157] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:18,161] TRACE Controller 0 epoch 183 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,161] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:18,164] TRACE Controller 0 epoch 183 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:18,168] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 183 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,173] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 183 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,175] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 183 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,178] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 183 for partition [kafka_topic,0] since its associated leader epoch 160 is old. Current leader epoch is 160 (state.change.logger)
[2018-04-23 22:13:18,181] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 183 for partition [kafka_test,0] since its associated leader epoch 181 is old. Current leader epoch is 181 (state.change.logger)
[2018-04-23 22:13:18,181] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 183 for partition [project_topic,0] since its associated leader epoch 160 is old. Current leader epoch is 160 (state.change.logger)
[2018-04-23 22:13:18,184] TRACE Controller 0 epoch 183 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:18,185] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:18,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:18,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:18,188] TRACE Controller 0 epoch 183 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:18,229] TRACE Controller 0 epoch 183 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,231] TRACE Controller 0 epoch 183 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:18,232] TRACE Controller 0 epoch 183 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,306] TRACE Controller 0 epoch 183 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,307] TRACE Controller 0 epoch 183 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:18,309] TRACE Controller 0 epoch 183 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,340] TRACE Controller 0 epoch 183 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,341] TRACE Controller 0 epoch 183 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:18,342] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,342] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,342] TRACE Controller 0 epoch 183 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,343] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:18,343] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:18,343] TRACE Controller 0 epoch 183 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:18,344] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 183 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,347] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 183 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,348] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 183 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,349] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 183 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,349] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 183 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,349] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 183 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,351] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 183 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:18,352] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 183 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:18,352] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 183 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:18,352] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 183 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:18,352] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 183 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:18,352] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 183 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:18,357] TRACE Controller 0 epoch 183 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:18,360] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:18,361] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:18,362] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 183 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:18,363] TRACE Controller 0 epoch 183 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:54,927] TRACE Controller 0 epoch 184 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:55,072] ERROR Controller 0 epoch 184 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:55,080] TRACE Controller 0 epoch 184 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:55,267] ERROR Controller 0 epoch 184 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:55,277] TRACE Controller 0 epoch 184 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:55,383] ERROR Controller 0 epoch 184 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:13:55,826] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:55,827] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:55,830] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:55,837] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:55,838] TRACE Controller 0 epoch 184 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:55,839] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:55,842] TRACE Controller 0 epoch 184 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:55,844] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 0 (state.change.logger)
[2018-04-23 22:13:55,846] TRACE Controller 0 epoch 184 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:13:55,851] TRACE Controller 0 epoch 184 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:55,851] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:55,852] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:55,854] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:55,857] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:55,857] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:55,863] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:55,864] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 184 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:55,865] TRACE Controller 0 epoch 184 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:55,865] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 184 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:55,867] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 184 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:55,867] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 184 for partition [kafka_topic,0] since its associated leader epoch 161 is old. Current leader epoch is 161 (state.change.logger)
[2018-04-23 22:13:55,867] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 184 for partition [kafka_test,0] since its associated leader epoch 182 is old. Current leader epoch is 182 (state.change.logger)
[2018-04-23 22:13:55,867] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 184 for partition [project_topic,0] since its associated leader epoch 161 is old. Current leader epoch is 161 (state.change.logger)
[2018-04-23 22:13:55,868] TRACE Controller 0 epoch 184 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:55,874] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:55,877] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:55,885] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 2 (state.change.logger)
[2018-04-23 22:13:55,888] TRACE Controller 0 epoch 184 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:55,980] TRACE Controller 0 epoch 184 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:55,983] TRACE Controller 0 epoch 184 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:55,984] TRACE Controller 0 epoch 184 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,104] TRACE Controller 0 epoch 184 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,110] TRACE Controller 0 epoch 184 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:56,112] TRACE Controller 0 epoch 184 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,179] TRACE Controller 0 epoch 184 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,180] TRACE Controller 0 epoch 184 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:13:56,184] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:56,186] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,186] TRACE Controller 0 epoch 184 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,187] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:13:56,187] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:13:56,189] TRACE Controller 0 epoch 184 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:13:56,190] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 184 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:56,191] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 184 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,192] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 184 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,194] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 184 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:56,195] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 184 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,196] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 184 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,202] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 184 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:56,206] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 184 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:56,210] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 184 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:13:56,212] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 184 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:13:56,213] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 184 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:13:56,216] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 184 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:13:56,222] TRACE Controller 0 epoch 184 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:13:56,229] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:56,232] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:56,233] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 184 with correlation id 4 (state.change.logger)
[2018-04-23 22:13:56,233] TRACE Controller 0 epoch 184 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:15:52,497] TRACE Controller 0 epoch 185 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:52,584] ERROR Controller 0 epoch 185 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:15:52,587] TRACE Controller 0 epoch 185 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:52,674] ERROR Controller 0 epoch 185 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:15:52,682] TRACE Controller 0 epoch 185 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:52,729] ERROR Controller 0 epoch 185 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:15:52,902] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:15:52,903] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:15:52,905] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:15:52,907] TRACE Controller 0 epoch 185 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:15:52,908] TRACE Controller 0 epoch 185 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:15:52,913] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 0 (state.change.logger)
[2018-04-23 22:15:52,913] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 0 (state.change.logger)
[2018-04-23 22:15:52,913] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 0 (state.change.logger)
[2018-04-23 22:15:52,913] TRACE Controller 0 epoch 185 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:15:52,914] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:52,915] TRACE Controller 0 epoch 185 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:15:52,915] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:52,917] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:52,917] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:15:52,919] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:15:52,919] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:15:52,919] TRACE Controller 0 epoch 185 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:52,922] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 185 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:52,922] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 185 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:52,926] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 185 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:52,927] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 185 for partition [kafka_topic,0] since its associated leader epoch 162 is old. Current leader epoch is 162 (state.change.logger)
[2018-04-23 22:15:52,928] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 185 for partition [kafka_test,0] since its associated leader epoch 183 is old. Current leader epoch is 183 (state.change.logger)
[2018-04-23 22:15:52,929] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 185 for partition [project_topic,0] since its associated leader epoch 162 is old. Current leader epoch is 162 (state.change.logger)
[2018-04-23 22:15:52,933] TRACE Controller 0 epoch 185 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:15:52,938] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 2 (state.change.logger)
[2018-04-23 22:15:52,938] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 2 (state.change.logger)
[2018-04-23 22:15:52,942] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 2 (state.change.logger)
[2018-04-23 22:15:52,943] TRACE Controller 0 epoch 185 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:15:52,979] TRACE Controller 0 epoch 185 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:52,981] TRACE Controller 0 epoch 185 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:15:52,983] TRACE Controller 0 epoch 185 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,048] TRACE Controller 0 epoch 185 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,050] TRACE Controller 0 epoch 185 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:15:53,050] TRACE Controller 0 epoch 185 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,129] TRACE Controller 0 epoch 185 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,133] TRACE Controller 0 epoch 185 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:15:53,134] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:53,135] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,135] TRACE Controller 0 epoch 185 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,138] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:15:53,142] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:15:53,144] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 185 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:53,147] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 185 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,148] TRACE Controller 0 epoch 185 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:15:53,151] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 185 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,153] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 185 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:53,154] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 185 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,154] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 185 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,154] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 185 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:15:53,155] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 185 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:15:53,157] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 185 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:15:53,160] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 185 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:15:53,160] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 185 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:15:53,164] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 185 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:15:53,169] TRACE Controller 0 epoch 185 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:15:53,177] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 4 (state.change.logger)
[2018-04-23 22:15:53,178] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 4 (state.change.logger)
[2018-04-23 22:15:53,182] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 185 with correlation id 4 (state.change.logger)
[2018-04-23 22:15:53,184] TRACE Controller 0 epoch 185 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:16:59,449] TRACE Controller 0 epoch 186 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:16:59,621] ERROR Controller 0 epoch 186 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:16:59,634] TRACE Controller 0 epoch 186 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:16:59,796] ERROR Controller 0 epoch 186 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:16:59,814] TRACE Controller 0 epoch 186 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:16:59,991] ERROR Controller 0 epoch 186 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:17:00,432] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:17:00,433] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:17:00,434] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:17:00,443] TRACE Controller 0 epoch 186 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:17:00,444] TRACE Controller 0 epoch 186 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:17:00,444] TRACE Controller 0 epoch 186 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:17:00,444] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,447] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,447] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 0 (state.change.logger)
[2018-04-23 22:17:00,452] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 0 (state.change.logger)
[2018-04-23 22:17:00,449] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,457] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 0 (state.change.logger)
[2018-04-23 22:17:00,458] TRACE Controller 0 epoch 186 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:17:00,461] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:17:00,462] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 186 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,462] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:17:00,466] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 186 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,467] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:17:00,467] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 186 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,469] TRACE Controller 0 epoch 186 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,469] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 186 for partition [kafka_topic,0] since its associated leader epoch 163 is old. Current leader epoch is 163 (state.change.logger)
[2018-04-23 22:17:00,471] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 186 for partition [kafka_test,0] since its associated leader epoch 184 is old. Current leader epoch is 184 (state.change.logger)
[2018-04-23 22:17:00,476] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 186 for partition [project_topic,0] since its associated leader epoch 163 is old. Current leader epoch is 163 (state.change.logger)
[2018-04-23 22:17:00,483] TRACE Controller 0 epoch 186 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:17:00,489] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 2 (state.change.logger)
[2018-04-23 22:17:00,493] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 2 (state.change.logger)
[2018-04-23 22:17:00,500] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 2 (state.change.logger)
[2018-04-23 22:17:00,501] TRACE Controller 0 epoch 186 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:17:00,595] TRACE Controller 0 epoch 186 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,602] TRACE Controller 0 epoch 186 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:17:00,602] TRACE Controller 0 epoch 186 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,712] TRACE Controller 0 epoch 186 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,717] TRACE Controller 0 epoch 186 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:17:00,718] TRACE Controller 0 epoch 186 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,827] TRACE Controller 0 epoch 186 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,835] TRACE Controller 0 epoch 186 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:17:00,837] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,838] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,840] TRACE Controller 0 epoch 186 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,847] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:17:00,847] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:17:00,847] TRACE Controller 0 epoch 186 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:17:00,854] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 186 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,856] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 186 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,859] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 186 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,871] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 186 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,872] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 186 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,874] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 186 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,918] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 186 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:17:00,919] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 186 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:17:00,920] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 186 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:17:00,935] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 186 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:17:00,936] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 186 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:17:00,953] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 186 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:17:00,954] TRACE Controller 0 epoch 186 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:17:00,960] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 4 (state.change.logger)
[2018-04-23 22:17:00,963] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 4 (state.change.logger)
[2018-04-23 22:17:00,964] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 186 with correlation id 4 (state.change.logger)
[2018-04-23 22:17:00,966] TRACE Controller 0 epoch 186 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:18:04,619] TRACE Controller 0 epoch 187 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:04,686] ERROR Controller 0 epoch 187 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:18:04,697] TRACE Controller 0 epoch 187 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:04,799] ERROR Controller 0 epoch 187 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:18:04,807] TRACE Controller 0 epoch 187 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:04,869] ERROR Controller 0 epoch 187 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:18:05,041] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:18:05,041] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:18:05,041] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:18:05,048] TRACE Controller 0 epoch 187 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:18:05,049] TRACE Controller 0 epoch 187 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:18:05,049] TRACE Controller 0 epoch 187 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:18:05,050] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,051] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,051] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 0 (state.change.logger)
[2018-04-23 22:18:05,052] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,053] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 0 (state.change.logger)
[2018-04-23 22:18:05,053] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 0 (state.change.logger)
[2018-04-23 22:18:05,054] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:18:05,057] TRACE Controller 0 epoch 187 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:18:05,060] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:18:05,060] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:18:05,061] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 187 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,063] TRACE Controller 0 epoch 187 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,067] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 187 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,070] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 187 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,071] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 187 for partition [kafka_topic,0] since its associated leader epoch 164 is old. Current leader epoch is 164 (state.change.logger)
[2018-04-23 22:18:05,073] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 187 for partition [kafka_test,0] since its associated leader epoch 185 is old. Current leader epoch is 185 (state.change.logger)
[2018-04-23 22:18:05,074] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 187 for partition [project_topic,0] since its associated leader epoch 164 is old. Current leader epoch is 164 (state.change.logger)
[2018-04-23 22:18:05,079] TRACE Controller 0 epoch 187 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:18:05,084] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 2 (state.change.logger)
[2018-04-23 22:18:05,090] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 2 (state.change.logger)
[2018-04-23 22:18:05,090] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 2 (state.change.logger)
[2018-04-23 22:18:05,092] TRACE Controller 0 epoch 187 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:18:05,123] TRACE Controller 0 epoch 187 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,125] TRACE Controller 0 epoch 187 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:18:05,125] TRACE Controller 0 epoch 187 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,182] TRACE Controller 0 epoch 187 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,184] TRACE Controller 0 epoch 187 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:18:05,184] TRACE Controller 0 epoch 187 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,236] TRACE Controller 0 epoch 187 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,238] TRACE Controller 0 epoch 187 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:18:05,239] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,240] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,240] TRACE Controller 0 epoch 187 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,240] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:18:05,242] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:18:05,242] TRACE Controller 0 epoch 187 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:18:05,244] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 187 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,245] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 187 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,245] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 187 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,248] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 187 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,251] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 187 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,251] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 187 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,254] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 187 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:18:05,255] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 187 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:18:05,256] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 187 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:18:05,257] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 187 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:18:05,257] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 187 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:18:05,259] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 187 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:18:05,262] TRACE Controller 0 epoch 187 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:18:05,265] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 4 (state.change.logger)
[2018-04-23 22:18:05,265] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 4 (state.change.logger)
[2018-04-23 22:18:05,266] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 187 with correlation id 4 (state.change.logger)
[2018-04-23 22:18:05,268] TRACE Controller 0 epoch 187 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:13,065] TRACE Controller 0 epoch 188 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,158] ERROR Controller 0 epoch 188 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:13,163] TRACE Controller 0 epoch 188 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,288] ERROR Controller 0 epoch 188 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:13,299] TRACE Controller 0 epoch 188 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,409] ERROR Controller 0 epoch 188 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:13,682] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:13,684] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:13,690] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:13,695] TRACE Controller 0 epoch 188 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:13,698] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:13,698] TRACE Controller 0 epoch 188 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:13,702] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:13,702] TRACE Controller 0 epoch 188 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:13,705] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,706] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:13,709] TRACE Controller 0 epoch 188 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:13,709] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,709] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,710] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:13,712] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:13,712] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 188 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,712] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:13,713] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 188 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,714] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 188 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,714] TRACE Controller 0 epoch 188 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,715] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 188 for partition [kafka_topic,0] since its associated leader epoch 165 is old. Current leader epoch is 165 (state.change.logger)
[2018-04-23 22:19:13,718] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 188 for partition [kafka_test,0] since its associated leader epoch 186 is old. Current leader epoch is 186 (state.change.logger)
[2018-04-23 22:19:13,718] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 188 for partition [project_topic,0] since its associated leader epoch 165 is old. Current leader epoch is 165 (state.change.logger)
[2018-04-23 22:19:13,720] TRACE Controller 0 epoch 188 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:13,728] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:13,729] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:13,729] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:13,731] TRACE Controller 0 epoch 188 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:13,804] TRACE Controller 0 epoch 188 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,809] TRACE Controller 0 epoch 188 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:13,811] TRACE Controller 0 epoch 188 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,901] TRACE Controller 0 epoch 188 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,904] TRACE Controller 0 epoch 188 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:13,904] TRACE Controller 0 epoch 188 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,985] TRACE Controller 0 epoch 188 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,986] TRACE Controller 0 epoch 188 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:13,989] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:13,990] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:13,992] TRACE Controller 0 epoch 188 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:13,993] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:13,994] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:13,995] TRACE Controller 0 epoch 188 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:13,999] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 188 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:14,002] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 188 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:14,003] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 188 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:14,006] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 188 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:14,006] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 188 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:14,007] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 188 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:14,009] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 188 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:14,014] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 188 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:14,018] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 188 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:14,018] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 188 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:14,020] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 188 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:14,021] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 188 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:14,024] TRACE Controller 0 epoch 188 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:14,032] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:14,032] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:14,036] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 188 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:14,038] TRACE Controller 0 epoch 188 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:50,609] TRACE Controller 0 epoch 189 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:50,643] ERROR Controller 0 epoch 189 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:50,646] TRACE Controller 0 epoch 189 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:50,712] ERROR Controller 0 epoch 189 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:50,715] TRACE Controller 0 epoch 189 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:50,772] ERROR Controller 0 epoch 189 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:19:50,917] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:50,917] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:50,917] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:50,919] TRACE Controller 0 epoch 189 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:50,919] TRACE Controller 0 epoch 189 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:50,920] TRACE Controller 0 epoch 189 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:19:50,920] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:50,920] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:50,920] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:50,921] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:50,922] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:50,922] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:50,923] TRACE Controller 0 epoch 189 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:50,932] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:50,936] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:50,944] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 0 (state.change.logger)
[2018-04-23 22:19:50,947] TRACE Controller 0 epoch 189 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:50,950] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 189 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:50,953] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 189 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:50,953] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 189 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:50,955] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 189 for partition [kafka_topic,0] since its associated leader epoch 166 is old. Current leader epoch is 166 (state.change.logger)
[2018-04-23 22:19:50,955] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 189 for partition [kafka_test,0] since its associated leader epoch 187 is old. Current leader epoch is 187 (state.change.logger)
[2018-04-23 22:19:50,957] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 189 for partition [project_topic,0] since its associated leader epoch 166 is old. Current leader epoch is 166 (state.change.logger)
[2018-04-23 22:19:50,959] TRACE Controller 0 epoch 189 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:50,961] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:50,962] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:50,963] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 2 (state.change.logger)
[2018-04-23 22:19:50,964] TRACE Controller 0 epoch 189 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:50,996] TRACE Controller 0 epoch 189 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:50,997] TRACE Controller 0 epoch 189 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:50,997] TRACE Controller 0 epoch 189 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,047] TRACE Controller 0 epoch 189 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,050] TRACE Controller 0 epoch 189 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:51,051] TRACE Controller 0 epoch 189 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,095] TRACE Controller 0 epoch 189 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,097] TRACE Controller 0 epoch 189 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:19:51,097] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:51,097] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,099] TRACE Controller 0 epoch 189 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,099] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:19:51,099] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:19:51,101] TRACE Controller 0 epoch 189 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:19:51,102] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 189 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:51,106] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 189 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,110] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 189 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,110] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 189 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:51,111] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 189 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,113] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 189 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,119] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 189 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:51,122] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 189 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:51,123] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 189 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:19:51,123] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 189 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:19:51,124] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 189 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:19:51,124] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 189 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:19:51,125] TRACE Controller 0 epoch 189 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:19:51,128] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:51,129] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:51,130] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 189 with correlation id 4 (state.change.logger)
[2018-04-23 22:19:51,131] TRACE Controller 0 epoch 189 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:21:01,791] TRACE Controller 0 epoch 190 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:01,936] ERROR Controller 0 epoch 190 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:21:01,946] TRACE Controller 0 epoch 190 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:02,082] ERROR Controller 0 epoch 190 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:21:02,099] TRACE Controller 0 epoch 190 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:02,259] ERROR Controller 0 epoch 190 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:21:02,673] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:21:02,674] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:21:02,676] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:21:02,686] TRACE Controller 0 epoch 190 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:21:02,690] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 0 (state.change.logger)
[2018-04-23 22:21:02,690] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 0 (state.change.logger)
[2018-04-23 22:21:02,691] TRACE Controller 0 epoch 190 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:21:02,692] TRACE Controller 0 epoch 190 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:21:02,694] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:02,695] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 0 (state.change.logger)
[2018-04-23 22:21:02,696] TRACE Controller 0 epoch 190 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:21:02,696] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:02,698] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:02,702] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:21:02,703] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:21:02,703] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 190 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:02,705] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:21:02,709] TRACE Controller 0 epoch 190 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:02,711] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 190 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:02,714] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 190 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:02,717] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 190 for partition [kafka_topic,0] since its associated leader epoch 167 is old. Current leader epoch is 167 (state.change.logger)
[2018-04-23 22:21:02,721] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 190 for partition [kafka_test,0] since its associated leader epoch 188 is old. Current leader epoch is 188 (state.change.logger)
[2018-04-23 22:21:02,728] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 190 for partition [project_topic,0] since its associated leader epoch 167 is old. Current leader epoch is 167 (state.change.logger)
[2018-04-23 22:21:02,742] TRACE Controller 0 epoch 190 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:21:02,749] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 2 (state.change.logger)
[2018-04-23 22:21:02,749] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 2 (state.change.logger)
[2018-04-23 22:21:02,749] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 2 (state.change.logger)
[2018-04-23 22:21:02,753] TRACE Controller 0 epoch 190 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:21:02,841] TRACE Controller 0 epoch 190 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:02,847] TRACE Controller 0 epoch 190 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:21:02,848] TRACE Controller 0 epoch 190 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:02,988] TRACE Controller 0 epoch 190 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:02,996] TRACE Controller 0 epoch 190 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:21:02,999] TRACE Controller 0 epoch 190 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,138] TRACE Controller 0 epoch 190 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,143] TRACE Controller 0 epoch 190 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:21:03,143] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:03,143] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,146] TRACE Controller 0 epoch 190 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:03,151] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:21:03,153] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:21:03,154] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 190 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:03,155] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 190 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:03,157] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 190 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,157] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 190 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:03,157] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 190 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,158] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 190 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:03,161] TRACE Controller 0 epoch 190 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:21:03,162] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 190 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:21:03,166] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 190 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:21:03,170] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 190 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:21:03,171] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 190 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:21:03,171] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 190 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:21:03,176] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 190 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:21:03,182] TRACE Controller 0 epoch 190 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:21:03,187] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 4 (state.change.logger)
[2018-04-23 22:21:03,189] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 4 (state.change.logger)
[2018-04-23 22:21:03,192] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 190 with correlation id 4 (state.change.logger)
[2018-04-23 22:21:03,195] TRACE Controller 0 epoch 190 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:22:14,832] TRACE Controller 0 epoch 191 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:14,951] ERROR Controller 0 epoch 191 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:22:14,964] TRACE Controller 0 epoch 191 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,072] ERROR Controller 0 epoch 191 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:22:15,087] TRACE Controller 0 epoch 191 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,192] ERROR Controller 0 epoch 191 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:22:15,361] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:22:15,361] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:22:15,362] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:22:15,363] TRACE Controller 0 epoch 191 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:22:15,366] TRACE Controller 0 epoch 191 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:22:15,367] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 0 (state.change.logger)
[2018-04-23 22:22:15,367] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 0 (state.change.logger)
[2018-04-23 22:22:15,368] TRACE Controller 0 epoch 191 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:22:15,368] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 0 (state.change.logger)
[2018-04-23 22:22:15,368] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,370] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,370] TRACE Controller 0 epoch 191 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:22:15,370] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,370] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:22:15,370] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:22:15,375] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 191 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,376] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 191 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,376] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:22:15,376] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 191 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,379] TRACE Controller 0 epoch 191 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,380] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 191 for partition [kafka_topic,0] since its associated leader epoch 168 is old. Current leader epoch is 168 (state.change.logger)
[2018-04-23 22:22:15,382] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 191 for partition [kafka_test,0] since its associated leader epoch 189 is old. Current leader epoch is 189 (state.change.logger)
[2018-04-23 22:22:15,384] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 191 for partition [project_topic,0] since its associated leader epoch 168 is old. Current leader epoch is 168 (state.change.logger)
[2018-04-23 22:22:15,387] TRACE Controller 0 epoch 191 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:22:15,388] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 2 (state.change.logger)
[2018-04-23 22:22:15,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 2 (state.change.logger)
[2018-04-23 22:22:15,389] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 2 (state.change.logger)
[2018-04-23 22:22:15,390] TRACE Controller 0 epoch 191 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:22:15,440] TRACE Controller 0 epoch 191 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,445] TRACE Controller 0 epoch 191 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:22:15,446] TRACE Controller 0 epoch 191 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,529] TRACE Controller 0 epoch 191 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,533] TRACE Controller 0 epoch 191 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:22:15,533] TRACE Controller 0 epoch 191 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,597] TRACE Controller 0 epoch 191 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,598] TRACE Controller 0 epoch 191 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:22:15,599] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,599] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,599] TRACE Controller 0 epoch 191 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,600] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:22:15,602] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 191 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,602] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 191 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,603] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 191 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,604] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:22:15,604] TRACE Controller 0 epoch 191 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:22:15,604] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 191 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 191 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,606] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 191 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,609] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 191 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:22:15,610] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 191 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:22:15,610] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 191 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:22:15,610] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 191 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:22:15,611] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 191 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:22:15,612] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 191 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:22:15,614] TRACE Controller 0 epoch 191 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:22:15,623] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 4 (state.change.logger)
[2018-04-23 22:22:15,627] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 4 (state.change.logger)
[2018-04-23 22:22:15,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 191 with correlation id 4 (state.change.logger)
[2018-04-23 22:22:15,631] TRACE Controller 0 epoch 191 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:05,784] TRACE Controller 0 epoch 192 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:05,855] ERROR Controller 0 epoch 192 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:05,860] TRACE Controller 0 epoch 192 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:05,949] ERROR Controller 0 epoch 192 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:05,956] TRACE Controller 0 epoch 192 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,056] ERROR Controller 0 epoch 192 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:06,269] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:06,271] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:06,274] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:06,275] TRACE Controller 0 epoch 192 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:06,275] TRACE Controller 0 epoch 192 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:06,275] TRACE Controller 0 epoch 192 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:06,275] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,276] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,276] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,277] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:06,277] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:06,277] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:06,278] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:06,278] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:06,278] TRACE Controller 0 epoch 192 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:06,279] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:06,280] TRACE Controller 0 epoch 192 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,281] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 192 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,283] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 192 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,284] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 192 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,284] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 192 for partition [kafka_topic,0] since its associated leader epoch 169 is old. Current leader epoch is 169 (state.change.logger)
[2018-04-23 22:24:06,286] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 192 for partition [kafka_test,0] since its associated leader epoch 190 is old. Current leader epoch is 190 (state.change.logger)
[2018-04-23 22:24:06,289] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 192 for partition [project_topic,0] since its associated leader epoch 169 is old. Current leader epoch is 169 (state.change.logger)
[2018-04-23 22:24:06,293] TRACE Controller 0 epoch 192 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:06,297] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:06,300] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:06,303] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:06,304] TRACE Controller 0 epoch 192 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:06,357] TRACE Controller 0 epoch 192 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,357] TRACE Controller 0 epoch 192 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:06,358] TRACE Controller 0 epoch 192 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,411] TRACE Controller 0 epoch 192 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,413] TRACE Controller 0 epoch 192 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:06,413] TRACE Controller 0 epoch 192 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,460] TRACE Controller 0 epoch 192 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,461] TRACE Controller 0 epoch 192 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:06,462] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,462] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,463] TRACE Controller 0 epoch 192 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,467] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:06,467] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:06,467] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 192 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,468] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 192 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,469] TRACE Controller 0 epoch 192 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:06,469] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 192 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,471] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 192 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,471] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 192 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,472] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 192 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,475] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 192 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:06,476] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 192 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:06,476] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 192 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:06,476] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 192 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:06,476] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 192 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:06,477] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 192 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:06,481] TRACE Controller 0 epoch 192 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:06,485] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:06,485] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:06,491] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 192 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:06,493] TRACE Controller 0 epoch 192 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:53,985] TRACE Controller 0 epoch 193 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,042] ERROR Controller 0 epoch 193 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:54,048] TRACE Controller 0 epoch 193 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,158] ERROR Controller 0 epoch 193 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:54,162] TRACE Controller 0 epoch 193 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,235] ERROR Controller 0 epoch 193 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 22:24:54,350] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:54,351] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:54,351] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:54,354] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:54,355] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:54,355] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 0 (state.change.logger)
[2018-04-23 22:24:54,356] TRACE Controller 0 epoch 193 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:54,356] TRACE Controller 0 epoch 193 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:54,357] TRACE Controller 0 epoch 193 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:54,358] TRACE Controller 0 epoch 193 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 22:24:54,358] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,359] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,359] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,360] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 193 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,361] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 193 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,361] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 193 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,361] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 193 for partition [kafka_topic,0] since its associated leader epoch 170 is old. Current leader epoch is 170 (state.change.logger)
[2018-04-23 22:24:54,361] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 193 for partition [kafka_test,0] since its associated leader epoch 191 is old. Current leader epoch is 191 (state.change.logger)
[2018-04-23 22:24:54,361] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 193 for partition [project_topic,0] since its associated leader epoch 170 is old. Current leader epoch is 170 (state.change.logger)
[2018-04-23 22:24:54,361] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:54,362] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:54,362] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:54,363] TRACE Controller 0 epoch 193 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:54,367] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:54,367] TRACE Controller 0 epoch 193 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,367] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:54,368] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 2 (state.change.logger)
[2018-04-23 22:24:54,371] TRACE Controller 0 epoch 193 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:54,408] TRACE Controller 0 epoch 193 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,409] TRACE Controller 0 epoch 193 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:54,409] TRACE Controller 0 epoch 193 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,467] TRACE Controller 0 epoch 193 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,468] TRACE Controller 0 epoch 193 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:54,468] TRACE Controller 0 epoch 193 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,523] TRACE Controller 0 epoch 193 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,527] TRACE Controller 0 epoch 193 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 22:24:54,529] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,531] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,531] TRACE Controller 0 epoch 193 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,533] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 193 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,535] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 22:24:54,535] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 22:24:54,535] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 193 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,535] TRACE Controller 0 epoch 193 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 22:24:54,536] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 193 for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,537] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 193 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,537] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 193 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,537] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 193 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,539] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 193 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:54,539] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 193 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:54,540] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 193 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 22:24:54,540] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 193 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 22:24:54,542] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 193 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 22:24:54,544] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 193 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 22:24:54,547] TRACE Controller 0 epoch 193 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 22:24:54,551] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:54,551] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:54,551] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 193 with correlation id 4 (state.change.logger)
[2018-04-23 22:24:54,552] TRACE Controller 0 epoch 193 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
