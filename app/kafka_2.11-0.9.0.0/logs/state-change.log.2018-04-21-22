[2018-04-21 22:00:48,749] TRACE Controller 0 epoch 100 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:48,854] ERROR Controller 0 epoch 100 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:00:48,860] TRACE Controller 0 epoch 100 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:48,927] ERROR Controller 0 epoch 100 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:00:48,931] TRACE Controller 0 epoch 100 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,027] ERROR Controller 0 epoch 100 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:00:49,179] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:00:49,179] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:00:49,180] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:00:49,186] TRACE Controller 0 epoch 100 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:00:49,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 0 (state.change.logger)
[2018-04-21 22:00:49,188] TRACE Controller 0 epoch 100 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:00:49,190] TRACE Controller 0 epoch 100 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:00:49,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 0 (state.change.logger)
[2018-04-21 22:00:49,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 0 (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:00:49,192] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:00:49,194] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:00:49,194] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 100 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,195] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 100 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,196] TRACE Controller 0 epoch 100 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,196] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 100 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,196] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 100 for partition [kafka_topic,0] since its associated leader epoch 77 is old. Current leader epoch is 77 (state.change.logger)
[2018-04-21 22:00:49,198] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 100 for partition [kafka_test,0] since its associated leader epoch 98 is old. Current leader epoch is 98 (state.change.logger)
[2018-04-21 22:00:49,198] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 100 for partition [project_topic,0] since its associated leader epoch 77 is old. Current leader epoch is 77 (state.change.logger)
[2018-04-21 22:00:49,201] TRACE Controller 0 epoch 100 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:00:49,211] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 2 (state.change.logger)
[2018-04-21 22:00:49,212] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 2 (state.change.logger)
[2018-04-21 22:00:49,215] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 2 (state.change.logger)
[2018-04-21 22:00:49,216] TRACE Controller 0 epoch 100 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:00:49,266] TRACE Controller 0 epoch 100 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,272] TRACE Controller 0 epoch 100 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:00:49,273] TRACE Controller 0 epoch 100 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,311] TRACE Controller 0 epoch 100 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,313] TRACE Controller 0 epoch 100 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:00:49,313] TRACE Controller 0 epoch 100 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,384] TRACE Controller 0 epoch 100 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,386] TRACE Controller 0 epoch 100 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:00:49,387] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,387] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,387] TRACE Controller 0 epoch 100 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,389] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:00:49,389] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 100 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,389] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 100 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,389] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 100 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,389] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 100 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,391] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 100 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,393] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:00:49,393] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 100 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,396] TRACE Controller 0 epoch 100 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:00:49,403] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 100 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:00:49,403] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 100 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:00:49,411] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 100 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:00:49,411] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 100 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:00:49,411] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 100 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:00:49,411] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 100 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:00:49,411] TRACE Controller 0 epoch 100 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:00:49,414] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 4 (state.change.logger)
[2018-04-21 22:00:49,416] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 4 (state.change.logger)
[2018-04-21 22:00:49,420] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 100 with correlation id 4 (state.change.logger)
[2018-04-21 22:00:49,422] TRACE Controller 0 epoch 100 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:01:50,517] TRACE Controller 0 epoch 101 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:50,606] ERROR Controller 0 epoch 101 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:01:50,613] TRACE Controller 0 epoch 101 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:50,687] ERROR Controller 0 epoch 101 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:01:50,693] TRACE Controller 0 epoch 101 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:50,792] ERROR Controller 0 epoch 101 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:01:50,996] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:01:50,996] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:01:50,998] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:01:51,004] TRACE Controller 0 epoch 101 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:01:51,005] TRACE Controller 0 epoch 101 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:01:51,005] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 0 (state.change.logger)
[2018-04-21 22:01:51,005] TRACE Controller 0 epoch 101 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:01:51,005] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 0 (state.change.logger)
[2018-04-21 22:01:51,005] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,008] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 0 (state.change.logger)
[2018-04-21 22:01:51,009] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,011] TRACE Controller 0 epoch 101 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:01:51,011] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,015] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:01:51,016] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 101 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,016] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:01:51,016] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:01:51,018] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 101 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,018] TRACE Controller 0 epoch 101 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,019] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 101 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,021] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 101 for partition [kafka_topic,0] since its associated leader epoch 78 is old. Current leader epoch is 78 (state.change.logger)
[2018-04-21 22:01:51,021] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 101 for partition [kafka_test,0] since its associated leader epoch 99 is old. Current leader epoch is 99 (state.change.logger)
[2018-04-21 22:01:51,023] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 101 for partition [project_topic,0] since its associated leader epoch 78 is old. Current leader epoch is 78 (state.change.logger)
[2018-04-21 22:01:51,026] TRACE Controller 0 epoch 101 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:01:51,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 2 (state.change.logger)
[2018-04-21 22:01:51,028] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 2 (state.change.logger)
[2018-04-21 22:01:51,029] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 2 (state.change.logger)
[2018-04-21 22:01:51,029] TRACE Controller 0 epoch 101 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:01:51,065] TRACE Controller 0 epoch 101 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,067] TRACE Controller 0 epoch 101 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:01:51,068] TRACE Controller 0 epoch 101 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,119] TRACE Controller 0 epoch 101 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,123] TRACE Controller 0 epoch 101 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:01:51,123] TRACE Controller 0 epoch 101 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,192] TRACE Controller 0 epoch 101 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,194] TRACE Controller 0 epoch 101 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:01:51,194] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,194] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,194] TRACE Controller 0 epoch 101 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,194] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:01:51,196] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 101 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,199] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 101 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,199] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 101 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,200] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:01:51,201] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 101 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,201] TRACE Controller 0 epoch 101 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:01:51,203] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 101 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,203] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 101 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,207] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 101 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:01:51,210] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 101 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:01:51,214] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 101 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:01:51,216] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 101 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:01:51,216] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 101 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:01:51,216] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 101 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:01:51,217] TRACE Controller 0 epoch 101 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:01:51,217] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 4 (state.change.logger)
[2018-04-21 22:01:51,220] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 4 (state.change.logger)
[2018-04-21 22:01:51,220] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 101 with correlation id 4 (state.change.logger)
[2018-04-21 22:01:51,225] TRACE Controller 0 epoch 101 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:03:35,021] TRACE Controller 0 epoch 102 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:35,193] ERROR Controller 0 epoch 102 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:03:35,215] TRACE Controller 0 epoch 102 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:35,351] ERROR Controller 0 epoch 102 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:03:35,363] TRACE Controller 0 epoch 102 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:35,498] ERROR Controller 0 epoch 102 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:03:35,828] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:03:35,829] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:03:35,832] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:03:35,842] TRACE Controller 0 epoch 102 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:03:35,842] TRACE Controller 0 epoch 102 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:03:35,843] TRACE Controller 0 epoch 102 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:03:35,843] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:35,843] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:35,843] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:35,845] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:03:35,845] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:03:35,845] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:03:35,849] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 0 (state.change.logger)
[2018-04-21 22:03:35,850] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 0 (state.change.logger)
[2018-04-21 22:03:35,851] TRACE Controller 0 epoch 102 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:35,851] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 0 (state.change.logger)
[2018-04-21 22:03:35,856] TRACE Controller 0 epoch 102 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:03:35,858] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 102 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:35,859] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 102 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:35,859] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 102 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:35,862] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 102 for partition [kafka_topic,0] since its associated leader epoch 79 is old. Current leader epoch is 79 (state.change.logger)
[2018-04-21 22:03:35,862] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 102 for partition [kafka_test,0] since its associated leader epoch 100 is old. Current leader epoch is 100 (state.change.logger)
[2018-04-21 22:03:35,865] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 102 for partition [project_topic,0] since its associated leader epoch 79 is old. Current leader epoch is 79 (state.change.logger)
[2018-04-21 22:03:35,869] TRACE Controller 0 epoch 102 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:03:35,873] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 2 (state.change.logger)
[2018-04-21 22:03:35,876] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 2 (state.change.logger)
[2018-04-21 22:03:35,878] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 2 (state.change.logger)
[2018-04-21 22:03:35,881] TRACE Controller 0 epoch 102 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:03:35,947] TRACE Controller 0 epoch 102 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:35,948] TRACE Controller 0 epoch 102 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:03:35,949] TRACE Controller 0 epoch 102 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,111] TRACE Controller 0 epoch 102 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,117] TRACE Controller 0 epoch 102 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:03:36,118] TRACE Controller 0 epoch 102 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,230] TRACE Controller 0 epoch 102 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,235] TRACE Controller 0 epoch 102 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:03:36,237] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:36,238] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,239] TRACE Controller 0 epoch 102 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,243] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:03:36,246] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:03:36,247] TRACE Controller 0 epoch 102 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:03:36,251] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 102 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:36,254] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 102 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,257] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 102 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,258] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 102 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:36,260] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 102 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,260] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 102 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,265] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 102 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:03:36,265] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 102 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:03:36,265] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 102 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:03:36,266] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 102 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:03:36,266] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 102 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:03:36,266] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 102 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:03:36,273] TRACE Controller 0 epoch 102 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:03:36,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 4 (state.change.logger)
[2018-04-21 22:03:36,280] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 4 (state.change.logger)
[2018-04-21 22:03:36,284] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 102 with correlation id 4 (state.change.logger)
[2018-04-21 22:03:36,286] TRACE Controller 0 epoch 102 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:04:49,445] TRACE Controller 0 epoch 103 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:49,508] ERROR Controller 0 epoch 103 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:04:49,514] TRACE Controller 0 epoch 103 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:49,616] ERROR Controller 0 epoch 103 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:04:49,623] TRACE Controller 0 epoch 103 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:49,706] ERROR Controller 0 epoch 103 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:04:49,939] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:04:49,939] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:04:49,939] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:04:49,942] TRACE Controller 0 epoch 103 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:04:49,947] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 0 (state.change.logger)
[2018-04-21 22:04:49,949] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 0 (state.change.logger)
[2018-04-21 22:04:49,949] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 0 (state.change.logger)
[2018-04-21 22:04:49,949] TRACE Controller 0 epoch 103 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:04:49,949] TRACE Controller 0 epoch 103 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:04:49,952] TRACE Controller 0 epoch 103 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:04:49,952] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:49,955] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:49,955] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:49,957] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:04:49,957] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:04:49,959] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 103 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:49,960] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 103 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:49,960] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 103 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:49,962] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 103 for partition [kafka_topic,0] since its associated leader epoch 80 is old. Current leader epoch is 80 (state.change.logger)
[2018-04-21 22:04:49,962] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:04:49,962] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 103 for partition [kafka_test,0] since its associated leader epoch 101 is old. Current leader epoch is 101 (state.change.logger)
[2018-04-21 22:04:49,964] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 103 for partition [project_topic,0] since its associated leader epoch 80 is old. Current leader epoch is 80 (state.change.logger)
[2018-04-21 22:04:49,965] TRACE Controller 0 epoch 103 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:49,967] TRACE Controller 0 epoch 103 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:04:49,971] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 2 (state.change.logger)
[2018-04-21 22:04:49,972] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 2 (state.change.logger)
[2018-04-21 22:04:49,972] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 2 (state.change.logger)
[2018-04-21 22:04:49,973] TRACE Controller 0 epoch 103 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:04:50,019] TRACE Controller 0 epoch 103 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:50,022] TRACE Controller 0 epoch 103 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:04:50,022] TRACE Controller 0 epoch 103 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,089] TRACE Controller 0 epoch 103 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,092] TRACE Controller 0 epoch 103 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:04:50,093] TRACE Controller 0 epoch 103 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,160] TRACE Controller 0 epoch 103 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,162] TRACE Controller 0 epoch 103 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:04:50,162] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:50,163] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,163] TRACE Controller 0 epoch 103 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,163] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:04:50,163] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:04:50,163] TRACE Controller 0 epoch 103 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:04:50,165] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 103 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:50,166] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 103 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,167] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 103 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,167] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 103 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:50,169] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 103 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,170] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 103 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,171] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 103 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:04:50,172] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 103 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:04:50,173] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 103 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:04:50,174] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 103 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:04:50,175] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 103 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:04:50,175] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 103 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:04:50,182] TRACE Controller 0 epoch 103 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:04:50,184] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 4 (state.change.logger)
[2018-04-21 22:04:50,187] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 4 (state.change.logger)
[2018-04-21 22:04:50,189] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 103 with correlation id 4 (state.change.logger)
[2018-04-21 22:04:50,191] TRACE Controller 0 epoch 103 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:07:01,700] TRACE Controller 0 epoch 104 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:01,782] ERROR Controller 0 epoch 104 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:07:01,788] TRACE Controller 0 epoch 104 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:01,865] ERROR Controller 0 epoch 104 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:07:01,869] TRACE Controller 0 epoch 104 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:01,960] ERROR Controller 0 epoch 104 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:07:02,164] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:07:02,164] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:07:02,165] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:07:02,165] TRACE Controller 0 epoch 104 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:07:02,165] TRACE Controller 0 epoch 104 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:07:02,165] TRACE Controller 0 epoch 104 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:07:02,166] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:07:02,167] TRACE Controller 0 epoch 104 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,170] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 0 (state.change.logger)
[2018-04-21 22:07:02,170] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 0 (state.change.logger)
[2018-04-21 22:07:02,170] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 0 (state.change.logger)
[2018-04-21 22:07:02,171] TRACE Controller 0 epoch 104 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:07:02,172] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 104 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,174] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 104 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,175] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 104 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,175] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 104 for partition [kafka_topic,0] since its associated leader epoch 81 is old. Current leader epoch is 81 (state.change.logger)
[2018-04-21 22:07:02,176] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 104 for partition [kafka_test,0] since its associated leader epoch 102 is old. Current leader epoch is 102 (state.change.logger)
[2018-04-21 22:07:02,178] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 104 for partition [project_topic,0] since its associated leader epoch 81 is old. Current leader epoch is 81 (state.change.logger)
[2018-04-21 22:07:02,179] TRACE Controller 0 epoch 104 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:07:02,181] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 2 (state.change.logger)
[2018-04-21 22:07:02,186] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 2 (state.change.logger)
[2018-04-21 22:07:02,187] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 2 (state.change.logger)
[2018-04-21 22:07:02,188] TRACE Controller 0 epoch 104 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:07:02,215] TRACE Controller 0 epoch 104 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,217] TRACE Controller 0 epoch 104 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:07:02,218] TRACE Controller 0 epoch 104 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,284] TRACE Controller 0 epoch 104 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,288] TRACE Controller 0 epoch 104 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:07:02,288] TRACE Controller 0 epoch 104 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,337] TRACE Controller 0 epoch 104 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,340] TRACE Controller 0 epoch 104 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:07:02,340] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,340] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,340] TRACE Controller 0 epoch 104 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,343] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:07:02,345] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 104 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,347] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 104 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,347] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:07:02,349] TRACE Controller 0 epoch 104 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:07:02,349] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 104 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,349] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 104 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,350] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 104 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,353] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 104 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,356] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 104 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:07:02,361] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 104 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:07:02,361] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 104 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:07:02,361] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 104 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:07:02,361] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 104 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:07:02,361] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 104 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:07:02,364] TRACE Controller 0 epoch 104 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:07:02,364] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 4 (state.change.logger)
[2018-04-21 22:07:02,364] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 4 (state.change.logger)
[2018-04-21 22:07:02,364] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 104 with correlation id 4 (state.change.logger)
[2018-04-21 22:07:02,365] TRACE Controller 0 epoch 104 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:11:41,219] TRACE Controller 0 epoch 105 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:41,330] ERROR Controller 0 epoch 105 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:11:41,341] TRACE Controller 0 epoch 105 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:41,474] ERROR Controller 0 epoch 105 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:11:41,494] TRACE Controller 0 epoch 105 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:41,645] ERROR Controller 0 epoch 105 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:11:41,984] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:11:41,985] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:11:41,992] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:11:42,004] TRACE Controller 0 epoch 105 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:11:42,009] TRACE Controller 0 epoch 105 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:11:42,015] TRACE Controller 0 epoch 105 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:11:42,015] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,016] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 0 (state.change.logger)
[2018-04-21 22:11:42,017] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,020] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,021] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 0 (state.change.logger)
[2018-04-21 22:11:42,026] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 0 (state.change.logger)
[2018-04-21 22:11:42,026] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:11:42,027] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:11:42,030] TRACE Controller 0 epoch 105 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:11:42,033] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:11:42,037] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 105 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,037] TRACE Controller 0 epoch 105 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,041] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 105 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,045] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 105 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,051] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 105 for partition [kafka_topic,0] since its associated leader epoch 82 is old. Current leader epoch is 82 (state.change.logger)
[2018-04-21 22:11:42,054] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 105 for partition [kafka_test,0] since its associated leader epoch 103 is old. Current leader epoch is 103 (state.change.logger)
[2018-04-21 22:11:42,058] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 105 for partition [project_topic,0] since its associated leader epoch 82 is old. Current leader epoch is 82 (state.change.logger)
[2018-04-21 22:11:42,065] TRACE Controller 0 epoch 105 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:11:42,075] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 2 (state.change.logger)
[2018-04-21 22:11:42,079] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 2 (state.change.logger)
[2018-04-21 22:11:42,082] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 2 (state.change.logger)
[2018-04-21 22:11:42,087] TRACE Controller 0 epoch 105 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:11:42,172] TRACE Controller 0 epoch 105 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,178] TRACE Controller 0 epoch 105 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:11:42,178] TRACE Controller 0 epoch 105 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,262] TRACE Controller 0 epoch 105 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,263] TRACE Controller 0 epoch 105 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:11:42,264] TRACE Controller 0 epoch 105 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,360] TRACE Controller 0 epoch 105 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,368] TRACE Controller 0 epoch 105 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:11:42,369] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,371] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,372] TRACE Controller 0 epoch 105 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,372] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:11:42,372] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:11:42,373] TRACE Controller 0 epoch 105 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:11:42,376] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 105 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,377] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 105 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,380] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 105 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,381] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 105 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,382] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 105 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,383] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 105 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,391] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 105 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:11:42,394] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 105 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:11:42,395] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 105 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:11:42,396] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 105 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:11:42,396] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 105 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:11:42,396] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 105 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:11:42,405] TRACE Controller 0 epoch 105 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:11:42,414] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 4 (state.change.logger)
[2018-04-21 22:11:42,415] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 4 (state.change.logger)
[2018-04-21 22:11:42,415] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 105 with correlation id 4 (state.change.logger)
[2018-04-21 22:11:42,416] TRACE Controller 0 epoch 105 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:12:46,410] TRACE Controller 0 epoch 106 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:46,488] ERROR Controller 0 epoch 106 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:12:46,494] TRACE Controller 0 epoch 106 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:46,562] ERROR Controller 0 epoch 106 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:12:46,573] TRACE Controller 0 epoch 106 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:46,650] ERROR Controller 0 epoch 106 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:12:46,841] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:12:46,841] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:12:46,841] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:12:46,845] TRACE Controller 0 epoch 106 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:12:46,845] TRACE Controller 0 epoch 106 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:12:46,847] TRACE Controller 0 epoch 106 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:12:46,847] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:46,847] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:46,849] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:46,849] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:12:46,849] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:12:46,850] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:12:46,853] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 0 (state.change.logger)
[2018-04-21 22:12:46,853] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 0 (state.change.logger)
[2018-04-21 22:12:46,853] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 0 (state.change.logger)
[2018-04-21 22:12:46,853] TRACE Controller 0 epoch 106 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:46,856] TRACE Controller 0 epoch 106 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:12:46,858] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 106 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:46,858] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 106 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:46,859] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 106 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:46,859] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 106 for partition [kafka_topic,0] since its associated leader epoch 83 is old. Current leader epoch is 83 (state.change.logger)
[2018-04-21 22:12:46,859] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 106 for partition [kafka_test,0] since its associated leader epoch 104 is old. Current leader epoch is 104 (state.change.logger)
[2018-04-21 22:12:46,860] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 106 for partition [project_topic,0] since its associated leader epoch 83 is old. Current leader epoch is 83 (state.change.logger)
[2018-04-21 22:12:46,861] TRACE Controller 0 epoch 106 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:12:46,866] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 2 (state.change.logger)
[2018-04-21 22:12:46,867] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 2 (state.change.logger)
[2018-04-21 22:12:46,868] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 2 (state.change.logger)
[2018-04-21 22:12:46,869] TRACE Controller 0 epoch 106 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:12:46,915] TRACE Controller 0 epoch 106 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:46,917] TRACE Controller 0 epoch 106 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:12:46,918] TRACE Controller 0 epoch 106 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:46,996] TRACE Controller 0 epoch 106 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:46,996] TRACE Controller 0 epoch 106 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:12:46,996] TRACE Controller 0 epoch 106 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,049] TRACE Controller 0 epoch 106 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,050] TRACE Controller 0 epoch 106 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:12:47,051] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:47,053] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,053] TRACE Controller 0 epoch 106 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:47,055] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 106 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:47,055] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 106 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:47,057] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:12:47,057] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:12:47,060] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 106 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,061] TRACE Controller 0 epoch 106 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:12:47,061] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 106 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:47,063] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 106 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,066] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 106 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:47,068] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 106 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:12:47,070] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 106 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:12:47,070] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 106 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:12:47,071] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 106 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:12:47,075] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 106 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:12:47,076] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 106 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:12:47,079] TRACE Controller 0 epoch 106 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:12:47,088] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 4 (state.change.logger)
[2018-04-21 22:12:47,094] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 4 (state.change.logger)
[2018-04-21 22:12:47,096] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 106 with correlation id 4 (state.change.logger)
[2018-04-21 22:12:47,097] TRACE Controller 0 epoch 106 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:17:26,664] TRACE Controller 0 epoch 107 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:26,718] ERROR Controller 0 epoch 107 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:17:26,725] TRACE Controller 0 epoch 107 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:26,873] ERROR Controller 0 epoch 107 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:17:26,890] TRACE Controller 0 epoch 107 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,049] ERROR Controller 0 epoch 107 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:17:27,448] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:17:27,450] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:17:27,450] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,452] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,453] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:17:27,453] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:17:27,453] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:17:27,453] TRACE Controller 0 epoch 107 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,472] TRACE Controller 0 epoch 107 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,472] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 0 (state.change.logger)
[2018-04-21 22:17:27,472] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 0 (state.change.logger)
[2018-04-21 22:17:27,472] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 0 (state.change.logger)
[2018-04-21 22:17:27,472] TRACE Controller 0 epoch 107 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:17:27,473] TRACE Controller 0 epoch 107 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:17:27,473] TRACE Controller 0 epoch 107 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,473] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 107 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,473] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 107 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,473] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 107 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,474] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 107 for partition [kafka_topic,0] since its associated leader epoch 84 is old. Current leader epoch is 84 (state.change.logger)
[2018-04-21 22:17:27,474] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 107 for partition [kafka_test,0] since its associated leader epoch 105 is old. Current leader epoch is 105 (state.change.logger)
[2018-04-21 22:17:27,474] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 107 for partition [project_topic,0] since its associated leader epoch 84 is old. Current leader epoch is 84 (state.change.logger)
[2018-04-21 22:17:27,475] TRACE Controller 0 epoch 107 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:17:27,475] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 2 (state.change.logger)
[2018-04-21 22:17:27,475] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 2 (state.change.logger)
[2018-04-21 22:17:27,475] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 2 (state.change.logger)
[2018-04-21 22:17:27,477] TRACE Controller 0 epoch 107 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:17:27,482] TRACE Controller 0 epoch 107 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,483] TRACE Controller 0 epoch 107 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:17:27,483] TRACE Controller 0 epoch 107 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,490] TRACE Controller 0 epoch 107 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,490] TRACE Controller 0 epoch 107 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:17:27,490] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,490] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,490] TRACE Controller 0 epoch 107 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,491] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 107 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,491] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 107 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,491] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 107 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,492] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 107 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,492] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 107 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,492] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 107 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,492] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 107 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:17:27,492] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 107 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:17:27,493] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 107 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:17:27,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 107 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:17:27,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 107 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:17:27,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 107 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:17:27,494] TRACE Controller 0 epoch 107 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:17:27,494] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:17:27,494] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:17:27,494] TRACE Controller 0 epoch 107 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:17:27,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 4 (state.change.logger)
[2018-04-21 22:17:27,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 4 (state.change.logger)
[2018-04-21 22:17:27,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 107 with correlation id 4 (state.change.logger)
[2018-04-21 22:17:27,496] TRACE Controller 0 epoch 107 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:19:51,928] TRACE Controller 0 epoch 108 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:51,937] ERROR Controller 0 epoch 108 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:19:51,937] TRACE Controller 0 epoch 108 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:51,946] ERROR Controller 0 epoch 108 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:19:51,947] TRACE Controller 0 epoch 108 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:51,954] ERROR Controller 0 epoch 108 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:19:51,995] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:19:51,995] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:19:51,995] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:19:52,001] TRACE Controller 0 epoch 108 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:19:52,001] TRACE Controller 0 epoch 108 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:19:52,003] TRACE Controller 0 epoch 108 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:19:52,003] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 0 (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 0 (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 0 (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:19:52,004] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:19:52,005] TRACE Controller 0 epoch 108 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:19:52,005] TRACE Controller 0 epoch 108 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,006] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 108 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,006] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 108 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,007] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 108 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,007] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 108 for partition [kafka_topic,0] since its associated leader epoch 85 is old. Current leader epoch is 85 (state.change.logger)
[2018-04-21 22:19:52,007] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 108 for partition [kafka_test,0] since its associated leader epoch 106 is old. Current leader epoch is 106 (state.change.logger)
[2018-04-21 22:19:52,007] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 108 for partition [project_topic,0] since its associated leader epoch 85 is old. Current leader epoch is 85 (state.change.logger)
[2018-04-21 22:19:52,010] TRACE Controller 0 epoch 108 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:19:52,012] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 2 (state.change.logger)
[2018-04-21 22:19:52,012] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 2 (state.change.logger)
[2018-04-21 22:19:52,012] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 2 (state.change.logger)
[2018-04-21 22:19:52,013] TRACE Controller 0 epoch 108 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:19:52,015] TRACE Controller 0 epoch 108 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,015] TRACE Controller 0 epoch 108 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:19:52,015] TRACE Controller 0 epoch 108 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,026] TRACE Controller 0 epoch 108 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,027] TRACE Controller 0 epoch 108 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:19:52,027] TRACE Controller 0 epoch 108 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,038] TRACE Controller 0 epoch 108 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,038] TRACE Controller 0 epoch 108 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:19:52,038] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,038] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,038] TRACE Controller 0 epoch 108 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,039] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:19:52,039] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:19:52,039] TRACE Controller 0 epoch 108 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 108 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 108 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 108 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 108 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 108 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,040] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 108 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,041] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 108 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:19:52,041] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 108 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:19:52,041] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 108 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:19:52,041] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 108 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:19:52,041] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 108 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:19:52,041] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 108 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:19:52,042] TRACE Controller 0 epoch 108 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:19:52,043] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 4 (state.change.logger)
[2018-04-21 22:19:52,044] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 4 (state.change.logger)
[2018-04-21 22:19:52,044] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 108 with correlation id 4 (state.change.logger)
[2018-04-21 22:19:52,044] TRACE Controller 0 epoch 108 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:20:59,264] TRACE Controller 0 epoch 109 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,267] ERROR Controller 0 epoch 109 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:20:59,267] TRACE Controller 0 epoch 109 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,269] ERROR Controller 0 epoch 109 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:20:59,269] TRACE Controller 0 epoch 109 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,271] ERROR Controller 0 epoch 109 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 22:20:59,282] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:20:59,283] TRACE Controller 0 epoch 109 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,285] TRACE Controller 0 epoch 109 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,285] TRACE Controller 0 epoch 109 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:20:59,285] TRACE Controller 0 epoch 109 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,287] TRACE Controller 0 epoch 109 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,287] TRACE Controller 0 epoch 109 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:20:59,287] TRACE Controller 0 epoch 109 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,289] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 0 (state.change.logger)
[2018-04-21 22:20:59,289] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 0 (state.change.logger)
[2018-04-21 22:20:59,289] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 0 (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 22:20:59,290] TRACE Controller 0 epoch 109 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 22:20:59,291] TRACE Controller 0 epoch 109 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:20:59,291] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 109 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,291] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 109 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,291] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 109 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,291] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 109 for partition [kafka_topic,0] since its associated leader epoch 86 is old. Current leader epoch is 86 (state.change.logger)
[2018-04-21 22:20:59,291] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 109 for partition [kafka_test,0] since its associated leader epoch 107 is old. Current leader epoch is 107 (state.change.logger)
[2018-04-21 22:20:59,291] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 109 for partition [project_topic,0] since its associated leader epoch 86 is old. Current leader epoch is 86 (state.change.logger)
[2018-04-21 22:20:59,292] TRACE Controller 0 epoch 109 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:20:59,292] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 2 (state.change.logger)
[2018-04-21 22:20:59,292] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 2 (state.change.logger)
[2018-04-21 22:20:59,292] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 2 (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Controller 0 epoch 109 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 109 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 109 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 109 for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 109 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 109 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 109 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 109 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:20:59,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 109 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:20:59,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 109 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 22:20:59,294] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 109 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 22:20:59,295] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 109 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 22:20:59,295] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 109 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 22:20:59,295] TRACE Controller 0 epoch 109 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 22:20:59,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 4 (state.change.logger)
[2018-04-21 22:20:59,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 4 (state.change.logger)
[2018-04-21 22:20:59,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 109 with correlation id 4 (state.change.logger)
[2018-04-21 22:20:59,296] TRACE Controller 0 epoch 109 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
