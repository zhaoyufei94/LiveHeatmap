[2018-04-24 20:51:39,592] TRACE Controller 0 epoch 226 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,596] ERROR Controller 0 epoch 226 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:51:39,597] TRACE Controller 0 epoch 226 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,600] ERROR Controller 0 epoch 226 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:51:39,600] TRACE Controller 0 epoch 226 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,611] ERROR Controller 0 epoch 226 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:51:39,624] TRACE Controller 0 epoch 226 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,628] TRACE Controller 0 epoch 226 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,628] TRACE Controller 0 epoch 226 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:51:39,628] TRACE Controller 0 epoch 226 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 0 (state.change.logger)
[2018-04-24 20:51:39,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 0 (state.change.logger)
[2018-04-24 20:51:39,629] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 0 (state.change.logger)
[2018-04-24 20:51:39,631] TRACE Controller 0 epoch 226 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 226 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 226 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 226 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 226 for partition [kafka_topic,0] since its associated leader epoch 203 is old. Current leader epoch is 203 (state.change.logger)
[2018-04-24 20:51:39,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 226 for partition [kafka_test,0] since its associated leader epoch 224 is old. Current leader epoch is 224 (state.change.logger)
[2018-04-24 20:51:39,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 226 for partition [project_topic,0] since its associated leader epoch 203 is old. Current leader epoch is 203 (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Controller 0 epoch 226 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Controller 0 epoch 226 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Controller 0 epoch 226 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,632] TRACE Controller 0 epoch 226 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:51:39,634] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 2 (state.change.logger)
[2018-04-24 20:51:39,634] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:224,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 2 (state.change.logger)
[2018-04-24 20:51:39,634] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:203,ControllerEpoch:225),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 2 (state.change.logger)
[2018-04-24 20:51:39,634] TRACE Controller 0 epoch 226 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Controller 0 epoch 226 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 226 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 226 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,639] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 226 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 226 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 226 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 226 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,640] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 226 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:51:39,640] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 226 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:51:39,640] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 226 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 226 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 226 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 226 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Controller 0 epoch 226 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 4 (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 4 (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 226 with correlation id 4 (state.change.logger)
[2018-04-24 20:51:39,640] TRACE Controller 0 epoch 226 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:52:16,587] TRACE Controller 0 epoch 227 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,591] ERROR Controller 0 epoch 227 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:52:16,592] TRACE Controller 0 epoch 227 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,596] ERROR Controller 0 epoch 227 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:52:16,597] TRACE Controller 0 epoch 227 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,601] ERROR Controller 0 epoch 227 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:52:16,613] TRACE Controller 0 epoch 227 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 0 (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 0 (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 0 (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Controller 0 epoch 227 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 227 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 227 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,614] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 227 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,614] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 227 for partition [kafka_topic,0] since its associated leader epoch 204 is old. Current leader epoch is 204 (state.change.logger)
[2018-04-24 20:52:16,614] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 227 for partition [kafka_test,0] since its associated leader epoch 225 is old. Current leader epoch is 225 (state.change.logger)
[2018-04-24 20:52:16,614] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 227 for partition [project_topic,0] since its associated leader epoch 204 is old. Current leader epoch is 204 (state.change.logger)
[2018-04-24 20:52:16,615] TRACE Controller 0 epoch 227 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:52:16,615] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 2 (state.change.logger)
[2018-04-24 20:52:16,615] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:225,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 2 (state.change.logger)
[2018-04-24 20:52:16,615] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:204,ControllerEpoch:226),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 2 (state.change.logger)
[2018-04-24 20:52:16,615] TRACE Controller 0 epoch 227 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:52:16,617] TRACE Controller 0 epoch 227 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,617] TRACE Controller 0 epoch 227 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:52:16,617] TRACE Controller 0 epoch 227 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,619] TRACE Controller 0 epoch 227 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,619] TRACE Controller 0 epoch 227 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:52:16,619] TRACE Controller 0 epoch 227 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:52:16,622] TRACE Controller 0 epoch 227 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 227 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 227 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 227 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 227 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 227 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 227 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,623] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 227 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:52:16,623] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 227 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:52:16,623] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 227 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 227 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 227 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 227 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Controller 0 epoch 227 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 4 (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 4 (state.change.logger)
[2018-04-24 20:52:16,623] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 227 with correlation id 4 (state.change.logger)
[2018-04-24 20:52:16,624] TRACE Controller 0 epoch 227 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:53:38,614] TRACE Controller 0 epoch 228 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:38,650] ERROR Controller 0 epoch 228 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:53:38,654] TRACE Controller 0 epoch 228 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:38,697] ERROR Controller 0 epoch 228 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:53:38,699] TRACE Controller 0 epoch 228 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:38,729] ERROR Controller 0 epoch 228 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:53:38,881] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:53:38,881] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:53:38,882] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:53:38,884] TRACE Controller 0 epoch 228 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:53:38,885] TRACE Controller 0 epoch 228 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:53:38,885] TRACE Controller 0 epoch 228 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:53:38,886] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:38,887] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:38,887] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:38,887] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:53:38,888] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:53:38,888] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:53:38,892] TRACE Controller 0 epoch 228 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:38,897] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 0 (state.change.logger)
[2018-04-24 20:53:38,901] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 0 (state.change.logger)
[2018-04-24 20:53:38,904] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 0 (state.change.logger)
[2018-04-24 20:53:38,916] TRACE Controller 0 epoch 228 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:53:38,918] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 228 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:38,918] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 228 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:38,919] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 228 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:38,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 228 for partition [kafka_topic,0] since its associated leader epoch 205 is old. Current leader epoch is 205 (state.change.logger)
[2018-04-24 20:53:38,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 228 for partition [kafka_test,0] since its associated leader epoch 226 is old. Current leader epoch is 226 (state.change.logger)
[2018-04-24 20:53:38,920] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 228 for partition [project_topic,0] since its associated leader epoch 205 is old. Current leader epoch is 205 (state.change.logger)
[2018-04-24 20:53:38,922] TRACE Controller 0 epoch 228 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:53:38,929] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 2 (state.change.logger)
[2018-04-24 20:53:38,931] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:226,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 2 (state.change.logger)
[2018-04-24 20:53:38,932] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:205,ControllerEpoch:227),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 2 (state.change.logger)
[2018-04-24 20:53:38,937] TRACE Controller 0 epoch 228 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:53:38,985] TRACE Controller 0 epoch 228 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:38,990] TRACE Controller 0 epoch 228 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:53:38,990] TRACE Controller 0 epoch 228 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,078] TRACE Controller 0 epoch 228 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,080] TRACE Controller 0 epoch 228 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:53:39,080] TRACE Controller 0 epoch 228 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,143] TRACE Controller 0 epoch 228 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,143] TRACE Controller 0 epoch 228 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:53:39,144] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:39,144] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,144] TRACE Controller 0 epoch 228 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,148] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 228 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:39,148] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 228 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,148] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 228 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,149] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 228 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:39,151] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 228 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,151] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 228 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,153] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:53:39,153] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:53:39,153] TRACE Controller 0 epoch 228 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:53:39,159] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 228 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:53:39,168] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 228 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:53:39,168] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 228 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:53:39,169] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 228 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:53:39,169] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 228 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:53:39,169] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 228 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:53:39,173] TRACE Controller 0 epoch 228 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:53:39,175] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 4 (state.change.logger)
[2018-04-24 20:53:39,175] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 4 (state.change.logger)
[2018-04-24 20:53:39,175] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 228 with correlation id 4 (state.change.logger)
[2018-04-24 20:53:39,176] TRACE Controller 0 epoch 228 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:54:48,447] TRACE Controller 0 epoch 229 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,465] ERROR Controller 0 epoch 229 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:54:48,469] TRACE Controller 0 epoch 229 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,489] ERROR Controller 0 epoch 229 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:54:48,492] TRACE Controller 0 epoch 229 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,512] ERROR Controller 0 epoch 229 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:54:48,572] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:54:48,573] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:54:48,573] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:54:48,576] TRACE Controller 0 epoch 229 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:54:48,576] TRACE Controller 0 epoch 229 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:54:48,577] TRACE Controller 0 epoch 229 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:54:48,577] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,577] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,577] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,578] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:54:48,578] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:54:48,578] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:54:48,578] TRACE Controller 0 epoch 229 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,589] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 0 (state.change.logger)
[2018-04-24 20:54:48,593] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 0 (state.change.logger)
[2018-04-24 20:54:48,595] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 0 (state.change.logger)
[2018-04-24 20:54:48,598] TRACE Controller 0 epoch 229 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:54:48,600] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 229 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,601] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 229 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,601] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 229 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,602] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 229 for partition [kafka_topic,0] since its associated leader epoch 206 is old. Current leader epoch is 206 (state.change.logger)
[2018-04-24 20:54:48,602] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 229 for partition [kafka_test,0] since its associated leader epoch 227 is old. Current leader epoch is 227 (state.change.logger)
[2018-04-24 20:54:48,602] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 229 for partition [project_topic,0] since its associated leader epoch 206 is old. Current leader epoch is 206 (state.change.logger)
[2018-04-24 20:54:48,604] TRACE Controller 0 epoch 229 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:54:48,605] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 2 (state.change.logger)
[2018-04-24 20:54:48,605] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:227,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 2 (state.change.logger)
[2018-04-24 20:54:48,605] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:206,ControllerEpoch:228),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 2 (state.change.logger)
[2018-04-24 20:54:48,605] TRACE Controller 0 epoch 229 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:54:48,618] TRACE Controller 0 epoch 229 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,618] TRACE Controller 0 epoch 229 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:54:48,618] TRACE Controller 0 epoch 229 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,635] TRACE Controller 0 epoch 229 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,635] TRACE Controller 0 epoch 229 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:54:48,635] TRACE Controller 0 epoch 229 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,652] TRACE Controller 0 epoch 229 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,653] TRACE Controller 0 epoch 229 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:54:48,653] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,653] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,654] TRACE Controller 0 epoch 229 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,655] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:54:48,655] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:54:48,655] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 229 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,656] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 229 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,656] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 229 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,656] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 229 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,656] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 229 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,656] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 229 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,658] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 229 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:54:48,658] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 229 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:54:48,658] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 229 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:54:48,659] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 229 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:54:48,659] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 229 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:54:48,659] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 229 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:54:48,659] TRACE Controller 0 epoch 229 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:54:48,659] TRACE Controller 0 epoch 229 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:54:48,660] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 4 (state.change.logger)
[2018-04-24 20:54:48,661] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 4 (state.change.logger)
[2018-04-24 20:54:48,662] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 229 with correlation id 4 (state.change.logger)
[2018-04-24 20:54:48,662] TRACE Controller 0 epoch 229 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:55:38,869] TRACE Controller 0 epoch 230 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:38,900] ERROR Controller 0 epoch 230 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:55:38,901] TRACE Controller 0 epoch 230 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:38,923] ERROR Controller 0 epoch 230 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:55:38,927] TRACE Controller 0 epoch 230 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:38,949] ERROR Controller 0 epoch 230 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:55:39,027] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:55:39,027] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:55:39,027] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:55:39,028] TRACE Controller 0 epoch 230 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:55:39,028] TRACE Controller 0 epoch 230 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:55:39,028] TRACE Controller 0 epoch 230 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:55:39,029] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,029] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,029] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,031] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:55:39,031] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:55:39,031] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:55:39,032] TRACE Controller 0 epoch 230 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,033] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 0 (state.change.logger)
[2018-04-24 20:55:39,033] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 0 (state.change.logger)
[2018-04-24 20:55:39,033] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 0 (state.change.logger)
[2018-04-24 20:55:39,033] TRACE Controller 0 epoch 230 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:55:39,036] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 230 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,036] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 230 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,037] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 230 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,037] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 230 for partition [kafka_topic,0] since its associated leader epoch 207 is old. Current leader epoch is 207 (state.change.logger)
[2018-04-24 20:55:39,037] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 230 for partition [kafka_test,0] since its associated leader epoch 228 is old. Current leader epoch is 228 (state.change.logger)
[2018-04-24 20:55:39,038] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 230 for partition [project_topic,0] since its associated leader epoch 207 is old. Current leader epoch is 207 (state.change.logger)
[2018-04-24 20:55:39,039] TRACE Controller 0 epoch 230 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:55:39,039] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 2 (state.change.logger)
[2018-04-24 20:55:39,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:228,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 2 (state.change.logger)
[2018-04-24 20:55:39,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:207,ControllerEpoch:229),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 2 (state.change.logger)
[2018-04-24 20:55:39,043] TRACE Controller 0 epoch 230 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:55:39,055] TRACE Controller 0 epoch 230 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,056] TRACE Controller 0 epoch 230 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:55:39,056] TRACE Controller 0 epoch 230 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,068] TRACE Controller 0 epoch 230 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,069] TRACE Controller 0 epoch 230 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:55:39,069] TRACE Controller 0 epoch 230 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,098] TRACE Controller 0 epoch 230 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,103] TRACE Controller 0 epoch 230 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:55:39,103] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,104] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,105] TRACE Controller 0 epoch 230 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,106] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 230 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 230 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 230 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 230 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 230 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,107] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 230 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,107] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 230 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:55:39,108] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 230 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:55:39,108] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:55:39,108] TRACE Controller 0 epoch 230 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:55:39,109] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 230 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:55:39,109] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 230 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:55:39,109] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 230 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:55:39,111] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 230 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:55:39,111] TRACE Controller 0 epoch 230 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:55:39,112] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 4 (state.change.logger)
[2018-04-24 20:55:39,112] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 4 (state.change.logger)
[2018-04-24 20:55:39,112] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 230 with correlation id 4 (state.change.logger)
[2018-04-24 20:55:39,112] TRACE Controller 0 epoch 230 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:57:29,472] TRACE Controller 0 epoch 231 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,488] ERROR Controller 0 epoch 231 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:57:29,489] TRACE Controller 0 epoch 231 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,509] ERROR Controller 0 epoch 231 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:57:29,514] TRACE Controller 0 epoch 231 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,539] ERROR Controller 0 epoch 231 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-24 20:57:29,599] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:57:29,599] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:57:29,600] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:57:29,601] TRACE Controller 0 epoch 231 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,610] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 0 (state.change.logger)
[2018-04-24 20:57:29,614] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 0 (state.change.logger)
[2018-04-24 20:57:29,614] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 0 (state.change.logger)
[2018-04-24 20:57:29,616] TRACE Controller 0 epoch 231 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:57:29,617] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 231 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,617] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 231 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,617] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 231 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,617] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 231 for partition [kafka_topic,0] since its associated leader epoch 208 is old. Current leader epoch is 208 (state.change.logger)
[2018-04-24 20:57:29,617] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 231 for partition [kafka_test,0] since its associated leader epoch 229 is old. Current leader epoch is 229 (state.change.logger)
[2018-04-24 20:57:29,617] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 231 for partition [project_topic,0] since its associated leader epoch 208 is old. Current leader epoch is 208 (state.change.logger)
[2018-04-24 20:57:29,621] TRACE Controller 0 epoch 231 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:57:29,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 2 (state.change.logger)
[2018-04-24 20:57:29,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:229,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 2 (state.change.logger)
[2018-04-24 20:57:29,621] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:208,ControllerEpoch:230),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 2 (state.change.logger)
[2018-04-24 20:57:29,622] TRACE Controller 0 epoch 231 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:57:29,632] TRACE Controller 0 epoch 231 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,632] TRACE Controller 0 epoch 231 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:57:29,632] TRACE Controller 0 epoch 231 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,657] TRACE Controller 0 epoch 231 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,659] TRACE Controller 0 epoch 231 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:57:29,660] TRACE Controller 0 epoch 231 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,681] TRACE Controller 0 epoch 231 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,681] TRACE Controller 0 epoch 231 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-24 20:57:29,682] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,682] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,684] TRACE Controller 0 epoch 231 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:230,ControllerEpoch:231) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,686] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-24 20:57:29,686] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-24 20:57:29,686] TRACE Controller 0 epoch 231 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:230,ControllerEpoch:231) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-24 20:57:29,687] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 231 for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,687] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:230,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 231 for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,688] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 231 for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,688] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 231 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,690] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 231 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,691] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 231 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,691] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 231 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:57:29,692] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 231 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:57:29,692] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 231 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-24 20:57:29,693] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 231 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-24 20:57:29,693] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 231 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-24 20:57:29,693] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 231 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-24 20:57:29,699] TRACE Controller 0 epoch 231 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-24 20:57:29,701] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 4 (state.change.logger)
[2018-04-24 20:57:29,702] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:230,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 4 (state.change.logger)
[2018-04-24 20:57:29,703] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:209,ControllerEpoch:231),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 231 with correlation id 4 (state.change.logger)
[2018-04-24 20:57:29,705] TRACE Controller 0 epoch 231 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
