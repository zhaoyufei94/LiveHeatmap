[2018-04-21 17:01:14,415] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:01:14,420] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:01:14,420] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:01:14,423] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,423] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:01:14,439] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:01:14,440] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:01:14,440] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:01:14,442] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:01:14,448] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:01:14,450] INFO [Controller 0]: Initialized controller epoch to 79 and zk version 78 (kafka.controller.KafkaController)
[2018-04-21 17:01:14,453] INFO [Controller 0]: Controller 0 incremented epoch to 80 (kafka.controller.KafkaController)
[2018-04-21 17:01:14,454] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:01:14,487] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:01:14,487] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:01:14,487] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:01:14,489] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:01:14,489] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:01:14,489] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:01:14,490] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:01:14,496] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,501] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,508] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,516] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,522] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 80 (kafka.controller.KafkaController)
[2018-04-21 17:01:14,522] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:01:14,522] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,526] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:01:14,557] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:01:14,559] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:01:14,567] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:01:14,568] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:01:14,574] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:01:14,575] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:01:14,580] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:01:14,583] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:01:14,587] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,587] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":58,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,595] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:79), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,600] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,600] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":79,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,606] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:80), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,609] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,609] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":58,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:01:14,613] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:80), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:01:14,629] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:01:14,629] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:01:14,637] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:01:14,641] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:01:14,648] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:01:14,653] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:01:14,659] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:01:19,527] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:01:19,527] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:01:19,527] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:01:19,527] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:04:35,994] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:04:35,996] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:04:35,996] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:04:35,996] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:35,997] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:04:35,999] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:04:36,000] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:04:36,001] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:04:36,001] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:04:36,006] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:04:36,006] INFO [Controller 0]: Initialized controller epoch to 80 and zk version 79 (kafka.controller.KafkaController)
[2018-04-21 17:04:36,007] INFO [Controller 0]: Controller 0 incremented epoch to 81 (kafka.controller.KafkaController)
[2018-04-21 17:04:36,007] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:04:36,012] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:04:36,013] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:04:36,017] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,019] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,021] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,021] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:36,023] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 81 (kafka.controller.KafkaController)
[2018-04-21 17:04:36,023] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:04:36,023] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:36,024] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:04:36,027] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:04:36,028] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:04:36,036] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:04:36,036] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:04:36,037] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:04:36,037] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:04:36,038] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,038] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":59,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,039] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:80), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:36,039] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:04:36,040] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,040] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":80,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,041] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:81), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:58,ControllerEpoch:80)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:36,043] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,043] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":59,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:04:36,044] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:81), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:04:36,045] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:04:36,046] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:04:36,046] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:04:36,048] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:04:36,049] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:04:36,050] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:04:36,051] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:04:36,052] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:04:41,025] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:04:41,026] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:04:41,026] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:04:41,026] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,684] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:09:46,684] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,684] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:09:46,686] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,686] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:09:46,687] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:09:46,688] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:09:46,688] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:09:46,688] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:09:46,693] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:09:46,693] INFO [Controller 0]: Initialized controller epoch to 81 and zk version 80 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,694] INFO [Controller 0]: Controller 0 incremented epoch to 82 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,694] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:09:46,704] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:09:46,704] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:09:46,704] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:09:46,705] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:09:46,705] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:09:46,705] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:09:46,706] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:09:46,707] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,710] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,711] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,712] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,712] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 82 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,712] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:09:46,712] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,713] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:09:46,718] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:09:46,719] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:09:46,733] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:09:46,733] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:09:46,734] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:09:46,734] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:09:46,735] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:09:46,735] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:09:46,737] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,737] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":60,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,738] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:81), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,739] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,739] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":81,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,740] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:82), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:59,ControllerEpoch:81)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,741] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,741] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":60,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:09:46,742] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:82), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:09:46,745] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:09:46,745] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:09:46,749] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:09:46,751] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:09:46,753] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:09:46,755] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:09:46,757] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:09:51,715] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:09:51,715] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:09:51,716] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:09:51,716] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,168] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:10:37,168] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,168] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:10:37,171] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,171] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:10:37,174] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:10:37,174] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:10:37,174] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:10:37,174] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:10:37,179] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:10:37,179] INFO [Controller 0]: Initialized controller epoch to 82 and zk version 81 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,180] INFO [Controller 0]: Controller 0 incremented epoch to 83 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,180] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:10:37,188] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:10:37,189] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:10:37,189] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:10:37,190] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,191] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,197] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,199] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,200] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 83 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,200] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:10:37,200] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,201] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:10:37,206] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:10:37,206] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:10:37,208] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:10:37,208] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:10:37,209] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:10:37,209] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:10:37,210] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,210] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":61,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,211] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:82), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,212] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,212] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":82,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,213] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:83), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:60,ControllerEpoch:82)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,214] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,214] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":61,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:10:37,215] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:83), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:10:37,217] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:10:37,217] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:10:37,219] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:10:37,219] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:10:37,224] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:10:37,224] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:10:37,228] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:10:37,230] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:10:37,231] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:10:42,202] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:10:42,202] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:10:42,202] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:10:42,202] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,844] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:16:51,844] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,844] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:16:51,848] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,848] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:16:51,850] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:16:51,852] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:16:51,852] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:16:51,852] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:16:51,855] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:16:51,856] INFO [Controller 0]: Initialized controller epoch to 83 and zk version 82 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,857] INFO [Controller 0]: Controller 0 incremented epoch to 84 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,857] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:16:51,866] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:16:51,871] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:16:51,872] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:16:51,872] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:16:51,872] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:16:51,872] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:16:51,872] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:16:51,877] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,880] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,886] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,886] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,888] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 84 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,888] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:16:51,888] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,889] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:16:51,897] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:16:51,898] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:16:51,900] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:16:51,900] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:16:51,901] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:16:51,901] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:16:51,902] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,902] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":62,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,904] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:16:51,904] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:83), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,904] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:16:51,906] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,906] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":83,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,906] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:84), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:61,ControllerEpoch:83)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,907] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,907] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":62,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:16:51,908] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:84), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:16:51,910] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:16:51,910] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:16:51,912] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:16:51,914] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:16:51,915] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:16:51,916] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:16:51,917] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:16:56,890] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:16:56,891] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:16:56,891] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:16:56,891] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,171] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:41:13,171] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,171] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:41:13,174] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,174] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:41:13,181] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:41:13,182] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:41:13,182] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:41:13,182] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:41:13,190] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:41:13,191] INFO [Controller 0]: Initialized controller epoch to 84 and zk version 83 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,199] INFO [Controller 0]: Controller 0 incremented epoch to 85 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,203] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:41:13,236] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:41:13,236] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:41:13,236] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:41:13,238] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:41:13,238] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:41:13,238] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:41:13,239] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:41:13,239] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:41:13,241] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:41:13,242] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:41:13,242] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:41:13,242] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:41:13,250] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,264] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,271] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,272] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,275] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 85 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,275] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:41:13,275] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,278] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:41:13,290] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:41:13,292] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:41:13,301] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:41:13,301] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:41:13,303] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:41:13,304] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:41:13,334] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:41:13,335] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:41:13,337] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,337] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":63,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,342] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:84), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,346] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,347] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":84,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,350] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:85), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:62,ControllerEpoch:84)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,353] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,354] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":63,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:41:13,357] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:85), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:41:13,366] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:41:13,366] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:41:13,377] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:41:13,382] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:41:13,386] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:41:13,393] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:41:13,400] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:41:18,280] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:41:18,280] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:41:18,280] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:41:18,280] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,603] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 17:51:15,603] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,603] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:51:15,608] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,608] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:51:15,610] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 17:51:15,610] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 17:51:15,610] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 17:51:15,611] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 17:51:15,615] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 17:51:15,616] INFO [Controller 0]: Initialized controller epoch to 85 and zk version 84 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,617] INFO [Controller 0]: Controller 0 incremented epoch to 86 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,617] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 17:51:15,627] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 17:51:15,628] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:51:15,631] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,633] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,635] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,636] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,638] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 86 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,638] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 17:51:15,638] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,639] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 17:51:15,642] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 17:51:15,644] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:51:15,647] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:51:15,647] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 17:51:15,648] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 17:51:15,648] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 17:51:15,649] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 17:51:15,652] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,652] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":64,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,653] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:64,ControllerEpoch:86), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:85), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,655] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,655] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":85,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,656] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:64,ControllerEpoch:86), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:86), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:63,ControllerEpoch:85)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,657] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 17:51:15,658] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,658] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":64,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 17:51:15,659] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:64,ControllerEpoch:86), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:86), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:64,ControllerEpoch:86)) (kafka.controller.PartitionStateMachine)
[2018-04-21 17:51:15,662] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:51:15,663] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 17:51:15,665] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:51:15,666] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:51:15,667] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 17:51:15,669] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:51:15,670] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 17:51:19,827] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 17:51:19,828] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 17:51:19,828] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 17:51:19,828] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
