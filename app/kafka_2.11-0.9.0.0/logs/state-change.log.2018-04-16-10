[2018-04-16 10:13:53,668] TRACE Controller 0 epoch 27 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:53,728] ERROR Controller 0 epoch 27 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:13:53,731] TRACE Controller 0 epoch 27 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:53,781] ERROR Controller 0 epoch 27 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:13:53,782] TRACE Controller 0 epoch 27 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:53,817] ERROR Controller 0 epoch 27 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:13:54,026] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:13:54,026] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:13:54,026] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:13:54,041] TRACE Controller 0 epoch 27 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:13:54,056] TRACE Controller 0 epoch 27 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:13:54,056] TRACE Controller 0 epoch 27 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:13:54,057] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,060] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,060] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,061] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:13:54,061] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:13:54,061] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:13:54,061] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 0 (state.change.logger)
[2018-04-16 10:13:54,073] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 0 (state.change.logger)
[2018-04-16 10:13:54,074] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 0 (state.change.logger)
[2018-04-16 10:13:54,075] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:13:54,077] TRACE Controller 0 epoch 27 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,081] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 27 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,081] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 27 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,081] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 27 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,082] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 27 for partition [kafka_topic,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2018-04-16 10:13:54,082] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 27 for partition [kafka_test,0] since its associated leader epoch 25 is old. Current leader epoch is 25 (state.change.logger)
[2018-04-16 10:13:54,082] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 27 for partition [project_topic,0] since its associated leader epoch 4 is old. Current leader epoch is 4 (state.change.logger)
[2018-04-16 10:13:54,089] TRACE Controller 0 epoch 27 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:13:54,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 2 (state.change.logger)
[2018-04-16 10:13:54,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:25,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 2 (state.change.logger)
[2018-04-16 10:13:54,092] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:4,ControllerEpoch:26),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 2 (state.change.logger)
[2018-04-16 10:13:54,097] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:13:54,153] TRACE Controller 0 epoch 27 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,154] TRACE Controller 0 epoch 27 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:13:54,154] TRACE Controller 0 epoch 27 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,192] TRACE Controller 0 epoch 27 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,192] TRACE Controller 0 epoch 27 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:13:54,192] TRACE Controller 0 epoch 27 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,215] TRACE Controller 0 epoch 27 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,216] TRACE Controller 0 epoch 27 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:13:54,216] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,216] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,216] TRACE Controller 0 epoch 27 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,217] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:13:54,218] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:13:54,218] TRACE Controller 0 epoch 27 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:13:54,219] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 27 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,219] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 27 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,220] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 27 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,220] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 27 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,220] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 27 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,220] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 27 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,234] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 27 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:13:54,234] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 27 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:13:54,234] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 27 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:13:54,234] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 27 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:13:54,234] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 27 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:13:54,235] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 27 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:13:54,236] TRACE Controller 0 epoch 27 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:13:54,241] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 4 (state.change.logger)
[2018-04-16 10:13:54,241] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 4 (state.change.logger)
[2018-04-16 10:13:54,242] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 4 (state.change.logger)
[2018-04-16 10:13:54,247] TRACE Controller 0 epoch 27 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:15:14,420] TRACE Controller 0 epoch 28 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,432] ERROR Controller 0 epoch 28 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:15:14,432] TRACE Controller 0 epoch 28 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,437] ERROR Controller 0 epoch 28 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:15:14,437] TRACE Controller 0 epoch 28 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,447] ERROR Controller 0 epoch 28 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,477] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,478] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,478] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:15:14,478] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:15:14,478] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:15:14,478] TRACE Controller 0 epoch 28 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,495] TRACE Controller 0 epoch 28 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,496] TRACE Controller 0 epoch 28 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:15:14,496] TRACE Controller 0 epoch 28 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 0 (state.change.logger)
[2018-04-16 10:15:14,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 0 (state.change.logger)
[2018-04-16 10:15:14,496] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 0 (state.change.logger)
[2018-04-16 10:15:14,497] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:15:14,497] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 28 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,497] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 28 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,497] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 28 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,497] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 28 for partition [kafka_topic,0] since its associated leader epoch 5 is old. Current leader epoch is 5 (state.change.logger)
[2018-04-16 10:15:14,497] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 28 for partition [kafka_test,0] since its associated leader epoch 26 is old. Current leader epoch is 26 (state.change.logger)
[2018-04-16 10:15:14,497] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 28 for partition [project_topic,0] since its associated leader epoch 5 is old. Current leader epoch is 5 (state.change.logger)
[2018-04-16 10:15:14,497] TRACE Controller 0 epoch 28 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:15:14,498] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 2 (state.change.logger)
[2018-04-16 10:15:14,498] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:26,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 2 (state.change.logger)
[2018-04-16 10:15:14,498] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:5,ControllerEpoch:27),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 2 (state.change.logger)
[2018-04-16 10:15:14,498] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:15:14,502] TRACE Controller 0 epoch 28 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,503] TRACE Controller 0 epoch 28 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:15:14,503] TRACE Controller 0 epoch 28 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,506] TRACE Controller 0 epoch 28 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Controller 0 epoch 28 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Controller 0 epoch 28 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 28 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 28 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 28 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 28 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 28 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,507] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 28 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 28 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:15:14,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 28 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:15:14,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 28 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 28 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 28 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 28 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Controller 0 epoch 28 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:15:14,508] TRACE Controller 0 epoch 28 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:15:14,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2018-04-16 10:15:14,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2018-04-16 10:15:14,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 28 with correlation id 4 (state.change.logger)
[2018-04-16 10:15:14,509] TRACE Controller 0 epoch 28 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:18:29,533] TRACE Controller 0 epoch 29 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,536] ERROR Controller 0 epoch 29 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:18:29,536] TRACE Controller 0 epoch 29 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,543] ERROR Controller 0 epoch 29 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:18:29,543] TRACE Controller 0 epoch 29 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,547] ERROR Controller 0 epoch 29 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:18:29,584] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:18:29,584] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:18:29,584] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:18:29,585] TRACE Controller 0 epoch 29 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:18:29,585] TRACE Controller 0 epoch 29 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:18:29,585] TRACE Controller 0 epoch 29 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:18:29,585] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,586] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,586] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,586] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:18:29,586] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:18:29,586] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:18:29,587] TRACE Controller 0 epoch 29 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,594] TRACE Controller 0 epoch 29 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,594] TRACE Controller 0 epoch 29 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:18:29,594] TRACE Controller 0 epoch 29 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,600] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 0 (state.change.logger)
[2018-04-16 10:18:29,600] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 0 (state.change.logger)
[2018-04-16 10:18:29,600] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 0 (state.change.logger)
[2018-04-16 10:18:29,600] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:18:29,601] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 29 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,601] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 29 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,601] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 29 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,601] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 29 for partition [kafka_topic,0] since its associated leader epoch 6 is old. Current leader epoch is 6 (state.change.logger)
[2018-04-16 10:18:29,601] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 29 for partition [kafka_test,0] since its associated leader epoch 27 is old. Current leader epoch is 27 (state.change.logger)
[2018-04-16 10:18:29,601] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 29 for partition [project_topic,0] since its associated leader epoch 6 is old. Current leader epoch is 6 (state.change.logger)
[2018-04-16 10:18:29,603] TRACE Controller 0 epoch 29 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:18:29,603] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 2 (state.change.logger)
[2018-04-16 10:18:29,604] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:27,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 2 (state.change.logger)
[2018-04-16 10:18:29,604] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:6,ControllerEpoch:28),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 2 (state.change.logger)
[2018-04-16 10:18:29,607] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:18:29,608] TRACE Controller 0 epoch 29 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,608] TRACE Controller 0 epoch 29 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:18:29,608] TRACE Controller 0 epoch 29 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,615] TRACE Controller 0 epoch 29 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,615] TRACE Controller 0 epoch 29 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:18:29,615] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,615] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,615] TRACE Controller 0 epoch 29 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Controller 0 epoch 29 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 29 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 29 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,616] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 29 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 29 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 29 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 29 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,617] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 29 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:18:29,617] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 29 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:18:29,617] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 29 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 29 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 29 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 29 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:18:29,617] TRACE Controller 0 epoch 29 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:18:29,618] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 4 (state.change.logger)
[2018-04-16 10:18:29,618] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 4 (state.change.logger)
[2018-04-16 10:18:29,618] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 4 (state.change.logger)
[2018-04-16 10:18:29,618] TRACE Controller 0 epoch 29 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:26:58,069] TRACE Controller 0 epoch 30 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,071] ERROR Controller 0 epoch 30 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:26:58,071] TRACE Controller 0 epoch 30 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,073] ERROR Controller 0 epoch 30 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:26:58,073] TRACE Controller 0 epoch 30 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,077] ERROR Controller 0 epoch 30 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-16 10:26:58,094] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:26:58,094] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:26:58,094] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 0 (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 0 (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 0 (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:26:58,097] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:26:58,098] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:26:58,098] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 30 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,098] TRACE Controller 0 epoch 30 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,098] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 30 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,098] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 30 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,098] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 30 for partition [kafka_topic,0] since its associated leader epoch 7 is old. Current leader epoch is 7 (state.change.logger)
[2018-04-16 10:26:58,098] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 30 for partition [kafka_test,0] since its associated leader epoch 28 is old. Current leader epoch is 28 (state.change.logger)
[2018-04-16 10:26:58,098] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 30 for partition [project_topic,0] since its associated leader epoch 7 is old. Current leader epoch is 7 (state.change.logger)
[2018-04-16 10:26:58,099] TRACE Controller 0 epoch 30 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:26:58,099] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 2 (state.change.logger)
[2018-04-16 10:26:58,099] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:28,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 2 (state.change.logger)
[2018-04-16 10:26:58,099] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:7,ControllerEpoch:29),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 2 (state.change.logger)
[2018-04-16 10:26:58,100] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:26:58,102] TRACE Controller 0 epoch 30 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,102] TRACE Controller 0 epoch 30 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:26:58,102] TRACE Controller 0 epoch 30 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,105] TRACE Controller 0 epoch 30 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,106] TRACE Controller 0 epoch 30 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:26:58,106] TRACE Controller 0 epoch 30 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,110] TRACE Controller 0 epoch 30 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,110] TRACE Controller 0 epoch 30 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-16 10:26:58,110] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,110] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,110] TRACE Controller 0 epoch 30 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:30) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,111] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-16 10:26:58,111] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-16 10:26:58,111] TRACE Controller 0 epoch 30 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:30) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 30 for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 30 for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 30 for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 30 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 30 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,112] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 30 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,113] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 30 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:26:58,113] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 30 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:26:58,113] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 30 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-16 10:26:58,113] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 30 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-16 10:26:58,113] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 30 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-16 10:26:58,113] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 30 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-16 10:26:58,113] TRACE Controller 0 epoch 30 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-16 10:26:58,114] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 4 (state.change.logger)
[2018-04-16 10:26:58,114] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:29,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 4 (state.change.logger)
[2018-04-16 10:26:58,114] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:8,ControllerEpoch:30),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 30 with correlation id 4 (state.change.logger)
[2018-04-16 10:26:58,114] TRACE Controller 0 epoch 30 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
