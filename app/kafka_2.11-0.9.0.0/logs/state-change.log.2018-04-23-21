[2018-04-23 21:26:01,366] TRACE Controller 0 epoch 173 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,383] ERROR Controller 0 epoch 173 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:26:01,385] TRACE Controller 0 epoch 173 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,392] ERROR Controller 0 epoch 173 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:26:01,393] TRACE Controller 0 epoch 173 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,398] ERROR Controller 0 epoch 173 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:26:01,523] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:26:01,523] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:26:01,523] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:26:01,523] TRACE Controller 0 epoch 173 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:26:01,524] TRACE Controller 0 epoch 173 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,527] TRACE Controller 0 epoch 173 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,527] TRACE Controller 0 epoch 173 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:26:01,527] TRACE Controller 0 epoch 173 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,536] TRACE Controller 0 epoch 173 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,536] TRACE Controller 0 epoch 173 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:26:01,536] TRACE Controller 0 epoch 173 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,548] TRACE Controller 0 epoch 173 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,548] TRACE Controller 0 epoch 173 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:26:01,548] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,548] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,548] TRACE Controller 0 epoch 173 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,549] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:26:01,549] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:26:01,549] TRACE Controller 0 epoch 173 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:26:01,553] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 0 (state.change.logger)
[2018-04-23 21:26:01,554] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 0 (state.change.logger)
[2018-04-23 21:26:01,554] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 0 (state.change.logger)
[2018-04-23 21:26:01,554] TRACE Controller 0 epoch 173 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:26:01,561] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 173 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,561] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 173 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,561] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 173 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,561] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 173 for partition [kafka_topic,0] since its associated leader epoch 150 is old. Current leader epoch is 150 (state.change.logger)
[2018-04-23 21:26:01,561] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 173 for partition [kafka_test,0] since its associated leader epoch 171 is old. Current leader epoch is 171 (state.change.logger)
[2018-04-23 21:26:01,561] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 173 for partition [project_topic,0] since its associated leader epoch 150 is old. Current leader epoch is 150 (state.change.logger)
[2018-04-23 21:26:01,561] TRACE Controller 0 epoch 173 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:26:01,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 2 (state.change.logger)
[2018-04-23 21:26:01,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 2 (state.change.logger)
[2018-04-23 21:26:01,564] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:150,ControllerEpoch:172),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 2 (state.change.logger)
[2018-04-23 21:26:01,565] TRACE Controller 0 epoch 173 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 173 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 173 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 173 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 173 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 173 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,569] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 173 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,570] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 173 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:26:01,570] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 173 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:26:01,570] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 173 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:26:01,570] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 173 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:26:01,570] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 173 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:26:01,570] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 173 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:26:01,573] TRACE Controller 0 epoch 173 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:26:01,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 4 (state.change.logger)
[2018-04-23 21:26:01,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 4 (state.change.logger)
[2018-04-23 21:26:01,573] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 173 with correlation id 4 (state.change.logger)
[2018-04-23 21:26:01,573] TRACE Controller 0 epoch 173 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:51:58,672] TRACE Controller 0 epoch 174 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,676] ERROR Controller 0 epoch 174 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:51:58,676] TRACE Controller 0 epoch 174 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,682] ERROR Controller 0 epoch 174 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:51:58,683] TRACE Controller 0 epoch 174 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,685] ERROR Controller 0 epoch 174 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:51:58,725] TRACE Controller 0 epoch 174 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,731] TRACE Controller 0 epoch 174 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,731] TRACE Controller 0 epoch 174 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:51:58,731] TRACE Controller 0 epoch 174 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,732] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 0 (state.change.logger)
[2018-04-23 21:51:58,732] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 0 (state.change.logger)
[2018-04-23 21:51:58,732] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 0 (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Controller 0 epoch 174 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Controller 0 epoch 174 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Controller 0 epoch 174 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Controller 0 epoch 174 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 174 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 174 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,733] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 174 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 174 for partition [kafka_topic,0] since its associated leader epoch 151 is old. Current leader epoch is 151 (state.change.logger)
[2018-04-23 21:51:58,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 174 for partition [kafka_test,0] since its associated leader epoch 172 is old. Current leader epoch is 172 (state.change.logger)
[2018-04-23 21:51:58,733] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 174 for partition [project_topic,0] since its associated leader epoch 151 is old. Current leader epoch is 151 (state.change.logger)
[2018-04-23 21:51:58,734] TRACE Controller 0 epoch 174 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 2 (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:172,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 2 (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:151,ControllerEpoch:173),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 2 (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,735] TRACE Controller 0 epoch 174 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Controller 0 epoch 174 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 174 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 174 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 174 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 174 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 174 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 174 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,736] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 174 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:51:58,736] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 174 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:51:58,736] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 174 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 174 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 174 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:51:58,736] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 174 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:51:58,737] TRACE Controller 0 epoch 174 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:51:58,737] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 4 (state.change.logger)
[2018-04-23 21:51:58,737] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 4 (state.change.logger)
[2018-04-23 21:51:58,737] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 174 with correlation id 4 (state.change.logger)
[2018-04-23 21:51:58,737] TRACE Controller 0 epoch 174 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:53:17,477] TRACE Controller 0 epoch 175 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:17,599] ERROR Controller 0 epoch 175 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:53:17,605] TRACE Controller 0 epoch 175 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:17,705] ERROR Controller 0 epoch 175 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:53:17,713] TRACE Controller 0 epoch 175 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:17,794] ERROR Controller 0 epoch 175 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:53:17,988] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:53:17,990] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:53:17,993] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:53:17,997] TRACE Controller 0 epoch 175 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:53:17,998] TRACE Controller 0 epoch 175 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:53:17,998] TRACE Controller 0 epoch 175 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:53:18,000] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,000] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,001] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,001] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 0 (state.change.logger)
[2018-04-23 21:53:18,001] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 0 (state.change.logger)
[2018-04-23 21:53:18,001] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 0 (state.change.logger)
[2018-04-23 21:53:18,001] TRACE Controller 0 epoch 175 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:53:18,002] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:53:18,003] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 175 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,003] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:53:18,004] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 175 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,004] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:53:18,004] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 175 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,004] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 175 for partition [kafka_topic,0] since its associated leader epoch 152 is old. Current leader epoch is 152 (state.change.logger)
[2018-04-23 21:53:18,006] TRACE Controller 0 epoch 175 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,006] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 175 for partition [kafka_test,0] since its associated leader epoch 173 is old. Current leader epoch is 173 (state.change.logger)
[2018-04-23 21:53:18,007] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 175 for partition [project_topic,0] since its associated leader epoch 152 is old. Current leader epoch is 152 (state.change.logger)
[2018-04-23 21:53:18,011] TRACE Controller 0 epoch 175 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:53:18,011] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 2 (state.change.logger)
[2018-04-23 21:53:18,011] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:173,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 2 (state.change.logger)
[2018-04-23 21:53:18,011] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:152,ControllerEpoch:174),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 2 (state.change.logger)
[2018-04-23 21:53:18,012] TRACE Controller 0 epoch 175 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:53:18,080] TRACE Controller 0 epoch 175 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,081] TRACE Controller 0 epoch 175 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:53:18,082] TRACE Controller 0 epoch 175 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,139] TRACE Controller 0 epoch 175 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,139] TRACE Controller 0 epoch 175 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:53:18,140] TRACE Controller 0 epoch 175 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,193] TRACE Controller 0 epoch 175 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,195] TRACE Controller 0 epoch 175 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:53:18,195] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,196] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,196] TRACE Controller 0 epoch 175 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,198] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:53:18,198] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:53:18,198] TRACE Controller 0 epoch 175 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:53:18,198] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 175 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,199] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 175 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,201] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 175 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,202] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 175 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,202] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 175 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,204] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 175 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,207] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 175 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:53:18,208] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 175 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:53:18,210] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 175 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:53:18,210] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 175 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:53:18,211] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 175 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:53:18,213] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 175 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:53:18,216] TRACE Controller 0 epoch 175 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:53:18,219] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 4 (state.change.logger)
[2018-04-23 21:53:18,221] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 4 (state.change.logger)
[2018-04-23 21:53:18,222] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 175 with correlation id 4 (state.change.logger)
[2018-04-23 21:53:18,223] TRACE Controller 0 epoch 175 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:54:28,662] TRACE Controller 0 epoch 176 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:28,770] ERROR Controller 0 epoch 176 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:54:28,783] TRACE Controller 0 epoch 176 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:28,897] ERROR Controller 0 epoch 176 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:54:28,912] TRACE Controller 0 epoch 176 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,014] ERROR Controller 0 epoch 176 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:54:29,223] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:54:29,225] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:54:29,225] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:54:29,228] TRACE Controller 0 epoch 176 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:54:29,228] TRACE Controller 0 epoch 176 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:54:29,228] TRACE Controller 0 epoch 176 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:54:29,229] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,230] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,231] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,231] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 0 (state.change.logger)
[2018-04-23 21:54:29,233] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 0 (state.change.logger)
[2018-04-23 21:54:29,235] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:54:29,235] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 0 (state.change.logger)
[2018-04-23 21:54:29,235] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:54:29,236] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:54:29,237] TRACE Controller 0 epoch 176 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:54:29,238] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 176 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,238] TRACE Controller 0 epoch 176 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,238] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 176 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,239] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 176 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,239] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 176 for partition [kafka_topic,0] since its associated leader epoch 153 is old. Current leader epoch is 153 (state.change.logger)
[2018-04-23 21:54:29,240] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 176 for partition [kafka_test,0] since its associated leader epoch 174 is old. Current leader epoch is 174 (state.change.logger)
[2018-04-23 21:54:29,241] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 176 for partition [project_topic,0] since its associated leader epoch 153 is old. Current leader epoch is 153 (state.change.logger)
[2018-04-23 21:54:29,244] TRACE Controller 0 epoch 176 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:54:29,244] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 2 (state.change.logger)
[2018-04-23 21:54:29,245] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:174,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 2 (state.change.logger)
[2018-04-23 21:54:29,248] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:153,ControllerEpoch:175),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 2 (state.change.logger)
[2018-04-23 21:54:29,249] TRACE Controller 0 epoch 176 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:54:29,297] TRACE Controller 0 epoch 176 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,300] TRACE Controller 0 epoch 176 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:54:29,300] TRACE Controller 0 epoch 176 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,373] TRACE Controller 0 epoch 176 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,373] TRACE Controller 0 epoch 176 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:54:29,375] TRACE Controller 0 epoch 176 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,427] TRACE Controller 0 epoch 176 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,430] TRACE Controller 0 epoch 176 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:54:29,430] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,432] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,432] TRACE Controller 0 epoch 176 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,434] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 176 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,434] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:54:29,434] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:54:29,434] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 176 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,434] TRACE Controller 0 epoch 176 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:54:29,437] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 176 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,437] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 176 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,440] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 176 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,441] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 176 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,443] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 176 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:54:29,446] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 176 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:54:29,446] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 176 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:54:29,448] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 176 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:54:29,449] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 176 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:54:29,449] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 176 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:54:29,452] TRACE Controller 0 epoch 176 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:54:29,457] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 4 (state.change.logger)
[2018-04-23 21:54:29,459] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 4 (state.change.logger)
[2018-04-23 21:54:29,463] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 176 with correlation id 4 (state.change.logger)
[2018-04-23 21:54:29,463] TRACE Controller 0 epoch 176 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:56:24,600] TRACE Controller 0 epoch 177 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:24,755] ERROR Controller 0 epoch 177 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:56:24,775] TRACE Controller 0 epoch 177 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:24,968] ERROR Controller 0 epoch 177 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:56:24,981] TRACE Controller 0 epoch 177 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:25,162] ERROR Controller 0 epoch 177 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:56:25,623] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:56:25,625] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:56:25,627] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:56:25,638] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 0 (state.change.logger)
[2018-04-23 21:56:25,638] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 0 (state.change.logger)
[2018-04-23 21:56:25,639] TRACE Controller 0 epoch 177 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:56:25,643] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 0 (state.change.logger)
[2018-04-23 21:56:25,649] TRACE Controller 0 epoch 177 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:56:25,649] TRACE Controller 0 epoch 177 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:56:25,652] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:25,654] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:25,654] TRACE Controller 0 epoch 177 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:56:25,656] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:25,662] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:56:25,665] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 177 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:25,665] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:56:25,668] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:56:25,669] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 177 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:25,671] TRACE Controller 0 epoch 177 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:25,674] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 177 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:25,676] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 177 for partition [kafka_topic,0] since its associated leader epoch 154 is old. Current leader epoch is 154 (state.change.logger)
[2018-04-23 21:56:25,676] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 177 for partition [kafka_test,0] since its associated leader epoch 175 is old. Current leader epoch is 175 (state.change.logger)
[2018-04-23 21:56:25,678] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 177 for partition [project_topic,0] since its associated leader epoch 154 is old. Current leader epoch is 154 (state.change.logger)
[2018-04-23 21:56:25,684] TRACE Controller 0 epoch 177 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:56:25,688] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 2 (state.change.logger)
[2018-04-23 21:56:25,689] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:175,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 2 (state.change.logger)
[2018-04-23 21:56:25,690] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:154,ControllerEpoch:176),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 2 (state.change.logger)
[2018-04-23 21:56:25,694] TRACE Controller 0 epoch 177 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:56:25,815] TRACE Controller 0 epoch 177 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:25,825] TRACE Controller 0 epoch 177 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:56:25,825] TRACE Controller 0 epoch 177 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:25,951] TRACE Controller 0 epoch 177 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:25,957] TRACE Controller 0 epoch 177 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:56:25,962] TRACE Controller 0 epoch 177 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,058] TRACE Controller 0 epoch 177 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,063] TRACE Controller 0 epoch 177 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:56:26,066] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:26,066] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,067] TRACE Controller 0 epoch 177 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:26,068] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:56:26,068] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:56:26,070] TRACE Controller 0 epoch 177 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:56:26,071] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 177 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:26,075] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 177 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:26,077] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 177 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,078] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 177 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:26,078] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 177 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,079] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 177 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:26,081] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 177 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:56:26,081] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 177 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:56:26,081] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 177 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:56:26,083] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 177 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:56:26,083] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 177 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:56:26,083] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 177 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:56:26,089] TRACE Controller 0 epoch 177 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:56:26,096] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 4 (state.change.logger)
[2018-04-23 21:56:26,101] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 4 (state.change.logger)
[2018-04-23 21:56:26,107] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 177 with correlation id 4 (state.change.logger)
[2018-04-23 21:56:26,109] TRACE Controller 0 epoch 177 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:58:30,577] TRACE Controller 0 epoch 178 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:30,647] ERROR Controller 0 epoch 178 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:58:30,657] TRACE Controller 0 epoch 178 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:30,752] ERROR Controller 0 epoch 178 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:58:30,755] TRACE Controller 0 epoch 178 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:30,828] ERROR Controller 0 epoch 178 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:58:31,029] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:58:31,029] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:58:31,029] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:58:31,032] TRACE Controller 0 epoch 178 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:58:31,034] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 0 (state.change.logger)
[2018-04-23 21:58:31,035] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 0 (state.change.logger)
[2018-04-23 21:58:31,035] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 0 (state.change.logger)
[2018-04-23 21:58:31,037] TRACE Controller 0 epoch 178 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:58:31,039] TRACE Controller 0 epoch 178 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:58:31,039] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,040] TRACE Controller 0 epoch 178 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:58:31,040] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,041] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,041] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:58:31,042] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:58:31,044] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 178 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,045] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 178 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,045] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 178 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,045] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 178 for partition [kafka_topic,0] since its associated leader epoch 155 is old. Current leader epoch is 155 (state.change.logger)
[2018-04-23 21:58:31,045] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:58:31,046] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 178 for partition [kafka_test,0] since its associated leader epoch 176 is old. Current leader epoch is 176 (state.change.logger)
[2018-04-23 21:58:31,048] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 178 for partition [project_topic,0] since its associated leader epoch 155 is old. Current leader epoch is 155 (state.change.logger)
[2018-04-23 21:58:31,049] TRACE Controller 0 epoch 178 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,050] TRACE Controller 0 epoch 178 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:58:31,054] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 2 (state.change.logger)
[2018-04-23 21:58:31,055] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:176,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 2 (state.change.logger)
[2018-04-23 21:58:31,056] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:155,ControllerEpoch:177),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 2 (state.change.logger)
[2018-04-23 21:58:31,058] TRACE Controller 0 epoch 178 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:58:31,091] TRACE Controller 0 epoch 178 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,093] TRACE Controller 0 epoch 178 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:58:31,093] TRACE Controller 0 epoch 178 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,135] TRACE Controller 0 epoch 178 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,137] TRACE Controller 0 epoch 178 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:58:31,137] TRACE Controller 0 epoch 178 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,204] TRACE Controller 0 epoch 178 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,205] TRACE Controller 0 epoch 178 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:58:31,206] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,207] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,207] TRACE Controller 0 epoch 178 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,208] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:58:31,208] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 178 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,209] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:58:31,210] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 178 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,211] TRACE Controller 0 epoch 178 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:58:31,212] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 178 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,212] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 178 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,213] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 178 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,215] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 178 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,217] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 178 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:58:31,219] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 178 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:58:31,220] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 178 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:58:31,220] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 178 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:58:31,220] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 178 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:58:31,220] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 178 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:58:31,222] TRACE Controller 0 epoch 178 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:58:31,224] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 4 (state.change.logger)
[2018-04-23 21:58:31,228] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 4 (state.change.logger)
[2018-04-23 21:58:31,230] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 178 with correlation id 4 (state.change.logger)
[2018-04-23 21:58:31,233] TRACE Controller 0 epoch 178 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:59:52,433] TRACE Controller 0 epoch 179 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:52,514] ERROR Controller 0 epoch 179 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:59:52,516] TRACE Controller 0 epoch 179 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:52,579] ERROR Controller 0 epoch 179 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:59:52,591] TRACE Controller 0 epoch 179 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:52,661] ERROR Controller 0 epoch 179 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-23 21:59:52,861] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:59:52,863] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:59:52,863] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:59:52,866] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 0 (state.change.logger)
[2018-04-23 21:59:52,867] TRACE Controller 0 epoch 179 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:59:52,868] TRACE Controller 0 epoch 179 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:59:52,868] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 0 (state.change.logger)
[2018-04-23 21:59:52,868] TRACE Controller 0 epoch 179 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-23 21:59:52,870] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 0 (state.change.logger)
[2018-04-23 21:59:52,873] TRACE Controller 0 epoch 179 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:59:52,873] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:52,873] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:52,873] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:52,874] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:59:52,874] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:59:52,876] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 179 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:52,876] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 179 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:52,876] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:59:52,877] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 179 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:52,878] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 179 for partition [kafka_topic,0] since its associated leader epoch 156 is old. Current leader epoch is 156 (state.change.logger)
[2018-04-23 21:59:52,879] TRACE Controller 0 epoch 179 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:52,879] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 179 for partition [kafka_test,0] since its associated leader epoch 177 is old. Current leader epoch is 177 (state.change.logger)
[2018-04-23 21:59:52,879] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 179 for partition [project_topic,0] since its associated leader epoch 156 is old. Current leader epoch is 156 (state.change.logger)
[2018-04-23 21:59:52,881] TRACE Controller 0 epoch 179 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:59:52,885] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 2 (state.change.logger)
[2018-04-23 21:59:52,885] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:177,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 2 (state.change.logger)
[2018-04-23 21:59:52,885] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:156,ControllerEpoch:178),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 2 (state.change.logger)
[2018-04-23 21:59:52,886] TRACE Controller 0 epoch 179 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:59:52,935] TRACE Controller 0 epoch 179 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:52,938] TRACE Controller 0 epoch 179 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:59:52,940] TRACE Controller 0 epoch 179 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,038] TRACE Controller 0 epoch 179 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,040] TRACE Controller 0 epoch 179 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:59:53,040] TRACE Controller 0 epoch 179 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,112] TRACE Controller 0 epoch 179 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,116] TRACE Controller 0 epoch 179 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-23 21:59:53,117] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:53,118] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,119] TRACE Controller 0 epoch 179 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,121] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-23 21:59:53,124] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-23 21:59:53,124] TRACE Controller 0 epoch 179 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-23 21:59:53,124] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 179 for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:53,125] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 179 for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,127] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 179 for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,130] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 179 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:53,130] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 179 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,130] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 179 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,136] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 179 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:59:53,139] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 179 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:59:53,142] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 179 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-23 21:59:53,145] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 179 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-23 21:59:53,146] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 179 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-23 21:59:53,148] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 179 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-23 21:59:53,150] TRACE Controller 0 epoch 179 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-23 21:59:53,153] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 4 (state.change.logger)
[2018-04-23 21:59:53,158] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 4 (state.change.logger)
[2018-04-23 21:59:53,159] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 179 with correlation id 4 (state.change.logger)
[2018-04-23 21:59:53,161] TRACE Controller 0 epoch 179 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
