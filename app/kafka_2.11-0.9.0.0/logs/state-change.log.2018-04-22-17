[2018-04-22 17:02:48,593] TRACE Controller 0 epoch 133 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,595] ERROR Controller 0 epoch 133 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:02:48,595] TRACE Controller 0 epoch 133 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,605] ERROR Controller 0 epoch 133 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:02:48,605] TRACE Controller 0 epoch 133 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,607] ERROR Controller 0 epoch 133 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:02:48,616] TRACE Controller 0 epoch 133 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,618] TRACE Controller 0 epoch 133 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,618] TRACE Controller 0 epoch 133 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:02:48,618] TRACE Controller 0 epoch 133 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,621] TRACE Controller 0 epoch 133 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,622] TRACE Controller 0 epoch 133 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:02:48,622] TRACE Controller 0 epoch 133 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 0 (state.change.logger)
[2018-04-22 17:02:48,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 0 (state.change.logger)
[2018-04-22 17:02:48,624] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 0 (state.change.logger)
[2018-04-22 17:02:48,624] TRACE Controller 0 epoch 133 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:02:48,625] TRACE Controller 0 epoch 133 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:02:48,626] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 133 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,626] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 133 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,626] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 133 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,626] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 133 for partition [kafka_topic,0] since its associated leader epoch 110 is old. Current leader epoch is 110 (state.change.logger)
[2018-04-22 17:02:48,626] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 133 for partition [kafka_test,0] since its associated leader epoch 131 is old. Current leader epoch is 131 (state.change.logger)
[2018-04-22 17:02:48,626] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 133 for partition [project_topic,0] since its associated leader epoch 110 is old. Current leader epoch is 110 (state.change.logger)
[2018-04-22 17:02:48,626] TRACE Controller 0 epoch 133 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 2 (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 2 (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 2 (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Controller 0 epoch 133 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 133 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 133 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 133 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 133 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 133 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,628] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 133 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,629] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 133 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:02:48,629] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 133 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:02:48,629] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 133 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:02:48,629] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 133 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:02:48,629] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 133 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:02:48,629] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 133 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:02:48,629] TRACE Controller 0 epoch 133 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:02:48,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 4 (state.change.logger)
[2018-04-22 17:02:48,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 4 (state.change.logger)
[2018-04-22 17:02:48,630] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 133 with correlation id 4 (state.change.logger)
[2018-04-22 17:02:48,630] TRACE Controller 0 epoch 133 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:06:00,795] TRACE Controller 0 epoch 134 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,796] ERROR Controller 0 epoch 134 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:06:00,797] TRACE Controller 0 epoch 134 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,798] ERROR Controller 0 epoch 134 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:06:00,799] TRACE Controller 0 epoch 134 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,801] ERROR Controller 0 epoch 134 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:06:00,818] TRACE Controller 0 epoch 134 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 0 (state.change.logger)
[2018-04-22 17:06:00,819] TRACE Controller 0 epoch 134 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:06:00,820] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 134 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,820] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 134 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,820] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 134 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,820] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 134 for partition [kafka_topic,0] since its associated leader epoch 111 is old. Current leader epoch is 111 (state.change.logger)
[2018-04-22 17:06:00,820] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 134 for partition [kafka_test,0] since its associated leader epoch 132 is old. Current leader epoch is 132 (state.change.logger)
[2018-04-22 17:06:00,820] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 134 for partition [project_topic,0] since its associated leader epoch 111 is old. Current leader epoch is 111 (state.change.logger)
[2018-04-22 17:06:00,822] TRACE Controller 0 epoch 134 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:06:00,822] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 2 (state.change.logger)
[2018-04-22 17:06:00,822] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 2 (state.change.logger)
[2018-04-22 17:06:00,822] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 2 (state.change.logger)
[2018-04-22 17:06:00,822] TRACE Controller 0 epoch 134 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:06:00,828] TRACE Controller 0 epoch 134 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,828] TRACE Controller 0 epoch 134 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:06:00,828] TRACE Controller 0 epoch 134 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,831] TRACE Controller 0 epoch 134 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,831] TRACE Controller 0 epoch 134 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:06:00,831] TRACE Controller 0 epoch 134 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Controller 0 epoch 134 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 134 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 134 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 134 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,846] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 134 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 134 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 134 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,847] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 134 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:06:00,847] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 134 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:06:00,847] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 134 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 134 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 134 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 134 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Controller 0 epoch 134 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:06:00,847] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 4 (state.change.logger)
[2018-04-22 17:06:00,848] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 4 (state.change.logger)
[2018-04-22 17:06:00,848] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 134 with correlation id 4 (state.change.logger)
[2018-04-22 17:06:00,848] TRACE Controller 0 epoch 134 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:10:05,512] TRACE Controller 0 epoch 135 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,514] ERROR Controller 0 epoch 135 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:10:05,514] TRACE Controller 0 epoch 135 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,515] ERROR Controller 0 epoch 135 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:10:05,516] TRACE Controller 0 epoch 135 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,517] ERROR Controller 0 epoch 135 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:10:05,524] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:10:05,525] TRACE Controller 0 epoch 135 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 0 (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 0 (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 0 (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Controller 0 epoch 135 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 135 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 135 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,526] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 135 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,527] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 135 for partition [kafka_topic,0] since its associated leader epoch 112 is old. Current leader epoch is 112 (state.change.logger)
[2018-04-22 17:10:05,527] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 135 for partition [kafka_test,0] since its associated leader epoch 133 is old. Current leader epoch is 133 (state.change.logger)
[2018-04-22 17:10:05,527] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 135 for partition [project_topic,0] since its associated leader epoch 112 is old. Current leader epoch is 112 (state.change.logger)
[2018-04-22 17:10:05,527] TRACE Controller 0 epoch 135 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:10:05,527] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 2 (state.change.logger)
[2018-04-22 17:10:05,527] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 2 (state.change.logger)
[2018-04-22 17:10:05,527] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 2 (state.change.logger)
[2018-04-22 17:10:05,527] TRACE Controller 0 epoch 135 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:10:05,529] TRACE Controller 0 epoch 135 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,529] TRACE Controller 0 epoch 135 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:10:05,529] TRACE Controller 0 epoch 135 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,531] TRACE Controller 0 epoch 135 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,531] TRACE Controller 0 epoch 135 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:10:05,531] TRACE Controller 0 epoch 135 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,534] TRACE Controller 0 epoch 135 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,534] TRACE Controller 0 epoch 135 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:10:05,534] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,534] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,534] TRACE Controller 0 epoch 135 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 135 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 135 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 135 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 135 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 135 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 135 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,535] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 135 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:10:05,535] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 135 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:10:05,535] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 135 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 135 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 135 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 135 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Controller 0 epoch 135 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:10:05,535] TRACE Controller 0 epoch 135 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:10:05,536] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 4 (state.change.logger)
[2018-04-22 17:10:05,536] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 4 (state.change.logger)
[2018-04-22 17:10:05,536] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 135 with correlation id 4 (state.change.logger)
[2018-04-22 17:10:05,536] TRACE Controller 0 epoch 135 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:12:55,201] TRACE Controller 0 epoch 136 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,207] ERROR Controller 0 epoch 136 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:12:55,208] TRACE Controller 0 epoch 136 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,214] ERROR Controller 0 epoch 136 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:12:55,214] TRACE Controller 0 epoch 136 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,220] ERROR Controller 0 epoch 136 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:12:55,262] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:12:55,262] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:12:55,262] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:12:55,263] TRACE Controller 0 epoch 136 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:12:55,263] TRACE Controller 0 epoch 136 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:12:55,264] TRACE Controller 0 epoch 136 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:12:55,264] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,264] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,264] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,264] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:12:55,267] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:12:55,267] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:12:55,267] TRACE Controller 0 epoch 136 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,275] TRACE Controller 0 epoch 136 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,275] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 0 (state.change.logger)
[2018-04-22 17:12:55,275] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 0 (state.change.logger)
[2018-04-22 17:12:55,275] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 0 (state.change.logger)
[2018-04-22 17:12:55,276] TRACE Controller 0 epoch 136 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:12:55,276] TRACE Controller 0 epoch 136 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,276] TRACE Controller 0 epoch 136 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:12:55,276] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 136 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,276] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 136 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,277] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 136 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,277] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 136 for partition [kafka_topic,0] since its associated leader epoch 113 is old. Current leader epoch is 113 (state.change.logger)
[2018-04-22 17:12:55,277] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 136 for partition [kafka_test,0] since its associated leader epoch 134 is old. Current leader epoch is 134 (state.change.logger)
[2018-04-22 17:12:55,277] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 136 for partition [project_topic,0] since its associated leader epoch 113 is old. Current leader epoch is 113 (state.change.logger)
[2018-04-22 17:12:55,278] TRACE Controller 0 epoch 136 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:12:55,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 2 (state.change.logger)
[2018-04-22 17:12:55,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 2 (state.change.logger)
[2018-04-22 17:12:55,279] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 2 (state.change.logger)
[2018-04-22 17:12:55,279] TRACE Controller 0 epoch 136 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:12:55,283] TRACE Controller 0 epoch 136 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,283] TRACE Controller 0 epoch 136 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:12:55,283] TRACE Controller 0 epoch 136 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,290] TRACE Controller 0 epoch 136 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,290] TRACE Controller 0 epoch 136 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:12:55,290] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,290] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,290] TRACE Controller 0 epoch 136 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,291] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:12:55,291] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:12:55,291] TRACE Controller 0 epoch 136 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:12:55,292] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 136 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,292] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 136 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,292] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 136 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,293] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 136 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,293] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 136 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,293] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 136 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 136 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:12:55,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 136 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:12:55,294] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 136 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:12:55,294] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 136 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:12:55,294] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 136 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:12:55,294] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 136 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:12:55,295] TRACE Controller 0 epoch 136 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:12:55,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 4 (state.change.logger)
[2018-04-22 17:12:55,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 4 (state.change.logger)
[2018-04-22 17:12:55,296] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 136 with correlation id 4 (state.change.logger)
[2018-04-22 17:12:55,297] TRACE Controller 0 epoch 136 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:17:03,441] TRACE Controller 0 epoch 137 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,443] ERROR Controller 0 epoch 137 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:17:03,443] TRACE Controller 0 epoch 137 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,444] ERROR Controller 0 epoch 137 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:17:03,445] TRACE Controller 0 epoch 137 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,446] ERROR Controller 0 epoch 137 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:17:03,456] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:17:03,456] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:17:03,456] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:17:03,457] TRACE Controller 0 epoch 137 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Controller 0 epoch 137 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 137 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 137 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 137 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,458] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 137 for partition [kafka_topic,0] since its associated leader epoch 114 is old. Current leader epoch is 114 (state.change.logger)
[2018-04-22 17:17:03,458] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 137 for partition [kafka_test,0] since its associated leader epoch 135 is old. Current leader epoch is 135 (state.change.logger)
[2018-04-22 17:17:03,458] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 137 for partition [project_topic,0] since its associated leader epoch 114 is old. Current leader epoch is 114 (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Controller 0 epoch 137 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 2 (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 2 (state.change.logger)
[2018-04-22 17:17:03,458] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 2 (state.change.logger)
[2018-04-22 17:17:03,459] TRACE Controller 0 epoch 137 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:17:03,460] TRACE Controller 0 epoch 137 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,461] TRACE Controller 0 epoch 137 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:17:03,461] TRACE Controller 0 epoch 137 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,476] TRACE Controller 0 epoch 137 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,477] TRACE Controller 0 epoch 137 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:17:03,477] TRACE Controller 0 epoch 137 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,506] TRACE Controller 0 epoch 137 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,506] TRACE Controller 0 epoch 137 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:17:03,506] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Controller 0 epoch 137 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Controller 0 epoch 137 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 137 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,507] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 137 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 137 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 137 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 137 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 137 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 137 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:17:03,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 137 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:17:03,508] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 137 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 137 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 137 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:17:03,508] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 137 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:17:03,509] TRACE Controller 0 epoch 137 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:17:03,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 4 (state.change.logger)
[2018-04-22 17:17:03,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 4 (state.change.logger)
[2018-04-22 17:17:03,509] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 137 with correlation id 4 (state.change.logger)
[2018-04-22 17:17:03,509] TRACE Controller 0 epoch 137 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:24:17,089] TRACE Controller 0 epoch 138 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,097] ERROR Controller 0 epoch 138 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:24:17,097] TRACE Controller 0 epoch 138 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,098] ERROR Controller 0 epoch 138 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:24:17,099] TRACE Controller 0 epoch 138 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,100] ERROR Controller 0 epoch 138 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:24:17,110] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:24:17,110] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:24:17,110] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:24:17,114] TRACE Controller 0 epoch 138 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:24:17,114] TRACE Controller 0 epoch 138 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 0 (state.change.logger)
[2018-04-22 17:24:17,115] TRACE Controller 0 epoch 138 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 138 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 138 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 138 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,116] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 138 for partition [kafka_topic,0] since its associated leader epoch 115 is old. Current leader epoch is 115 (state.change.logger)
[2018-04-22 17:24:17,116] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 138 for partition [kafka_test,0] since its associated leader epoch 136 is old. Current leader epoch is 136 (state.change.logger)
[2018-04-22 17:24:17,116] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 138 for partition [project_topic,0] since its associated leader epoch 115 is old. Current leader epoch is 115 (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Controller 0 epoch 138 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 2 (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 2 (state.change.logger)
[2018-04-22 17:24:17,116] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 2 (state.change.logger)
[2018-04-22 17:24:17,117] TRACE Controller 0 epoch 138 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:24:17,118] TRACE Controller 0 epoch 138 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,118] TRACE Controller 0 epoch 138 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:24:17,118] TRACE Controller 0 epoch 138 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,120] TRACE Controller 0 epoch 138 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,120] TRACE Controller 0 epoch 138 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:24:17,120] TRACE Controller 0 epoch 138 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,121] TRACE Controller 0 epoch 138 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,121] TRACE Controller 0 epoch 138 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:24:17,121] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,121] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,121] TRACE Controller 0 epoch 138 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,122] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:24:17,122] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:24:17,122] TRACE Controller 0 epoch 138 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 138 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 138 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 138 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 138 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 138 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 138 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,129] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 138 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:24:17,129] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 138 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:24:17,129] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 138 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 138 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 138 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:24:17,129] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 138 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:24:17,130] TRACE Controller 0 epoch 138 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:24:17,130] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 4 (state.change.logger)
[2018-04-22 17:24:17,130] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 4 (state.change.logger)
[2018-04-22 17:24:17,130] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 138 with correlation id 4 (state.change.logger)
[2018-04-22 17:24:17,131] TRACE Controller 0 epoch 138 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:27:02,231] TRACE Controller 0 epoch 139 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,232] ERROR Controller 0 epoch 139 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:27:02,233] TRACE Controller 0 epoch 139 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,237] ERROR Controller 0 epoch 139 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:27:02,237] TRACE Controller 0 epoch 139 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,240] ERROR Controller 0 epoch 139 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:27:02,249] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:27:02,249] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:27:02,249] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,252] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,253] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:27:02,253] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:27:02,253] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:27:02,253] TRACE Controller 0 epoch 139 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,255] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 0 (state.change.logger)
[2018-04-22 17:27:02,255] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 0 (state.change.logger)
[2018-04-22 17:27:02,255] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 0 (state.change.logger)
[2018-04-22 17:27:02,256] TRACE Controller 0 epoch 139 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:27:02,256] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 139 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,256] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 139 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,256] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 139 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,256] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 139 for partition [kafka_topic,0] since its associated leader epoch 116 is old. Current leader epoch is 116 (state.change.logger)
[2018-04-22 17:27:02,256] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 139 for partition [kafka_test,0] since its associated leader epoch 137 is old. Current leader epoch is 137 (state.change.logger)
[2018-04-22 17:27:02,256] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 139 for partition [project_topic,0] since its associated leader epoch 116 is old. Current leader epoch is 116 (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Controller 0 epoch 139 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Controller 0 epoch 139 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 2 (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 2 (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 2 (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Controller 0 epoch 139 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Controller 0 epoch 139 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,257] TRACE Controller 0 epoch 139 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:27:02,259] TRACE Controller 0 epoch 139 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,259] TRACE Controller 0 epoch 139 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:27:02,259] TRACE Controller 0 epoch 139 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:27:02,261] TRACE Controller 0 epoch 139 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 139 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 139 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 139 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 139 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 139 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 139 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,262] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 139 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:27:02,262] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 139 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:27:02,262] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 139 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 139 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 139 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 139 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:27:02,262] TRACE Controller 0 epoch 139 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:27:02,263] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 4 (state.change.logger)
[2018-04-22 17:27:02,263] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 4 (state.change.logger)
[2018-04-22 17:27:02,263] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 139 with correlation id 4 (state.change.logger)
[2018-04-22 17:27:02,263] TRACE Controller 0 epoch 139 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:33:52,878] TRACE Controller 0 epoch 140 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,879] ERROR Controller 0 epoch 140 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:33:52,879] TRACE Controller 0 epoch 140 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,881] ERROR Controller 0 epoch 140 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:33:52,881] TRACE Controller 0 epoch 140 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,883] ERROR Controller 0 epoch 140 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:33:52,891] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:33:52,891] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:33:52,891] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:33:52,905] TRACE Controller 0 epoch 140 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,908] TRACE Controller 0 epoch 140 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:33:52,909] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 140 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,909] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 140 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,909] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 140 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,909] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 140 for partition [kafka_topic,0] since its associated leader epoch 117 is old. Current leader epoch is 117 (state.change.logger)
[2018-04-22 17:33:52,909] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 140 for partition [kafka_test,0] since its associated leader epoch 138 is old. Current leader epoch is 138 (state.change.logger)
[2018-04-22 17:33:52,909] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 140 for partition [project_topic,0] since its associated leader epoch 117 is old. Current leader epoch is 117 (state.change.logger)
[2018-04-22 17:33:52,910] TRACE Controller 0 epoch 140 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:33:52,910] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 2 (state.change.logger)
[2018-04-22 17:33:52,910] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 2 (state.change.logger)
[2018-04-22 17:33:52,910] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 2 (state.change.logger)
[2018-04-22 17:33:52,910] TRACE Controller 0 epoch 140 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:33:52,913] TRACE Controller 0 epoch 140 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,913] TRACE Controller 0 epoch 140 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:33:52,913] TRACE Controller 0 epoch 140 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,915] TRACE Controller 0 epoch 140 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,915] TRACE Controller 0 epoch 140 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:33:52,915] TRACE Controller 0 epoch 140 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Controller 0 epoch 140 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 140 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,917] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 140 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 140 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 140 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 140 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 140 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,918] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 140 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:33:52,918] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 140 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:33:52,918] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 140 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 140 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 140 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 140 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Controller 0 epoch 140 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 4 (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 4 (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 140 with correlation id 4 (state.change.logger)
[2018-04-22 17:33:52,918] TRACE Controller 0 epoch 140 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:39:52,612] TRACE Controller 0 epoch 141 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,613] ERROR Controller 0 epoch 141 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:39:52,613] TRACE Controller 0 epoch 141 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,615] ERROR Controller 0 epoch 141 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:39:52,615] TRACE Controller 0 epoch 141 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,617] ERROR Controller 0 epoch 141 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-22 17:39:52,626] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:39:52,626] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:39:52,626] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 0 (state.change.logger)
[2018-04-22 17:39:52,631] TRACE Controller 0 epoch 141 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 141 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 141 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 141 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 141 for partition [kafka_topic,0] since its associated leader epoch 118 is old. Current leader epoch is 118 (state.change.logger)
[2018-04-22 17:39:52,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 141 for partition [kafka_test,0] since its associated leader epoch 139 is old. Current leader epoch is 139 (state.change.logger)
[2018-04-22 17:39:52,632] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 141 for partition [project_topic,0] since its associated leader epoch 118 is old. Current leader epoch is 118 (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Controller 0 epoch 141 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 2 (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 2 (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 2 (state.change.logger)
[2018-04-22 17:39:52,632] TRACE Controller 0 epoch 141 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:39:52,633] TRACE Controller 0 epoch 141 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,633] TRACE Controller 0 epoch 141 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:39:52,633] TRACE Controller 0 epoch 141 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,635] TRACE Controller 0 epoch 141 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,635] TRACE Controller 0 epoch 141 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:39:52,635] TRACE Controller 0 epoch 141 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Controller 0 epoch 141 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 141 for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 141 for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 141 for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 141 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 141 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,637] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 141 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,638] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 141 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:39:52,638] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 141 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:39:52,638] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 141 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 141 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 141 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 141 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Controller 0 epoch 141 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 4 (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 4 (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 141 with correlation id 4 (state.change.logger)
[2018-04-22 17:39:52,638] TRACE Controller 0 epoch 141 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
