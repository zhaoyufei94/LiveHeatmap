[2018-04-21 16:00:49,677] TRACE Controller 0 epoch 75 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,749] ERROR Controller 0 epoch 75 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:00:49,751] TRACE Controller 0 epoch 75 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,757] ERROR Controller 0 epoch 75 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:00:49,758] TRACE Controller 0 epoch 75 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,763] ERROR Controller 0 epoch 75 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:00:49,816] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:00:49,816] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:00:49,816] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:00:49,817] TRACE Controller 0 epoch 75 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,818] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:00:49,819] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:00:49,819] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:00:49,819] TRACE Controller 0 epoch 75 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,834] TRACE Controller 0 epoch 75 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,834] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 0 (state.change.logger)
[2018-04-21 16:00:49,837] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 0 (state.change.logger)
[2018-04-21 16:00:49,837] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 0 (state.change.logger)
[2018-04-21 16:00:49,838] TRACE Controller 0 epoch 75 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:00:49,840] TRACE Controller 0 epoch 75 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:00:49,840] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 75 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,842] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 75 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,842] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 75 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,842] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 75 for partition [kafka_topic,0] since its associated leader epoch 52 is old. Current leader epoch is 52 (state.change.logger)
[2018-04-21 16:00:49,842] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 75 for partition [kafka_test,0] since its associated leader epoch 73 is old. Current leader epoch is 73 (state.change.logger)
[2018-04-21 16:00:49,842] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 75 for partition [project_topic,0] since its associated leader epoch 52 is old. Current leader epoch is 52 (state.change.logger)
[2018-04-21 16:00:49,843] TRACE Controller 0 epoch 75 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,845] TRACE Controller 0 epoch 75 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:00:49,847] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 2 (state.change.logger)
[2018-04-21 16:00:49,847] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:73,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 2 (state.change.logger)
[2018-04-21 16:00:49,848] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:52,ControllerEpoch:74),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 2 (state.change.logger)
[2018-04-21 16:00:49,848] TRACE Controller 0 epoch 75 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:00:49,853] TRACE Controller 0 epoch 75 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,854] TRACE Controller 0 epoch 75 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:00:49,854] TRACE Controller 0 epoch 75 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,861] TRACE Controller 0 epoch 75 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,862] TRACE Controller 0 epoch 75 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:00:49,862] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,862] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,862] TRACE Controller 0 epoch 75 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 75 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 75 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 75 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 75 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 75 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,863] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 75 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,864] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 75 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:00:49,864] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 75 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:00:49,864] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 75 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:00:49,864] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 75 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:00:49,864] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 75 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:00:49,864] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 75 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:00:49,864] TRACE Controller 0 epoch 75 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:00:49,865] TRACE Controller 0 epoch 75 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:00:49,866] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 4 (state.change.logger)
[2018-04-21 16:00:49,866] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 4 (state.change.logger)
[2018-04-21 16:00:49,866] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 75 with correlation id 4 (state.change.logger)
[2018-04-21 16:00:49,866] TRACE Controller 0 epoch 75 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:04:55,067] TRACE Controller 0 epoch 76 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,073] ERROR Controller 0 epoch 76 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:04:55,074] TRACE Controller 0 epoch 76 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,081] ERROR Controller 0 epoch 76 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:04:55,082] TRACE Controller 0 epoch 76 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,090] ERROR Controller 0 epoch 76 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:04:55,125] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:04:55,125] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:04:55,125] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:04:55,126] TRACE Controller 0 epoch 76 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:04:55,126] TRACE Controller 0 epoch 76 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:04:55,126] TRACE Controller 0 epoch 76 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:04:55,127] TRACE Controller 0 epoch 76 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,135] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 0 (state.change.logger)
[2018-04-21 16:04:55,135] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 0 (state.change.logger)
[2018-04-21 16:04:55,135] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 0 (state.change.logger)
[2018-04-21 16:04:55,135] TRACE Controller 0 epoch 76 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:04:55,136] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 76 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,136] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 76 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,137] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 76 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,138] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 76 for partition [kafka_topic,0] since its associated leader epoch 53 is old. Current leader epoch is 53 (state.change.logger)
[2018-04-21 16:04:55,138] TRACE Controller 0 epoch 76 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,138] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 76 for partition [kafka_test,0] since its associated leader epoch 74 is old. Current leader epoch is 74 (state.change.logger)
[2018-04-21 16:04:55,138] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 76 for partition [project_topic,0] since its associated leader epoch 53 is old. Current leader epoch is 53 (state.change.logger)
[2018-04-21 16:04:55,139] TRACE Controller 0 epoch 76 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:04:55,140] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 2 (state.change.logger)
[2018-04-21 16:04:55,140] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:74,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 2 (state.change.logger)
[2018-04-21 16:04:55,140] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:53,ControllerEpoch:75),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 2 (state.change.logger)
[2018-04-21 16:04:55,141] TRACE Controller 0 epoch 76 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:04:55,141] TRACE Controller 0 epoch 76 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:04:55,141] TRACE Controller 0 epoch 76 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,150] TRACE Controller 0 epoch 76 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,150] TRACE Controller 0 epoch 76 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:04:55,150] TRACE Controller 0 epoch 76 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,158] TRACE Controller 0 epoch 76 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,159] TRACE Controller 0 epoch 76 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:04:55,159] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,159] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,159] TRACE Controller 0 epoch 76 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,160] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:04:55,160] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:04:55,160] TRACE Controller 0 epoch 76 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:04:55,161] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 76 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,161] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 76 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,162] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 76 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,162] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 76 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,162] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 76 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,162] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 76 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,162] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 76 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:04:55,163] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 76 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:04:55,163] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 76 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:04:55,163] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 76 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:04:55,163] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 76 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:04:55,163] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 76 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:04:55,165] TRACE Controller 0 epoch 76 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:04:55,166] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 4 (state.change.logger)
[2018-04-21 16:04:55,167] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 4 (state.change.logger)
[2018-04-21 16:04:55,167] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 76 with correlation id 4 (state.change.logger)
[2018-04-21 16:04:55,168] TRACE Controller 0 epoch 76 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:48:05,006] TRACE Controller 0 epoch 77 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,007] ERROR Controller 0 epoch 77 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:48:05,008] TRACE Controller 0 epoch 77 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,009] ERROR Controller 0 epoch 77 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:48:05,009] TRACE Controller 0 epoch 77 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,011] ERROR Controller 0 epoch 77 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:48:05,031] TRACE Controller 0 epoch 77 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,033] TRACE Controller 0 epoch 77 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,033] TRACE Controller 0 epoch 77 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:48:05,033] TRACE Controller 0 epoch 77 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,039] TRACE Controller 0 epoch 77 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,039] TRACE Controller 0 epoch 77 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:48:05,039] TRACE Controller 0 epoch 77 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 0 (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 0 (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 0 (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Controller 0 epoch 77 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 77 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 77 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,040] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 77 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 77 for partition [kafka_topic,0] since its associated leader epoch 54 is old. Current leader epoch is 54 (state.change.logger)
[2018-04-21 16:48:05,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 77 for partition [kafka_test,0] since its associated leader epoch 75 is old. Current leader epoch is 75 (state.change.logger)
[2018-04-21 16:48:05,040] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 77 for partition [project_topic,0] since its associated leader epoch 54 is old. Current leader epoch is 54 (state.change.logger)
[2018-04-21 16:48:05,041] TRACE Controller 0 epoch 77 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:48:05,041] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 2 (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:75,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 2 (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:54,ControllerEpoch:76),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 2 (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,042] TRACE Controller 0 epoch 77 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Controller 0 epoch 77 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 77 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 77 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 77 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 77 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 77 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,043] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 77 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,044] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 77 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:48:05,044] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 77 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:48:05,044] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 77 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:48:05,044] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 77 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:48:05,044] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 77 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:48:05,044] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 77 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:48:05,045] TRACE Controller 0 epoch 77 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:48:05,045] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 4 (state.change.logger)
[2018-04-21 16:48:05,046] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 4 (state.change.logger)
[2018-04-21 16:48:05,046] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 77 with correlation id 4 (state.change.logger)
[2018-04-21 16:48:05,046] TRACE Controller 0 epoch 77 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:54:33,156] TRACE Controller 0 epoch 78 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,158] ERROR Controller 0 epoch 78 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:54:33,158] TRACE Controller 0 epoch 78 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,162] ERROR Controller 0 epoch 78 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:54:33,162] TRACE Controller 0 epoch 78 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,164] ERROR Controller 0 epoch 78 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:54:33,173] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:54:33,173] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:54:33,173] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:54:33,174] TRACE Controller 0 epoch 78 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,176] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 0 (state.change.logger)
[2018-04-21 16:54:33,176] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 0 (state.change.logger)
[2018-04-21 16:54:33,176] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 0 (state.change.logger)
[2018-04-21 16:54:33,177] TRACE Controller 0 epoch 78 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 78 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 78 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 78 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Controller 0 epoch 78 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,180] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 78 for partition [kafka_topic,0] since its associated leader epoch 55 is old. Current leader epoch is 55 (state.change.logger)
[2018-04-21 16:54:33,180] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 78 for partition [kafka_test,0] since its associated leader epoch 76 is old. Current leader epoch is 76 (state.change.logger)
[2018-04-21 16:54:33,180] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 78 for partition [project_topic,0] since its associated leader epoch 55 is old. Current leader epoch is 55 (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Controller 0 epoch 78 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:54:33,180] TRACE Controller 0 epoch 78 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,181] TRACE Controller 0 epoch 78 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 2 (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:76,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 2 (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:55,ControllerEpoch:77),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 2 (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Controller 0 epoch 78 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Controller 0 epoch 78 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:54:33,182] TRACE Controller 0 epoch 78 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,183] TRACE Controller 0 epoch 78 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Controller 0 epoch 78 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:54:33,184] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 78 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,185] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 78 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,185] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 78 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,185] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 78 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,185] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 78 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,185] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 78 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,185] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 78 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:54:33,186] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 78 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:54:33,186] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 78 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:54:33,186] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 78 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:54:33,186] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 78 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:54:33,186] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 78 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:54:33,190] TRACE Controller 0 epoch 78 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:54:33,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 4 (state.change.logger)
[2018-04-21 16:54:33,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 4 (state.change.logger)
[2018-04-21 16:54:33,190] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 78 with correlation id 4 (state.change.logger)
[2018-04-21 16:54:33,190] TRACE Controller 0 epoch 78 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:55:32,486] TRACE Controller 0 epoch 79 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,487] ERROR Controller 0 epoch 79 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:55:32,488] TRACE Controller 0 epoch 79 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,496] ERROR Controller 0 epoch 79 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:55:32,497] TRACE Controller 0 epoch 79 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,500] ERROR Controller 0 epoch 79 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 16:55:32,510] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:55:32,510] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:55:32,510] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:55:32,511] TRACE Controller 0 epoch 79 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,522] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 0 (state.change.logger)
[2018-04-21 16:55:32,522] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 0 (state.change.logger)
[2018-04-21 16:55:32,522] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 0 (state.change.logger)
[2018-04-21 16:55:32,522] TRACE Controller 0 epoch 79 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:55:32,522] TRACE Controller 0 epoch 79 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Controller 0 epoch 79 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Controller 0 epoch 79 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 79 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 79 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 79 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,523] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 79 for partition [kafka_topic,0] since its associated leader epoch 56 is old. Current leader epoch is 56 (state.change.logger)
[2018-04-21 16:55:32,523] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 79 for partition [kafka_test,0] since its associated leader epoch 77 is old. Current leader epoch is 77 (state.change.logger)
[2018-04-21 16:55:32,523] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 79 for partition [project_topic,0] since its associated leader epoch 56 is old. Current leader epoch is 56 (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Controller 0 epoch 79 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 2 (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 2 (state.change.logger)
[2018-04-21 16:55:32,523] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:56,ControllerEpoch:78),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 2 (state.change.logger)
[2018-04-21 16:55:32,524] TRACE Controller 0 epoch 79 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:55:32,525] TRACE Controller 0 epoch 79 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,525] TRACE Controller 0 epoch 79 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:55:32,525] TRACE Controller 0 epoch 79 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,537] TRACE Controller 0 epoch 79 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,537] TRACE Controller 0 epoch 79 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 16:55:32,537] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,537] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,537] TRACE Controller 0 epoch 79 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:79) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,538] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 16:55:32,538] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 16:55:32,538] TRACE Controller 0 epoch 79 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:79) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 79 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 79 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 79 for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 79 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 79 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 79 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,539] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 79 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:55:32,539] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 79 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:55:32,539] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 79 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 79 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 16:55:32,539] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 79 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 16:55:32,540] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 79 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 16:55:32,540] TRACE Controller 0 epoch 79 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 16:55:32,540] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 4 (state.change.logger)
[2018-04-21 16:55:32,540] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 4 (state.change.logger)
[2018-04-21 16:55:32,540] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:57,ControllerEpoch:79),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 79 with correlation id 4 (state.change.logger)
[2018-04-21 16:55:32,541] TRACE Controller 0 epoch 79 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
