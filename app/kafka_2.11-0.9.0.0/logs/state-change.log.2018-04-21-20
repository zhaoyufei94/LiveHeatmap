[2018-04-21 20:35:06,116] TRACE Controller 0 epoch 89 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,119] ERROR Controller 0 epoch 89 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:35:06,119] TRACE Controller 0 epoch 89 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,122] ERROR Controller 0 epoch 89 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:35:06,122] TRACE Controller 0 epoch 89 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,124] ERROR Controller 0 epoch 89 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:35:06,134] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:35:06,135] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:35:06,140] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:35:06,140] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 0 (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Controller 0 epoch 89 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 89 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 89 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,141] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 89 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,141] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition [kafka_topic,0] since its associated leader epoch 66 is old. Current leader epoch is 66 (state.change.logger)
[2018-04-21 20:35:06,142] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition [kafka_test,0] since its associated leader epoch 87 is old. Current leader epoch is 87 (state.change.logger)
[2018-04-21 20:35:06,142] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 89 for partition [project_topic,0] since its associated leader epoch 66 is old. Current leader epoch is 66 (state.change.logger)
[2018-04-21 20:35:06,145] TRACE Controller 0 epoch 89 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:35:06,140] TRACE Controller 0 epoch 89 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2018-04-21 20:35:06,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2018-04-21 20:35:06,145] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:66,ControllerEpoch:88),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 2 (state.change.logger)
[2018-04-21 20:35:06,145] TRACE Controller 0 epoch 89 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:35:06,147] TRACE Controller 0 epoch 89 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,147] TRACE Controller 0 epoch 89 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:35:06,148] TRACE Controller 0 epoch 89 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,149] TRACE Controller 0 epoch 89 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,150] TRACE Controller 0 epoch 89 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:35:06,150] TRACE Controller 0 epoch 89 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,151] TRACE Controller 0 epoch 89 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,151] TRACE Controller 0 epoch 89 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:35:06,151] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,151] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Controller 0 epoch 89 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Controller 0 epoch 89 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 89 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 89 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 89 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,152] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 89 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,153] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:35:06,153] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:35:06,153] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 89 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 89 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Controller 0 epoch 89 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2018-04-21 20:35:06,153] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 89 with correlation id 4 (state.change.logger)
[2018-04-21 20:35:06,154] TRACE Controller 0 epoch 89 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:39:40,176] TRACE Controller 0 epoch 90 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,178] ERROR Controller 0 epoch 90 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:39:40,179] TRACE Controller 0 epoch 90 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,183] ERROR Controller 0 epoch 90 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:39:40,183] TRACE Controller 0 epoch 90 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,186] ERROR Controller 0 epoch 90 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:39:40,211] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:39:40,211] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:39:40,211] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:39:40,216] TRACE Controller 0 epoch 90 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 90 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Controller 0 epoch 90 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 90 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,217] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 90 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,217] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition [kafka_topic,0] since its associated leader epoch 67 is old. Current leader epoch is 67 (state.change.logger)
[2018-04-21 20:39:40,217] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition [kafka_test,0] since its associated leader epoch 88 is old. Current leader epoch is 88 (state.change.logger)
[2018-04-21 20:39:40,217] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 90 for partition [project_topic,0] since its associated leader epoch 67 is old. Current leader epoch is 67 (state.change.logger)
[2018-04-21 20:39:40,218] TRACE Controller 0 epoch 90 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:39:40,218] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2018-04-21 20:39:40,218] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:88,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2018-04-21 20:39:40,218] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:67,ControllerEpoch:89),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 2 (state.change.logger)
[2018-04-21 20:39:40,218] TRACE Controller 0 epoch 90 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:39:40,220] TRACE Controller 0 epoch 90 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,220] TRACE Controller 0 epoch 90 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:39:40,220] TRACE Controller 0 epoch 90 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,223] TRACE Controller 0 epoch 90 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,223] TRACE Controller 0 epoch 90 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:39:40,223] TRACE Controller 0 epoch 90 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Controller 0 epoch 90 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 90 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 90 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 90 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,227] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 90 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,227] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:39:40,227] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:39:40,227] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 90 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 90 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Controller 0 epoch 90 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 90 with correlation id 4 (state.change.logger)
[2018-04-21 20:39:40,228] TRACE Controller 0 epoch 90 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:41:28,438] TRACE Controller 0 epoch 91 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,439] ERROR Controller 0 epoch 91 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:41:28,440] TRACE Controller 0 epoch 91 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,442] ERROR Controller 0 epoch 91 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:41:28,442] TRACE Controller 0 epoch 91 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,444] ERROR Controller 0 epoch 91 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:41:28,474] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:41:28,474] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,483] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,484] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2018-04-21 20:41:28,484] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2018-04-21 20:41:28,484] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 0 (state.change.logger)
[2018-04-21 20:41:28,484] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:41:28,484] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Controller 0 epoch 91 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Controller 0 epoch 91 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 91 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 91 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 91 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,485] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition [kafka_topic,0] since its associated leader epoch 68 is old. Current leader epoch is 68 (state.change.logger)
[2018-04-21 20:41:28,485] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition [kafka_test,0] since its associated leader epoch 89 is old. Current leader epoch is 89 (state.change.logger)
[2018-04-21 20:41:28,485] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 91 for partition [project_topic,0] since its associated leader epoch 68 is old. Current leader epoch is 68 (state.change.logger)
[2018-04-21 20:41:28,485] TRACE Controller 0 epoch 91 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:41:28,486] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2018-04-21 20:41:28,486] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:89,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2018-04-21 20:41:28,486] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:68,ControllerEpoch:90),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 2 (state.change.logger)
[2018-04-21 20:41:28,486] TRACE Controller 0 epoch 91 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:41:28,487] TRACE Controller 0 epoch 91 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,487] TRACE Controller 0 epoch 91 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:41:28,487] TRACE Controller 0 epoch 91 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,490] TRACE Controller 0 epoch 91 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,490] TRACE Controller 0 epoch 91 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:41:28,490] TRACE Controller 0 epoch 91 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,492] TRACE Controller 0 epoch 91 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,492] TRACE Controller 0 epoch 91 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:41:28,492] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,492] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,492] TRACE Controller 0 epoch 91 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 91 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 91 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 91 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 91 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,493] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:41:28,493] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:41:28,493] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 91 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 91 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Controller 0 epoch 91 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:41:28,493] TRACE Controller 0 epoch 91 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:41:28,494] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2018-04-21 20:41:28,494] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2018-04-21 20:41:28,494] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 91 with correlation id 4 (state.change.logger)
[2018-04-21 20:41:28,494] TRACE Controller 0 epoch 91 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:42:32,411] TRACE Controller 0 epoch 92 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,413] ERROR Controller 0 epoch 92 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:42:32,413] TRACE Controller 0 epoch 92 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,415] ERROR Controller 0 epoch 92 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:42:32,415] TRACE Controller 0 epoch 92 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,417] ERROR Controller 0 epoch 92 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:42:32,428] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:42:32,428] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:42:32,428] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:42:32,429] TRACE Controller 0 epoch 92 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:42:32,433] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2018-04-21 20:42:32,433] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2018-04-21 20:42:32,433] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 0 (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Controller 0 epoch 92 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 92 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 92 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,434] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 92 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,434] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition [kafka_topic,0] since its associated leader epoch 69 is old. Current leader epoch is 69 (state.change.logger)
[2018-04-21 20:42:32,434] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition [kafka_test,0] since its associated leader epoch 90 is old. Current leader epoch is 90 (state.change.logger)
[2018-04-21 20:42:32,434] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 92 for partition [project_topic,0] since its associated leader epoch 69 is old. Current leader epoch is 69 (state.change.logger)
[2018-04-21 20:42:32,435] TRACE Controller 0 epoch 92 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:42:32,435] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2018-04-21 20:42:32,435] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:90,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2018-04-21 20:42:32,435] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:69,ControllerEpoch:91),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 2 (state.change.logger)
[2018-04-21 20:42:32,435] TRACE Controller 0 epoch 92 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:42:32,436] TRACE Controller 0 epoch 92 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,436] TRACE Controller 0 epoch 92 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:42:32,436] TRACE Controller 0 epoch 92 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,438] TRACE Controller 0 epoch 92 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,438] TRACE Controller 0 epoch 92 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:42:32,438] TRACE Controller 0 epoch 92 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:42:32,440] TRACE Controller 0 epoch 92 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 92 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 92 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 92 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 92 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,441] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:42:32,441] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:42:32,441] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 92 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:42:32,441] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 92 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:42:32,442] TRACE Controller 0 epoch 92 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:42:32,443] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2018-04-21 20:42:32,443] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2018-04-21 20:42:32,443] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 92 with correlation id 4 (state.change.logger)
[2018-04-21 20:42:32,443] TRACE Controller 0 epoch 92 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:46:25,401] TRACE Controller 0 epoch 93 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,402] ERROR Controller 0 epoch 93 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:46:25,403] TRACE Controller 0 epoch 93 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,404] ERROR Controller 0 epoch 93 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:46:25,405] TRACE Controller 0 epoch 93 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,406] ERROR Controller 0 epoch 93 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:46:25,418] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:46:25,418] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:46:25,418] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Controller 0 epoch 93 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,423] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 0 (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Controller 0 epoch 93 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 93 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 93 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 93 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,424] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition [kafka_topic,0] since its associated leader epoch 70 is old. Current leader epoch is 70 (state.change.logger)
[2018-04-21 20:46:25,424] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition [kafka_test,0] since its associated leader epoch 91 is old. Current leader epoch is 91 (state.change.logger)
[2018-04-21 20:46:25,424] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 93 for partition [project_topic,0] since its associated leader epoch 70 is old. Current leader epoch is 70 (state.change.logger)
[2018-04-21 20:46:25,424] TRACE Controller 0 epoch 93 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:91,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:70,ControllerEpoch:92),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 2 (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Controller 0 epoch 93 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Controller 0 epoch 93 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:46:25,425] TRACE Controller 0 epoch 93 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:46:25,426] TRACE Controller 0 epoch 93 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,427] TRACE Controller 0 epoch 93 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,427] TRACE Controller 0 epoch 93 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:46:25,427] TRACE Controller 0 epoch 93 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:46:25,429] TRACE Controller 0 epoch 93 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 93 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 93 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 93 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 93 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,430] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:46:25,430] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:46:25,430] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 93 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 93 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Controller 0 epoch 93 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:46:25,430] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2018-04-21 20:46:25,431] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2018-04-21 20:46:25,431] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 93 with correlation id 4 (state.change.logger)
[2018-04-21 20:46:25,431] TRACE Controller 0 epoch 93 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:50:02,552] TRACE Controller 0 epoch 94 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,553] ERROR Controller 0 epoch 94 initiated state change for partition [kafka_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:50:02,554] TRACE Controller 0 epoch 94 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,555] ERROR Controller 0 epoch 94 initiated state change for partition [kafka_test,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [kafka_test,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:50:02,556] TRACE Controller 0 epoch 94 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,557] ERROR Controller 0 epoch 94 initiated state change for partition [project_topic,0] from OfflinePartition to OnlinePartition failed (state.change.logger)
kafka.common.NoReplicaOnlineException: No replica for partition [project_topic,0] is alive. Live brokers are: [Set()], Assigned replicas are: [List(0)]
	at kafka.controller.OfflinePartitionLeaderSelector.selectLeader(PartitionLeaderSelector.scala:75)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:345)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:205)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:120)
	at kafka.controller.PartitionStateMachine$$anonfun$triggerOnlinePartitionStateChange$3.apply(PartitionStateMachine.scala:117)
	at scala.collection.TraversableLike$WithFilter$$anonfun$foreach$1.apply(TraversableLike.scala:778)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashMap$$anonfun$foreach$1.apply(HashMap.scala:99)
	at scala.collection.mutable.HashTable$class.foreachEntry(HashTable.scala:230)
	at scala.collection.mutable.HashMap.foreachEntry(HashMap.scala:40)
	at scala.collection.mutable.HashMap.foreach(HashMap.scala:99)
	at scala.collection.TraversableLike$WithFilter.foreach(TraversableLike.scala:777)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:117)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:70)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:332)
	at kafka.controller.KafkaController$$anonfun$1.apply$mcV$sp(KafkaController.scala:163)
	at kafka.server.ZookeeperLeaderElector.elect(ZookeeperLeaderElector.scala:84)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply$mcZ$sp(KafkaController.scala:1172)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.controller.KafkaController$SessionExpirationListener$$anonfun$handleNewSession$1.apply(KafkaController.scala:1170)
	at kafka.utils.CoreUtils$.inLock(CoreUtils.scala:262)
	at kafka.controller.KafkaController$SessionExpirationListener.handleNewSession(KafkaController.scala:1170)
	at org.I0Itec.zkclient.ZkClient$6.run(ZkClient.java:734)
	at org.I0Itec.zkclient.ZkEventThread.run(ZkEventThread.java:71)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 changed state of replica 0 for partition [kafka_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 changed state of replica 0 for partition [kafka_test,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 changed state of replica 0 for partition [project_topic,0] from ReplicaDeletionIneligible to OnlineReplica (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,569] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,574] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:50:02,574] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:50:02,574] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:50:02,574] TRACE Controller 0 epoch 94 started leader election for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 0 (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Controller 0 epoch 94 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 94 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 94 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,575] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) correlation id 1 from controller 0 epoch 94 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,575] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition [kafka_topic,0] since its associated leader epoch 71 is old. Current leader epoch is 71 (state.change.logger)
[2018-04-21 20:50:02,575] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition [kafka_test,0] since its associated leader epoch 92 is old. Current leader epoch is 92 (state.change.logger)
[2018-04-21 20:50:02,575] WARN Broker 0 ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 94 for partition [project_topic,0] since its associated leader epoch 71 is old. Current leader epoch is 71 (state.change.logger)
[2018-04-21 20:50:02,576] TRACE Controller 0 epoch 94 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=13},{topic=kafka_test,partition=0,error_code=13},{topic=project_topic,partition=0,error_code=13}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:50:02,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2018-04-21 20:50:02,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:92,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2018-04-21 20:50:02,576] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:71,ControllerEpoch:93),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 2 (state.change.logger)
[2018-04-21 20:50:02,576] TRACE Controller 0 epoch 94 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:50:02,578] TRACE Controller 0 epoch 94 elected leader 0 for Offline partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,578] TRACE Controller 0 epoch 94 changed partition [kafka_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:50:02,578] TRACE Controller 0 epoch 94 started leader election for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,581] TRACE Controller 0 epoch 94 elected leader 0 for Offline partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,582] TRACE Controller 0 epoch 94 changed partition [kafka_test,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:50:02,582] TRACE Controller 0 epoch 94 started leader election for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,584] TRACE Controller 0 epoch 94 elected leader 0 for Offline partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,584] TRACE Controller 0 epoch 94 changed partition [project_topic,0] from OfflinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-04-21 20:50:02,584] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94) to broker 0 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,584] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94) to broker 0 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,584] TRACE Controller 0 epoch 94 sending become-leader LeaderAndIsr request (Leader:0,ISR:0,LeaderEpoch:93,ControllerEpoch:94) to broker 0 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94) to broker 0 for partition kafka_topic-0 (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94) to broker 0 for partition project_topic-0 (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Controller 0 epoch 94 sending UpdateMetadata request (Leader:0,ISR:0,LeaderEpoch:93,ControllerEpoch:94) to broker 0 for partition kafka_test-0 (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 94 for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:93,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 94 for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 received LeaderAndIsr request (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) correlation id 3 from controller 0 epoch 94 for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 handling LeaderAndIsr request correlationId 3 from controller 0 epoch 94 starting the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,585] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition [kafka_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:50:02,585] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition [project_topic,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:50:02,585] INFO Broker 0 skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 0 epoch 94 for partition [kafka_test,0] since it is already the leader for the partition. (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition [kafka_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition [project_topic,0] (state.change.logger)
[2018-04-21 20:50:02,585] TRACE Broker 0 completed LeaderAndIsr request correlationId 3 from controller 0 epoch 94 for the become-leader transition for partition [kafka_test,0] (state.change.logger)
[2018-04-21 20:50:02,586] TRACE Controller 0 epoch 94 received response {error_code=0,partitions=[{topic=kafka_topic,partition=0,error_code=0},{topic=kafka_test,partition=0,error_code=0},{topic=project_topic,partition=0,error_code=0}]} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
[2018-04-21 20:50:02,586] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) for partition [kafka_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2018-04-21 20:50:02,586] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:93,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) for partition [kafka_test,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2018-04-21 20:50:02,586] TRACE Broker 0 cached leader info (LeaderAndIsrInfo:(Leader:0,ISR:0,LeaderEpoch:72,ControllerEpoch:94),ReplicationFactor:1),AllReplicas:0) for partition [project_topic,0] in response to UpdateMetadata request sent by controller 0 epoch 94 with correlation id 4 (state.change.logger)
[2018-04-21 20:50:02,586] TRACE Controller 0 epoch 94 received response {error_code=0} for a request sent to broker Node(0, ubuntu, 9092) (state.change.logger)
