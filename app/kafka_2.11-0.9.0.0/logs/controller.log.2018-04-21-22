[2018-04-21 22:00:48,388] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:00:48,390] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:00:48,390] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:00:48,393] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:48,393] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:00:48,403] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:00:48,404] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:00:48,404] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:00:48,407] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:00:48,415] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:00:48,418] INFO [Controller 0]: Initialized controller epoch to 99 and zk version 98 (kafka.controller.KafkaController)
[2018-04-21 22:00:48,419] INFO [Controller 0]: Controller 0 incremented epoch to 100 (kafka.controller.KafkaController)
[2018-04-21 22:00:48,419] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:00:48,746] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:00:48,746] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:00:48,746] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:00:48,747] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:00:48,747] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:00:48,748] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:00:48,749] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:00:48,853] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:48,926] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,025] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,034] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:49,037] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 100 (kafka.controller.KafkaController)
[2018-04-21 22:00:49,037] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:00:49,037] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:49,038] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:00:49,047] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:00:49,048] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:00:49,170] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:00:49,170] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:00:49,179] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:00:49,179] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:00:49,183] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:00:49,186] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:00:49,263] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,263] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":78,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,271] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:98,ControllerEpoch:99), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:49,309] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,310] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":99,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,311] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:77,ControllerEpoch:99)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:49,382] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,383] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":78,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:00:49,385] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:00:49,409] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:00:49,410] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:00:49,448] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:00:49,505] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:00:54,038] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:00:54,039] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:00:54,039] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:00:54,039] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,275] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:01:50,275] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,275] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:01:50,276] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:50,276] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:01:50,280] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:01:50,280] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:01:50,280] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:01:50,280] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:01:50,287] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:01:50,287] INFO [Controller 0]: Initialized controller epoch to 100 and zk version 99 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,288] INFO [Controller 0]: Controller 0 incremented epoch to 101 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,288] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:01:50,509] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:01:50,509] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:01:50,509] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:01:50,512] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:01:50,513] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:01:50,513] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:01:50,516] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:01:50,516] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:01:50,516] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:01:50,516] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:01:50,516] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:01:50,517] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:01:50,606] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:50,687] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:50,788] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:50,795] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:50,797] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 101 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,797] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:01:50,799] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:50,801] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:01:50,812] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:01:50,814] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:01:50,974] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:01:50,974] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:01:50,995] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:01:50,996] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:01:50,999] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:01:50,999] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:01:51,062] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,063] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":79,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,066] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:99,ControllerEpoch:100), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:51,113] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,114] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":100,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,121] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:78,ControllerEpoch:100)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:51,189] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,189] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":79,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:01:51,192] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:01:51,216] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:01:51,217] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:01:51,266] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:01:51,309] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:01:51,341] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:01:51,375] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:01:51,470] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:01:55,801] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:01:55,806] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:01:55,806] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:01:55,806] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:03:34,436] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:03:34,440] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:03:34,440] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:03:34,448] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:34,448] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:03:34,464] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:03:34,468] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:03:34,471] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:03:34,472] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:03:34,486] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:03:34,491] INFO [Controller 0]: Initialized controller epoch to 101 and zk version 100 (kafka.controller.KafkaController)
[2018-04-21 22:03:34,493] INFO [Controller 0]: Controller 0 incremented epoch to 102 (kafka.controller.KafkaController)
[2018-04-21 22:03:34,497] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:03:35,003] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:03:35,004] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:03:35,004] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:03:35,008] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:03:35,011] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:03:35,011] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:03:35,012] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:03:35,015] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:03:35,015] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:03:35,015] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:03:35,018] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:03:35,020] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:03:35,190] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:35,351] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:35,495] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:35,514] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:35,518] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 102 (kafka.controller.KafkaController)
[2018-04-21 22:03:35,518] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:03:35,518] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:35,521] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:03:35,538] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:03:35,541] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:03:35,805] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:03:35,806] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:03:35,827] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:03:35,828] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:03:35,838] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:03:35,845] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:03:35,941] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:35,941] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":80,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:35,948] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:100,ControllerEpoch:101), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:36,107] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:36,107] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":101,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:36,116] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:79,ControllerEpoch:101)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:36,221] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:36,225] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":80,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:03:36,234] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:03:36,263] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:03:36,264] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:03:36,337] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:03:36,387] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:03:36,438] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:03:36,479] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:03:36,570] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:03:40,523] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:03:40,529] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:03:40,529] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:03:40,530] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,170] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:04:49,172] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,172] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:04:49,173] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:49,173] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:04:49,180] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:04:49,182] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:04:49,182] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:04:49,185] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:04:49,187] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:04:49,190] INFO [Controller 0]: Initialized controller epoch to 102 and zk version 101 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,191] INFO [Controller 0]: Controller 0 incremented epoch to 103 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,194] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:04:49,439] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:04:49,439] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:04:49,439] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:04:49,439] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:04:49,439] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:04:49,440] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:04:49,441] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:04:49,441] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:04:49,441] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:04:49,442] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:04:49,442] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:04:49,444] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:04:49,506] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:49,615] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:49,706] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:49,710] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:49,711] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 103 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,711] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:04:49,711] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:49,713] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:04:49,718] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:04:49,720] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:04:49,921] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:04:49,921] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:04:49,938] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:04:49,938] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:04:49,941] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:04:49,942] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:04:50,016] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,016] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":81,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,022] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:101,ControllerEpoch:102), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:50,087] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,088] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":102,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,092] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:80,ControllerEpoch:102)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:50,156] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,159] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":81,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:04:50,162] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:04:50,170] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:04:50,170] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:04:50,223] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:04:50,251] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:04:50,290] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:04:50,329] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:04:50,400] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:04:54,716] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:04:54,723] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:04:54,723] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:04:54,724] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:07:01,465] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:07:01,465] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:07:01,466] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:07:01,467] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:01,467] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:07:01,474] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:07:01,474] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:07:01,475] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:07:01,475] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:07:01,492] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:07:01,493] INFO [Controller 0]: Initialized controller epoch to 103 and zk version 102 (kafka.controller.KafkaController)
[2018-04-21 22:07:01,493] INFO [Controller 0]: Controller 0 incremented epoch to 104 (kafka.controller.KafkaController)
[2018-04-21 22:07:01,493] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:07:01,697] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:07:01,697] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:07:01,698] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:07:01,698] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:07:01,698] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:07:01,699] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:07:01,699] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:07:01,699] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:07:01,700] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:07:01,700] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:07:01,700] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:07:01,700] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:07:01,780] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:01,865] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:01,958] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:01,974] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:01,977] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 104 (kafka.controller.KafkaController)
[2018-04-21 22:07:01,979] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:07:01,979] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:01,980] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:07:01,985] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:07:01,988] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:07:02,138] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:07:02,141] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:07:02,163] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:07:02,163] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:07:02,165] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:07:02,168] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:07:02,213] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,214] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":82,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,216] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:102,ControllerEpoch:103), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:02,283] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,283] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":103,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,288] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:81,ControllerEpoch:103)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:02,334] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,336] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":82,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:07:02,338] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:07:02,355] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:07:02,356] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:07:02,408] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:07:02,431] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:07:02,460] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:07:02,498] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:07:02,557] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:07:06,982] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:07:06,992] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:07:06,992] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:07:06,992] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:11:40,662] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:11:40,662] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:11:40,662] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:11:40,669] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:40,673] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:11:40,689] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:11:40,690] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:11:40,690] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:11:40,690] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:11:40,705] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:11:40,707] INFO [Controller 0]: Initialized controller epoch to 104 and zk version 103 (kafka.controller.KafkaController)
[2018-04-21 22:11:40,712] INFO [Controller 0]: Controller 0 incremented epoch to 105 (kafka.controller.KafkaController)
[2018-04-21 22:11:40,713] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:11:41,209] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:11:41,209] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:11:41,209] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:11:41,214] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:11:41,214] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:11:41,214] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:11:41,216] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:11:41,216] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:11:41,216] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:11:41,216] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:11:41,216] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:11:41,218] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:11:41,326] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:41,473] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:41,642] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:41,653] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:41,665] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 105 (kafka.controller.KafkaController)
[2018-04-21 22:11:41,666] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:11:41,666] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:41,670] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:11:41,687] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:11:41,693] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:11:41,962] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:11:41,965] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:11:41,983] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:11:41,984] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:11:41,995] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:11:41,996] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:11:42,164] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,169] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":83,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,177] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:103,ControllerEpoch:104), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:42,254] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,256] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":104,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,263] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:82,ControllerEpoch:104)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:42,355] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,355] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":83,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:11:42,364] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:11:42,407] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:11:42,414] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:11:42,493] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:11:42,561] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:11:42,616] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:11:42,689] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:11:42,780] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:11:46,673] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:11:46,679] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:11:46,679] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:11:46,679] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,141] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:12:46,143] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,143] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:12:46,145] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:46,145] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:12:46,155] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:12:46,155] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:12:46,155] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:12:46,155] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:12:46,162] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:12:46,165] INFO [Controller 0]: Initialized controller epoch to 105 and zk version 104 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,166] INFO [Controller 0]: Controller 0 incremented epoch to 106 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,166] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:12:46,398] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:12:46,398] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:12:46,400] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:12:46,403] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:12:46,403] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:12:46,403] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:12:46,404] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:12:46,404] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:12:46,404] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:12:46,405] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:12:46,406] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:12:46,410] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:12:46,486] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,560] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,649] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,653] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:46,659] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 106 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,659] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:12:46,659] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:46,661] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:12:46,669] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:12:46,670] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:12:46,824] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:12:46,825] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:12:46,839] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:12:46,840] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:12:46,842] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:12:46,849] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:12:46,911] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,912] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":84,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,917] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:104,ControllerEpoch:105), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:46,992] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,994] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":105,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:46,996] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:83,ControllerEpoch:105)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:47,048] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:47,048] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":84,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:12:47,050] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:12:47,068] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:12:47,071] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:12:47,116] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:12:47,180] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:12:51,662] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:12:51,671] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:12:51,671] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:12:51,672] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:17:26,365] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:17:26,365] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:17:26,367] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:17:26,367] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:26,372] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:17:26,379] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:17:26,380] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:17:26,381] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:17:26,381] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:17:26,384] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:17:26,385] INFO [Controller 0]: Initialized controller epoch to 106 and zk version 105 (kafka.controller.KafkaController)
[2018-04-21 22:17:26,385] INFO [Controller 0]: Controller 0 incremented epoch to 107 (kafka.controller.KafkaController)
[2018-04-21 22:17:26,386] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:17:26,658] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:17:26,658] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:17:26,658] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:17:26,659] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:17:26,659] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:17:26,659] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:17:26,660] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:17:26,660] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:17:26,660] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:17:26,661] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:17:26,661] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:17:26,664] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:17:26,717] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:26,869] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,048] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,062] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:27,067] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 107 (kafka.controller.KafkaController)
[2018-04-21 22:17:27,067] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:17:27,067] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:27,071] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:17:27,086] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:17:27,089] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:17:27,370] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:17:27,371] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:17:27,445] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:17:27,451] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:17:27,451] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:17:27,457] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,457] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":85,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,470] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:17:27,473] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:105,ControllerEpoch:106), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:27,480] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,480] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":106,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,483] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:84,ControllerEpoch:106)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:27,487] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,487] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":85,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:17:27,490] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:17:27,499] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:17:27,499] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:17:27,506] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:17:27,512] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:17:27,516] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:17:27,519] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:17:27,524] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:17:32,073] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:17:32,073] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:17:32,073] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:17:32,073] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,830] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:19:51,830] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,830] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:19:51,833] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:51,835] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:19:51,842] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:19:51,842] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:19:51,842] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:19:51,842] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:19:51,859] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:19:51,862] INFO [Controller 0]: Initialized controller epoch to 107 and zk version 106 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,867] INFO [Controller 0]: Controller 0 incremented epoch to 108 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,868] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:19:51,923] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:19:51,923] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:19:51,923] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:19:51,925] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:19:51,926] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:19:51,926] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:19:51,927] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:19:51,927] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:19:51,928] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:19:51,928] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:19:51,928] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:19:51,928] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:19:51,936] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:51,945] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:51,954] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:51,959] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:51,962] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 108 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,963] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:19:51,963] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:51,965] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:19:51,977] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:19:51,979] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:19:51,991] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:19:51,991] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:19:51,994] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:19:51,999] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:19:52,000] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:19:52,003] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:19:52,009] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,010] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":86,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,015] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:106,ControllerEpoch:107), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:52,023] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,023] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":107,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,027] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:85,ControllerEpoch:107)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:52,033] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,033] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":86,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:19:52,038] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:19:52,048] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:19:52,048] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:19:52,057] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:19:52,061] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:19:52,066] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:19:52,071] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:19:52,078] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:19:56,966] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:19:56,967] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:19:56,967] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:19:56,967] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,232] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-21 22:20:59,232] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,232] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:20:59,234] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,234] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:20:59,235] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-21 22:20:59,236] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-21 22:20:59,236] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-21 22:20:59,236] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-21 22:20:59,249] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-21 22:20:59,250] INFO [Controller 0]: Initialized controller epoch to 108 and zk version 107 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,253] INFO [Controller 0]: Controller 0 incremented epoch to 109 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,254] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-21 22:20:59,263] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-21 22:20:59,264] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:20:59,266] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,269] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,271] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,271] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,273] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 109 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,273] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-21 22:20:59,273] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,274] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-21 22:20:59,277] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-21 22:20:59,278] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:20:59,281] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:20:59,281] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-21 22:20:59,282] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-21 22:20:59,282] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-21 22:20:59,284] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,284] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":87,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,285] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:107,ControllerEpoch:108), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,285] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-21 22:20:59,286] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,286] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":108,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,287] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:86,ControllerEpoch:108)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,288] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,288] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":87,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-21 22:20:59,288] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-21 22:20:59,290] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:108,ControllerEpoch:109), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:87,ControllerEpoch:109)) (kafka.controller.PartitionStateMachine)
[2018-04-21 22:20:59,292] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:20:59,292] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-21 22:20:59,296] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:20:59,297] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:20:59,299] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-21 22:20:59,300] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:20:59,302] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-21 22:21:04,275] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-21 22:21:04,276] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-21 22:21:04,276] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-21 22:21:04,276] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
