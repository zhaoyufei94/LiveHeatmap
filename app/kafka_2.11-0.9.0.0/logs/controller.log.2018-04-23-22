[2018-04-23 22:05:17,583] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:05:17,595] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:05:17,595] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:05:17,595] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:08:22,484] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:08:22,487] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:08:22,487] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:08:22,488] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:22,489] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:08:22,495] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:08:22,496] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:08:22,500] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:08:22,500] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:08:22,505] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:08:22,508] INFO [Controller 0]: Initialized controller epoch to 179 and zk version 178 (kafka.controller.KafkaController)
[2018-04-23 22:08:22,508] INFO [Controller 0]: Controller 0 incremented epoch to 180 (kafka.controller.KafkaController)
[2018-04-23 22:08:22,511] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:08:22,754] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:08:22,754] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:08:22,754] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:08:22,755] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:08:22,755] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:08:22,755] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:08:22,755] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:08:22,756] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:08:22,756] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:08:22,756] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:08:22,757] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:08:22,758] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:08:22,822] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:22,931] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,021] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,030] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:23,034] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 180 (kafka.controller.KafkaController)
[2018-04-23 22:08:23,035] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:08:23,036] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:23,038] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:08:23,065] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:08:23,072] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:08:23,234] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:08:23,234] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:08:23,243] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:08:23,249] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:08:23,252] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:08:23,253] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:08:23,330] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,331] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":158,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,337] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:178,ControllerEpoch:179), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:23,403] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,403] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":179,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,408] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:157,ControllerEpoch:179)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:23,451] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,451] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":158,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:08:23,455] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:08:23,465] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:08:23,468] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:08:23,525] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:08:23,552] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:08:23,584] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:08:23,619] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:08:23,672] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:08:28,040] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:08:28,040] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:08:28,047] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:08:28,048] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,055] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:09:25,055] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,055] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:09:25,062] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,062] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:09:25,078] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:09:25,078] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:09:25,079] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:09:25,080] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:09:25,084] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:09:25,087] INFO [Controller 0]: Initialized controller epoch to 180 and zk version 179 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,089] INFO [Controller 0]: Controller 0 incremented epoch to 181 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,089] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:09:25,361] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:09:25,361] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:09:25,362] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:09:25,365] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:09:25,365] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:09:25,365] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:09:25,365] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:09:25,367] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:09:25,368] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:09:25,368] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:09:25,368] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:09:25,369] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:09:25,470] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,531] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,577] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,584] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,587] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 181 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,587] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:09:25,587] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,589] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:09:25,605] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:09:25,607] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:09:25,748] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:09:25,748] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:09:25,756] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:09:25,758] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:09:25,761] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:09:25,762] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:09:25,821] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,822] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":159,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,825] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:179,ControllerEpoch:180), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,863] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,864] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":180,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,866] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:158,ControllerEpoch:180)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,925] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,926] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":159,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:09:25,928] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:09:25,943] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:09:25,944] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:09:25,981] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:09:26,012] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:09:26,063] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:09:26,105] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:09:26,165] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:09:30,591] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:09:30,599] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:09:30,601] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:09:30,603] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:12:08,858] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:12:08,858] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:12:08,858] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:12:08,861] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:08,861] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:12:08,871] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:12:08,871] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:12:08,871] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:12:08,872] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:12:08,877] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:12:08,878] INFO [Controller 0]: Initialized controller epoch to 181 and zk version 180 (kafka.controller.KafkaController)
[2018-04-23 22:12:08,881] INFO [Controller 0]: Controller 0 incremented epoch to 182 (kafka.controller.KafkaController)
[2018-04-23 22:12:08,882] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:12:09,065] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:12:09,065] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:12:09,065] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:12:09,065] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:12:09,066] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:12:09,067] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:12:09,067] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:12:09,118] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,219] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,260] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,267] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:09,269] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 182 (kafka.controller.KafkaController)
[2018-04-23 22:12:09,269] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:12:09,269] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:09,270] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:12:09,276] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:12:09,278] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:12:09,407] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:12:09,407] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:12:09,411] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:12:09,417] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:12:09,418] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:12:09,423] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:12:09,476] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,478] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":160,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,481] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:180,ControllerEpoch:181), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:09,517] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,517] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":181,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,523] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:159,ControllerEpoch:181)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:09,556] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,556] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":160,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:12:09,559] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:12:09,576] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:12:09,578] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:12:09,623] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:12:09,657] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:12:09,697] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:12:09,737] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:12:09,841] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:12:14,271] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:12:14,274] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:12:14,274] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:12:14,274] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:13:17,625] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:13:17,625] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:13:17,626] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:13:17,627] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:17,632] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:17,637] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:13:17,637] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:13:17,637] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:13:17,638] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:13:17,641] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:13:17,642] INFO [Controller 0]: Initialized controller epoch to 182 and zk version 181 (kafka.controller.KafkaController)
[2018-04-23 22:13:17,643] INFO [Controller 0]: Controller 0 incremented epoch to 183 (kafka.controller.KafkaController)
[2018-04-23 22:13:17,643] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:13:17,813] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:13:17,813] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:13:17,813] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:13:17,813] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:13:17,814] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:13:17,814] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:13:17,814] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:13:17,814] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:13:17,815] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:13:17,815] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:13:17,815] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:13:17,815] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:17,876] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:17,930] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,010] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,016] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:18,021] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 183 (kafka.controller.KafkaController)
[2018-04-23 22:13:18,021] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:13:18,021] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:18,022] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:13:18,029] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:13:18,029] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:18,133] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:18,133] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:13:18,140] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:13:18,144] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:13:18,146] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:18,148] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:13:18,228] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,228] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":161,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,231] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:181,ControllerEpoch:182), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:18,303] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,304] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":182,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,307] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:160,ControllerEpoch:182)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:18,339] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,339] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":161,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:18,341] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:18,351] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:13:18,352] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:13:18,388] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:18,486] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:23,023] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:13:23,032] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:13:23,032] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:13:23,032] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:13:54,383] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:13:54,383] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:13:54,383] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:13:54,383] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:54,383] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:54,423] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:13:54,423] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:13:54,423] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:13:54,423] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:13:54,426] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:13:54,428] INFO [Controller 0]: Initialized controller epoch to 183 and zk version 182 (kafka.controller.KafkaController)
[2018-04-23 22:13:54,431] INFO [Controller 0]: Controller 0 incremented epoch to 184 (kafka.controller.KafkaController)
[2018-04-23 22:13:54,431] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:13:54,909] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:13:54,909] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:13:54,909] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:13:54,914] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:13:54,914] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:13:54,914] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:13:54,919] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:13:54,919] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:13:54,922] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:13:54,922] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:13:54,922] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:13:54,927] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:55,066] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:55,262] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:55,382] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:55,397] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:55,401] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 184 (kafka.controller.KafkaController)
[2018-04-23 22:13:55,402] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:13:55,402] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:55,405] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:13:55,424] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:13:55,520] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:55,815] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:13:55,815] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:13:55,826] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:13:55,831] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:13:55,833] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:13:55,833] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:13:55,975] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:55,976] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":162,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:55,981] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:182,ControllerEpoch:183), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:56,093] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:56,093] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":183,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:56,108] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:161,ControllerEpoch:183)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:13:56,175] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:56,175] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":162,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:13:56,179] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:14:00,406] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:14:00,416] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:14:00,416] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:14:00,417] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,208] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:15:52,208] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,208] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:15:52,211] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:52,211] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:15:52,222] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:15:52,222] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:15:52,222] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:15:52,222] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:15:52,229] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:15:52,229] INFO [Controller 0]: Initialized controller epoch to 184 and zk version 183 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,230] INFO [Controller 0]: Controller 0 incremented epoch to 185 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,232] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:15:52,485] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:15:52,485] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:15:52,486] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:15:52,487] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:15:52,489] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:15:52,489] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:15:52,491] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:15:52,491] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:15:52,493] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:15:52,493] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:15:52,494] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:15:52,496] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:15:52,584] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:52,673] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:52,729] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:52,736] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:52,737] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 185 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,737] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:15:52,737] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:52,739] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:15:52,746] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:15:52,746] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:15:52,884] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:15:52,884] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:15:52,900] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:15:52,900] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:15:52,905] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:15:52,907] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:15:52,975] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:52,976] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":163,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:52,979] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:183,ControllerEpoch:184), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:53,047] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:53,047] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":184,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:53,050] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:162,ControllerEpoch:184)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:53,124] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:53,126] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":163,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:15:53,132] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:15:53,158] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:15:53,162] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:15:53,246] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:15:53,326] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:15:53,407] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:15:53,496] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:15:53,633] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:15:57,740] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:15:57,748] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:15:57,748] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:15:57,749] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:16:58,887] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:16:58,887] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:16:58,887] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:16:58,895] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:16:58,895] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:16:58,905] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:16:58,906] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:16:58,906] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:16:58,909] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:16:58,920] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:16:58,923] INFO [Controller 0]: Initialized controller epoch to 185 and zk version 184 (kafka.controller.KafkaController)
[2018-04-23 22:16:58,926] INFO [Controller 0]: Controller 0 incremented epoch to 186 (kafka.controller.KafkaController)
[2018-04-23 22:16:58,928] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:16:59,439] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:16:59,440] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:16:59,440] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:16:59,444] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:16:59,444] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:16:59,444] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:16:59,446] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:16:59,446] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:16:59,446] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:16:59,446] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:16:59,446] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:16:59,448] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:16:59,619] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:16:59,794] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:16:59,989] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,005] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:17:00,011] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 186 (kafka.controller.KafkaController)
[2018-04-23 22:17:00,013] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:17:00,013] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:17:00,019] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:17:00,047] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:17:00,402] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:17:00,402] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:17:00,425] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:17:00,432] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:17:00,438] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:17:00,441] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:17:00,592] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,593] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":164,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,599] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:184,ControllerEpoch:185), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:17:00,709] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,709] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":185,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,715] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:163,ControllerEpoch:185)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:17:00,817] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,817] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":164,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:17:00,832] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:17:00,969] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:17:01,130] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:17:05,019] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:17:05,020] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:17:05,022] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:17:05,022] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:18:04,262] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:18:04,262] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:18:04,262] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:18:04,263] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:04,267] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:18:04,280] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:18:04,280] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:18:04,281] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:18:04,281] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:18:04,285] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:18:04,289] INFO [Controller 0]: Initialized controller epoch to 186 and zk version 185 (kafka.controller.KafkaController)
[2018-04-23 22:18:04,291] INFO [Controller 0]: Controller 0 incremented epoch to 187 (kafka.controller.KafkaController)
[2018-04-23 22:18:04,292] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:18:04,607] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:18:04,607] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:18:04,607] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:18:04,608] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:18:04,608] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:18:04,608] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:18:04,610] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:18:04,610] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:18:04,614] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:18:04,615] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:18:04,616] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:18:04,617] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:18:04,686] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:04,798] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:04,866] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:04,880] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:04,881] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 187 (kafka.controller.KafkaController)
[2018-04-23 22:18:04,881] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:18:04,881] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:04,884] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:18:04,889] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:18:04,891] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:18:05,032] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:18:05,033] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:18:05,039] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:18:05,039] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:18:05,043] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:18:05,045] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:18:05,121] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,121] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":165,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,125] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:185,ControllerEpoch:186), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:05,181] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,181] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":186,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,182] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:164,ControllerEpoch:186)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:05,235] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,235] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":165,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:18:05,237] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:18:05,253] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:18:05,255] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:18:05,303] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:18:05,335] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:18:05,435] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:18:09,885] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:18:09,886] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:18:09,886] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:18:09,886] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:19:12,678] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:19:12,679] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:19:12,679] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:19:12,685] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:12,685] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:12,698] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:19:12,698] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:19:12,698] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:19:12,698] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:19:12,703] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:19:12,704] INFO [Controller 0]: Initialized controller epoch to 187 and zk version 186 (kafka.controller.KafkaController)
[2018-04-23 22:19:12,705] INFO [Controller 0]: Controller 0 incremented epoch to 188 (kafka.controller.KafkaController)
[2018-04-23 22:19:12,705] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:19:13,055] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:19:13,055] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:19:13,055] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:19:13,055] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:13,055] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:19:13,056] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:13,059] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:19:13,059] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:19:13,060] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:19:13,060] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:19:13,060] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:19:13,063] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:13,157] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,287] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,408] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,420] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:13,424] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 188 (kafka.controller.KafkaController)
[2018-04-23 22:19:13,424] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:19:13,424] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:13,425] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:19:13,435] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:19:13,437] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:13,661] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:13,661] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:19:13,679] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:19:13,690] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:19:13,693] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:19:13,693] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:13,802] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,802] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":166,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,808] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:186,ControllerEpoch:187), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:13,894] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,895] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":187,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,904] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:165,ControllerEpoch:187)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:13,981] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,982] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":166,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:13,986] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:14,009] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:19:14,013] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:19:14,087] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:14,128] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:14,176] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:14,222] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:14,351] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:18,426] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:19:18,436] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:19:18,436] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:18,438] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,388] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:19:50,390] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,390] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:19:50,395] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:50,395] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:50,402] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:19:50,403] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:19:50,404] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:19:50,404] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:19:50,410] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:19:50,412] INFO [Controller 0]: Initialized controller epoch to 188 and zk version 187 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,413] INFO [Controller 0]: Controller 0 incremented epoch to 189 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,413] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:19:50,603] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:19:50,603] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:19:50,604] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:19:50,604] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:50,604] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:19:50,605] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:50,606] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:19:50,606] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:19:50,607] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:19:50,608] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:19:50,608] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:19:50,609] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:50,642] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:50,712] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:50,772] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:50,775] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:50,778] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 189 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,778] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:19:50,779] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:50,780] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:19:50,788] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:50,903] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:50,903] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:19:50,916] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:19:50,919] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:19:50,924] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:19:50,928] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:19:50,994] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:50,995] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":167,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:50,997] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:187,ControllerEpoch:188), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:51,044] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:51,045] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":188,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:51,049] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:166,ControllerEpoch:188)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:51,093] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:51,094] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":167,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:19:51,096] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:19:51,120] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:19:51,122] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:19:51,162] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:51,187] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:51,207] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:19:51,229] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:51,315] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:19:55,781] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:19:55,782] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:19:55,790] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:19:55,790] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:21:01,270] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:21:01,271] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:21:01,271] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:21:01,280] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:01,283] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:21:01,293] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:21:01,294] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:21:01,296] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:21:01,296] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:21:01,314] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:21:01,319] INFO [Controller 0]: Initialized controller epoch to 189 and zk version 188 (kafka.controller.KafkaController)
[2018-04-23 22:21:01,322] INFO [Controller 0]: Controller 0 incremented epoch to 190 (kafka.controller.KafkaController)
[2018-04-23 22:21:01,324] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:21:01,779] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:21:01,779] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:21:01,779] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:21:01,783] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:21:01,783] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:21:01,783] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:21:01,785] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:21:01,786] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:21:01,786] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:21:01,788] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:21:01,788] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:21:01,791] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:21:01,935] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,082] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,255] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,269] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:02,273] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 190 (kafka.controller.KafkaController)
[2018-04-23 22:21:02,274] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:21:02,274] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:02,277] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:21:02,298] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:21:02,310] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:21:02,647] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:21:02,647] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:21:02,671] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:21:02,672] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:21:02,680] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:21:02,683] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:21:02,838] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,838] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":168,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,846] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:188,ControllerEpoch:189), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:02,985] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,985] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":189,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:02,994] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:167,ControllerEpoch:189)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:03,135] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:03,135] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":168,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:21:03,143] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:21:03,179] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:21:03,183] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:21:03,286] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:21:03,364] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:21:03,447] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:21:03,524] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:21:03,717] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:21:07,280] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:21:07,281] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:21:07,288] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:21:07,289] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:22:14,461] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:22:14,461] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:22:14,461] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:22:14,462] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:14,462] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:22:14,473] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:22:14,473] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:22:14,474] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:22:14,474] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:22:14,485] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:22:14,488] INFO [Controller 0]: Initialized controller epoch to 190 and zk version 189 (kafka.controller.KafkaController)
[2018-04-23 22:22:14,489] INFO [Controller 0]: Controller 0 incremented epoch to 191 (kafka.controller.KafkaController)
[2018-04-23 22:22:14,490] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:22:14,824] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:22:14,824] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:22:14,824] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:22:14,825] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:22:14,825] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:22:14,825] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:22:14,826] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:22:14,826] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:22:14,828] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:22:14,828] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:22:14,828] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:22:14,828] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:22:14,949] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,071] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,190] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,199] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:15,203] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 191 (kafka.controller.KafkaController)
[2018-04-23 22:22:15,204] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:22:15,204] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:15,207] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:22:15,219] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:22:15,344] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:22:15,344] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:22:15,358] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:22:15,359] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:22:15,363] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:22:15,363] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:22:15,435] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,437] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":169,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,443] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:189,ControllerEpoch:190), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:15,527] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,528] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":190,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,532] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:168,ControllerEpoch:190)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:15,594] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,594] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":169,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:22:15,598] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:22:15,666] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:22:15,750] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:22:20,210] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:22:20,217] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:22:20,218] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:22:20,218] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:24:05,325] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:24:05,325] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:24:05,325] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:24:05,329] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:05,329] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:05,341] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:24:05,342] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:24:05,343] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:24:05,343] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:24:05,353] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:24:05,359] INFO [Controller 0]: Initialized controller epoch to 191 and zk version 190 (kafka.controller.KafkaController)
[2018-04-23 22:24:05,361] INFO [Controller 0]: Controller 0 incremented epoch to 192 (kafka.controller.KafkaController)
[2018-04-23 22:24:05,363] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:24:05,775] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:24:05,777] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:24:05,777] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:24:05,779] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:05,779] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:24:05,779] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:05,781] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:24:05,781] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:24:05,781] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:24:05,781] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:24:05,781] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:24:05,784] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:05,853] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:05,948] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,054] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,065] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:06,069] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 192 (kafka.controller.KafkaController)
[2018-04-23 22:24:06,069] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:24:06,070] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:06,077] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:24:06,094] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:06,258] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:06,258] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:24:06,269] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:24:06,273] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:24:06,274] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:06,275] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:24:06,352] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,353] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":170,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,357] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:190,ControllerEpoch:191), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:06,405] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,406] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":191,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,413] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:169,ControllerEpoch:191)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:06,457] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,457] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":170,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:06,461] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:06,476] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:24:06,476] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:24:06,538] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:06,599] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:06,641] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:06,682] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:06,798] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:11,083] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:24:11,090] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:24:11,090] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:11,090] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-23 22:24:53,756] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-23 22:24:53,756] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-23 22:24:53,756] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:24:53,756] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:53,757] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:53,765] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-23 22:24:53,765] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-23 22:24:53,767] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-23 22:24:53,767] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-23 22:24:53,774] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-23 22:24:53,775] INFO [Controller 0]: Initialized controller epoch to 192 and zk version 191 (kafka.controller.KafkaController)
[2018-04-23 22:24:53,776] INFO [Controller 0]: Controller 0 incremented epoch to 193 (kafka.controller.KafkaController)
[2018-04-23 22:24:53,776] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-23 22:24:53,981] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:24:53,981] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-23 22:24:53,981] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-23 22:24:53,982] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:53,982] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-23 22:24:53,982] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:53,983] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-23 22:24:53,983] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-23 22:24:53,984] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:24:53,984] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-23 22:24:53,984] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-23 22:24:53,985] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:54,040] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,158] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,235] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,242] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:54,244] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 193 (kafka.controller.KafkaController)
[2018-04-23 22:24:54,244] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-23 22:24:54,244] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:54,245] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-23 22:24:54,253] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-23 22:24:54,254] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:54,341] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:54,341] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-23 22:24:54,350] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-23 22:24:54,352] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-23 22:24:54,353] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-23 22:24:54,355] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-23 22:24:54,405] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,406] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":171,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,409] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:191,ControllerEpoch:192), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:54,462] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,462] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":192,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,468] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:170,ControllerEpoch:192)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:54,519] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,521] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":171,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-23 22:24:54,526] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:192,ControllerEpoch:193), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:171,ControllerEpoch:193)) (kafka.controller.PartitionStateMachine)
[2018-04-23 22:24:54,542] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:24:54,546] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-23 22:24:54,573] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:54,589] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:54,607] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-23 22:24:54,621] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:54,674] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-23 22:24:59,246] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-23 22:24:59,247] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-23 22:24:59,247] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-23 22:24:59,247] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
