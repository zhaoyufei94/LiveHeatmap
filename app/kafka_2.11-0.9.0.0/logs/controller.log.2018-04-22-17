[2018-04-22 17:02:48,562] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:02:48,568] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:02:48,568] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:02:48,568] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,568] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:02:48,570] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:02:48,571] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:02:48,572] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:02:48,572] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:02:48,584] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:02:48,584] INFO [Controller 0]: Initialized controller epoch to 132 and zk version 131 (kafka.controller.KafkaController)
[2018-04-22 17:02:48,585] INFO [Controller 0]: Controller 0 incremented epoch to 133 (kafka.controller.KafkaController)
[2018-04-22 17:02:48,585] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:02:48,592] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:02:48,592] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:02:48,592] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:02:48,593] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:02:48,595] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,604] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,607] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,607] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,608] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 133 (kafka.controller.KafkaController)
[2018-04-22 17:02:48,608] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:02:48,608] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,609] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:02:48,612] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:02:48,612] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:02:48,615] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:02:48,615] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:02:48,615] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:02:48,616] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:02:48,617] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,617] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":111,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,618] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:131,ControllerEpoch:132), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,619] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:02:48,619] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,620] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":132,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,622] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:110,ControllerEpoch:132)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,623] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,623] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":111,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:02:48,623] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:02:48,625] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:02:48,626] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:02:48,626] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:02:48,630] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:02:48,631] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:02:48,632] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:02:48,633] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:02:48,635] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:02:53,610] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:02:53,611] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:02:53,611] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:02:53,611] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,773] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:06:00,773] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,773] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:06:00,775] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,775] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:06:00,776] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:06:00,777] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:06:00,779] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:06:00,779] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:06:00,781] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:06:00,782] INFO [Controller 0]: Initialized controller epoch to 133 and zk version 132 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,783] INFO [Controller 0]: Controller 0 incremented epoch to 134 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,784] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:06:00,793] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:06:00,793] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:06:00,793] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:06:00,794] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:06:00,796] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,798] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,800] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,801] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,802] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 134 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,802] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:06:00,802] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,803] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:06:00,806] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:06:00,807] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:06:00,809] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:06:00,809] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:06:00,816] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:06:00,818] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:06:00,818] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:06:00,819] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:06:00,827] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,827] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":112,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,828] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:132,ControllerEpoch:133), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,830] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,830] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":133,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,831] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:111,ControllerEpoch:133)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,845] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,845] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":112,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:06:00,846] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:06:00,848] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:06:00,849] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:06:00,852] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:06:00,853] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:06:00,854] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:06:00,855] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:06:00,856] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:06:05,805] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:06:05,805] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:06:05,805] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:06:05,805] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,494] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:10:05,494] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,494] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:10:05,499] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,499] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:10:05,501] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:10:05,501] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:10:05,501] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:10:05,501] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:10:05,505] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:10:05,506] INFO [Controller 0]: Initialized controller epoch to 134 and zk version 133 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,506] INFO [Controller 0]: Controller 0 incremented epoch to 135 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,506] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:10:05,512] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:10:05,513] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,515] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,517] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,517] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,517] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 135 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,517] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:10:05,517] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,518] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:10:05,521] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:10:05,521] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:10:05,523] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:10:05,523] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:10:05,524] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:10:05,525] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:10:05,525] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:10:05,526] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:10:05,528] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,528] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":113,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,529] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:133,ControllerEpoch:134), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,531] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,531] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":134,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,531] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:112,ControllerEpoch:134)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,533] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,533] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":113,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:10:05,534] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:10:05,537] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:10:05,537] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:10:05,540] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:10:05,541] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:10:05,543] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:10:05,544] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:10:05,545] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:10:10,519] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:10:10,519] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:10:10,519] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:10:10,519] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,142] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:12:55,142] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,142] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:12:55,145] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,145] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:12:55,148] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:12:55,148] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:12:55,148] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:12:55,148] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:12:55,173] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:12:55,174] INFO [Controller 0]: Initialized controller epoch to 135 and zk version 134 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,176] INFO [Controller 0]: Controller 0 incremented epoch to 136 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,177] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:12:55,197] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:12:55,197] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:12:55,197] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:12:55,198] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:12:55,199] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:12:55,199] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:12:55,200] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:12:55,200] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:12:55,200] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:12:55,200] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:12:55,200] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:12:55,201] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:12:55,207] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,213] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,220] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,221] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,225] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 136 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,225] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:12:55,225] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,228] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:12:55,238] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:12:55,241] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:12:55,251] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:12:55,252] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:12:55,261] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:12:55,263] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:12:55,269] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:12:55,273] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,273] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":114,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,274] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:12:55,276] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:134,ControllerEpoch:135), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,280] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,280] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":135,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,283] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:113,ControllerEpoch:135)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,287] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,287] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":114,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:12:55,290] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:12:55,296] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:12:55,296] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:12:55,305] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:12:55,310] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:12:55,314] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:12:55,319] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:12:55,324] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:13:00,229] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:13:00,229] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:13:00,230] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:13:00,230] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,424] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:17:03,424] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,424] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:17:03,426] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,426] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:17:03,428] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:17:03,428] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:17:03,429] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:17:03,429] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:17:03,431] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:17:03,431] INFO [Controller 0]: Initialized controller epoch to 136 and zk version 135 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,432] INFO [Controller 0]: Controller 0 incremented epoch to 137 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,432] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:17:03,440] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:17:03,440] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:17:03,440] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:17:03,441] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:17:03,443] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,444] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,446] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,446] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,448] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 137 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,448] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:17:03,448] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,449] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:17:03,452] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:17:03,453] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:17:03,455] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:17:03,455] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:17:03,456] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:17:03,457] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:17:03,457] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:17:03,457] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:17:03,459] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,460] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":115,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,461] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:135,ControllerEpoch:136), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,474] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,474] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":136,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,477] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:114,ControllerEpoch:136)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,497] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,497] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":115,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:17:03,506] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:17:03,509] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:17:03,509] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:17:03,512] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:17:03,514] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:17:03,515] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:17:03,517] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:17:03,518] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:17:08,450] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:17:08,450] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:17:08,450] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:17:08,450] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,074] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:24:17,074] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,074] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:24:17,075] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,075] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:24:17,076] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:24:17,076] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:24:17,076] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:24:17,076] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:24:17,079] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:24:17,080] INFO [Controller 0]: Initialized controller epoch to 137 and zk version 136 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,081] INFO [Controller 0]: Controller 0 incremented epoch to 138 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,081] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:24:17,088] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:24:17,088] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:24:17,088] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:24:17,089] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:24:17,096] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,098] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,100] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,100] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,101] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 138 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,101] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:24:17,101] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,103] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:24:17,106] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:24:17,107] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:24:17,109] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:24:17,109] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:24:17,110] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:24:17,114] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:24:17,114] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:24:17,115] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:24:17,117] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,117] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":116,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,118] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:136,ControllerEpoch:137), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,119] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,119] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":137,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,120] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:115,ControllerEpoch:137)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,121] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,121] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":116,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:24:17,121] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:24:17,131] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:24:17,131] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:24:17,135] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:24:17,136] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:24:17,136] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:24:17,137] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:24:17,138] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:24:22,104] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:24:22,104] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:24:22,104] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:24:22,105] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,211] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:27:02,212] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,212] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:27:02,212] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,212] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:27:02,217] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:27:02,217] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:27:02,217] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:27:02,217] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:27:02,220] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:27:02,221] INFO [Controller 0]: Initialized controller epoch to 138 and zk version 137 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,221] INFO [Controller 0]: Controller 0 incremented epoch to 139 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,222] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:27:02,230] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:27:02,231] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:27:02,232] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,237] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,239] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,240] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,241] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 139 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,241] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:27:02,241] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,242] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:27:02,244] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:27:02,245] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:27:02,248] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:27:02,248] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:27:02,248] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:27:02,252] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:27:02,252] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:27:02,255] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:27:02,256] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,256] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":117,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,257] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:137,ControllerEpoch:138), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,258] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,258] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":138,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,259] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:116,ControllerEpoch:138)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,260] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,260] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":117,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:27:02,261] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:27:02,264] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:27:02,264] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:27:02,267] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:27:02,269] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:27:02,270] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:27:02,271] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:27:02,273] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:27:07,243] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:27:07,243] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:27:07,244] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:27:07,244] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,857] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:33:52,858] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,862] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:33:52,862] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,862] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:33:52,864] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:33:52,864] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:33:52,864] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:33:52,864] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:33:52,868] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:33:52,868] INFO [Controller 0]: Initialized controller epoch to 139 and zk version 138 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,869] INFO [Controller 0]: Controller 0 incremented epoch to 140 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,869] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:33:52,877] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:33:52,879] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,881] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,883] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,883] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,884] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 140 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,884] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:33:52,884] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,885] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:33:52,888] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:33:52,888] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:33:52,891] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:33:52,891] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:33:52,891] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:33:52,903] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:33:52,904] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:33:52,904] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:33:52,909] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,910] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":118,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,913] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:138,ControllerEpoch:139), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,914] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,914] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":139,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,915] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:117,ControllerEpoch:139)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,916] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,916] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":118,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:33:52,917] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:33:52,918] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:33:52,919] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:33:52,920] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:33:52,921] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:33:52,922] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:33:52,922] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:33:52,928] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:33:57,888] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:33:57,888] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:33:57,888] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:33:57,888] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,586] INFO [SessionExpirationListener on 0], ZK expired; shut down all controller components and try to re-elect (kafka.controller.KafkaController$SessionExpirationListener)
[2018-04-22 17:39:52,586] DEBUG [Controller 0]: Controller resigning, broker id 0 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,586] DEBUG [Controller 0]: De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:39:52,587] INFO [Partition state machine on Controller 0]: Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,587] INFO [Replica state machine on controller 0]: Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:39:52,589] INFO [Controller-0-to-broker-0-send-thread], Shutting down (kafka.controller.RequestSendThread)
[2018-04-22 17:39:52,589] INFO [Controller-0-to-broker-0-send-thread], Stopped  (kafka.controller.RequestSendThread)
[2018-04-22 17:39:52,589] INFO [Controller-0-to-broker-0-send-thread], Shutdown completed (kafka.controller.RequestSendThread)
[2018-04-22 17:39:52,589] INFO [Controller 0]: Broker 0 resigned as the controller (kafka.controller.KafkaController)
[2018-04-22 17:39:52,600] INFO [Controller 0]: Broker 0 starting become controller state transition (kafka.controller.KafkaController)
[2018-04-22 17:39:52,600] INFO [Controller 0]: Initialized controller epoch to 140 and zk version 139 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,601] INFO [Controller 0]: Controller 0 incremented epoch to 141 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,601] DEBUG [Controller 0]: Registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Partitions being reassigned: Map() (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Partitions already reassigned: List() (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: Resuming reassignment of partitions: Map() (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: List of topics to be deleted:  (kafka.controller.KafkaController)
[2018-04-22 17:39:52,611] INFO [Controller 0]: List of topics ineligible for deletion: kafka_topic,kafka_test,project_topic (kafka.controller.KafkaController)
[2018-04-22 17:39:52,612] INFO [Controller 0]: Currently active brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:39:52,612] INFO [Controller 0]: Currently shutting brokers in the cluster: Set() (kafka.controller.KafkaController)
[2018-04-22 17:39:52,612] INFO [Controller 0]: Current list of topics in the cluster: Set(kafka_test, kafka_topic, project_topic) (kafka.controller.KafkaController)
[2018-04-22 17:39:52,612] INFO [Replica state machine on controller 0]: Started replica state machine with initial state -> Map([Topic=project_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_topic,Partition=0,Replica=0] -> ReplicaDeletionIneligible, [Topic=kafka_test,Partition=0,Replica=0] -> ReplicaDeletionIneligible) (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:39:52,613] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,615] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [kafka_test,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,617] DEBUG [OfflinePartitionLeaderSelector]: No broker in ISR is alive for [project_topic,0]. Pick the leader from the alive assigned replicas:  (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,617] INFO [Partition state machine on Controller 0]: Started partition state machine with initial state -> Map([kafka_topic,0] -> OfflinePartition, [kafka_test,0] -> OfflinePartition, [project_topic,0] -> OfflinePartition) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,618] INFO [Controller 0]: Broker 0 is ready to serve as the new controller with epoch 141 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,618] INFO [Controller 0]: Starting preferred replica leader election for partitions  (kafka.controller.KafkaController)
[2018-04-22 17:39:52,618] INFO [Partition state machine on Controller 0]: Invoking state change to OnlinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,619] INFO [Controller 0]: starting the partition rebalance scheduler (kafka.controller.KafkaController)
[2018-04-22 17:39:52,622] DEBUG [IsrChangeNotificationListener] Fired!!! (kafka.controller.IsrChangeNotificationListener)
[2018-04-22 17:39:52,622] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:39:52,625] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: 0, deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:39:52,625] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2018-04-22 17:39:52,626] INFO [Controller 0]: New broker startup callback for 0 (kafka.controller.KafkaController)
[2018-04-22 17:39:52,630] INFO [Controller-0-to-broker-0-send-thread], Starting  (kafka.controller.RequestSendThread)
[2018-04-22 17:39:52,630] INFO [Replica state machine on controller 0]: Invoking state change to OnlineReplica for replicas [Topic=kafka_topic,Partition=0,Replica=0],[Topic=kafka_test,Partition=0,Replica=0],[Topic=project_topic,Partition=0,Replica=0] (kafka.controller.ReplicaStateMachine)
[2018-04-22 17:39:52,631] INFO [Controller-0-to-broker-0-send-thread], Controller 0 connected to Node(0, ubuntu, 9092) for sending state change requests (kafka.controller.RequestSendThread)
[2018-04-22 17:39:52,633] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,633] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":119,"isr":[0]} for offline partition [kafka_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,633] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:139,ControllerEpoch:140), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,634] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [kafka_test,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,634] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":140,"isr":[0]} for offline partition [kafka_test,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,635] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:118,ControllerEpoch:140)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,636] DEBUG [OfflinePartitionLeaderSelector]: Some broker in ISR is alive for [project_topic,0]. Select 0 from ISR 0 to be the leader. (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,636] INFO [OfflinePartitionLeaderSelector]: Selected new leader and ISR {"leader":0,"leader_epoch":119,"isr":[0]} for offline partition [project_topic,0] (kafka.controller.OfflinePartitionLeaderSelector)
[2018-04-22 17:39:52,637] DEBUG [Partition state machine on Controller 0]: After leader election, leader cache is updated to Map([kafka_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141), [kafka_test,0] -> (Leader:0,ISR:0,LeaderEpoch:140,ControllerEpoch:141), [project_topic,0] -> (Leader:0,ISR:0,LeaderEpoch:119,ControllerEpoch:141)) (kafka.controller.PartitionStateMachine)
[2018-04-22 17:39:52,640] DEBUG [TopicChangeListener on Controller 0]: Topic change listener fired for path /brokers/topics with children kafka_test,kafka_topic,project_topic (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:39:52,640] INFO [TopicChangeListener on Controller 0]: New topics: [Set()], deleted topics: [Set()], new partition replica assignment [Map()] (kafka.controller.PartitionStateMachine$TopicChangeListener)
[2018-04-22 17:39:52,643] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/project_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:39:52,645] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_test (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:39:52,646] INFO [AddPartitionsListener on 0]: Add Partition triggered {"version":1,"partitions":{"0":[0]}} for path /brokers/topics/kafka_topic (kafka.controller.PartitionStateMachine$AddPartitionsListener)
[2018-04-22 17:39:52,647] INFO [BrokerChangeListener on Controller 0]: Broker change listener fired for path /brokers/ids with children 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:39:52,649] INFO [BrokerChangeListener on Controller 0]: Newly added brokers: , deleted brokers: , all live brokers: 0 (kafka.controller.ReplicaStateMachine$BrokerChangeListener)
[2018-04-22 17:39:57,620] TRACE [Controller 0]: checking need to trigger partition rebalance (kafka.controller.KafkaController)
[2018-04-22 17:39:57,621] DEBUG [Controller 0]: preferred replicas by broker Map(0 -> Map([kafka_topic,0] -> List(0), [kafka_test,0] -> List(0), [project_topic,0] -> List(0))) (kafka.controller.KafkaController)
[2018-04-22 17:39:57,621] DEBUG [Controller 0]: topics not in preferred replica Map() (kafka.controller.KafkaController)
[2018-04-22 17:39:57,621] TRACE [Controller 0]: leader imbalance ratio for broker 0 is 0.000000 (kafka.controller.KafkaController)
